SELECT COUNT(DISTINCT CS_ORDER_NUMBER) AS order count, SUM(CS_EXT_SHIP_COST) AS total shipping cost, SUM(CS_NET_PROFIT) AS total net profit, DATE_SUB(NOW(), 3)
FROM CATALOG_SALES AS CS1,
DATE_DIM,
CUSTOMER_ADDRESS,
CALL_CENTER
WHERE D_DATE BETWEEN  CAST('1999-4-01' AS DATE) AND DATE_ADD(CAST('1999-4-01' AS DATE), 60) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ia' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ('mobile county', 'maverick county', 'huron county', 'kittitas county', 'fairfield county') AND EXISTS (SELECT *
FROM CATALOG_SALES AS CS2
WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK) AND NOT EXISTS (SELECT *
FROM CATALOG_RETURNS AS CR1
WHERE CS1.CS_ORDER_NUMBER = CR1.CR_ORDER_NUMBER)
ORDER BY COUNT(DISTINCT CS_ORDER_NUMBER)
FETCH NEXT 100 ROWS ONLY
SELECT I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE, SUM(WS_EXT_SALES_PRICE) AS ITEMREVENUE, FLOOR(SUM(WS_EXT_SALES_PRICE) * 100 / SUM(SUM(WS_EXT_SALES_PRICE))) OVER (PARTITION BY I_CLASS) AS REVENUERATIO
FROM WEB_SALES,
ITEM,
DATE_DIM
WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ('jewelry', 'sports', 'books') AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN  CAST('2001-01-12' AS DATE) AND DATE_ADD(CAST('2001-01-12' AS DATE), 30)
GROUP BY I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE
ORDER BY I_CATEGORY, I_CLASS, I_ITEM_ID, I_ITEM_DESC, REVENUERATIO
FETCH NEXT 100 ROWS ONLY
SELECT DT.D_YEAR, ITEM.I_BRAND_ID AS BRAND_ID, ITEM.I_BRAND AS BRAND, SUM(SS_EXT_SALES_PRICE) AS SUM_AGG
FROM DATE_DIM AS DT,
STORE_SALES,
ITEM
WHERE DT.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK AND STORE_SALES.SS_ITEM_SK = ITEM.I_ITEM_SK AND ITEM.I_MANUFACT_ID = 436 AND DT.D_MOY = 12
GROUP BY DT.D_YEAR, ITEM.I_BRAND, ITEM.I_BRAND_ID
ORDER BY DT.D_YEAR, SUM_AGG DESC, BRAND_ID
FETCH NEXT 100 ROWS ONLY
SELECT COUNT(DISTINCT CS_ORDER_NUMBER) AS order count, SUM(CS_EXT_SHIP_COST) AS total shipping cost, SUM(CS_NET_PROFIT) AS total net profit, DATE_SUB(NOW(), 3)
FROM CATALOG_SALES AS CS1,
DATE_DIM,
CUSTOMER_ADDRESS,
CALL_CENTER
WHERE D_DATE BETWEEN  CAST('1999-4-01' AS DATE) AND DATE_ADD(CAST('1999-4-01' AS DATE), 60) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ia' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ('mobile county', 'maverick county', 'huron county', 'kittitas county', 'fairfield county') AND EXISTS (SELECT *
FROM CATALOG_SALES AS CS2
WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK) AND NOT EXISTS (SELECT *
FROM CATALOG_RETURNS AS CR1
WHERE CS1.CS_ORDER_NUMBER = CR1.CR_ORDER_NUMBER)
ORDER BY COUNT(DISTINCT CS_ORDER_NUMBER)
FETCH NEXT 100 ROWS ONLY
SELECT I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE, SUM(WS_EXT_SALES_PRICE) AS ITEMREVENUE, FLOOR(SUM(WS_EXT_SALES_PRICE) * 100 / SUM(SUM(WS_EXT_SALES_PRICE))) OVER (PARTITION BY I_CLASS) AS REVENUERATIO
FROM WEB_SALES,
ITEM,
DATE_DIM
WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ('jewelry', 'sports', 'books') AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN  CAST('2001-01-12' AS DATE) AND DATE_ADD(CAST('2001-01-12' AS DATE), 30)
GROUP BY I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE
ORDER BY I_CATEGORY, I_CLASS, I_ITEM_ID, I_ITEM_DESC, REVENUERATIO
FETCH NEXT 100 ROWS ONLY
SELECT DT.D_YEAR, ITEM.I_BRAND_ID AS BRAND_ID, ITEM.I_BRAND AS BRAND, SUM(SS_EXT_SALES_PRICE) AS SUM_AGG
FROM DATE_DIM AS DT,
STORE_SALES,
ITEM
WHERE DT.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK AND STORE_SALES.SS_ITEM_SK = ITEM.I_ITEM_SK AND ITEM.I_MANUFACT_ID = 436 AND DT.D_MOY = 12
GROUP BY DT.D_YEAR, ITEM.I_BRAND, ITEM.I_BRAND_ID
ORDER BY DT.D_YEAR, SUM_AGG DESC, BRAND_ID
FETCH NEXT 100 ROWS ONLY
