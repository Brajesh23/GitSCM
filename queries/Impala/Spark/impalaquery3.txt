WITH WS_WH AS (SELECT WS1.WS_ORDER_NUMBER, WS1.WS_WAREHOUSE_SK AS WH1, WS2.WS_WAREHOUSE_SK AS WH2
FROM WEB_SALES AS WS1,
WEB_SALES AS WS2
WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK) (SELECT COUNT(DISTINCT WS_ORDER_NUMBER) AS order count, SUM(WS_EXT_SHIP_COST) AS total shipping cost, SUM(WS_NET_PROFIT) AS total net profit
FROM WEB_SALES AS WS1,
DATE_DIM,
CUSTOMER_ADDRESS,
WEB_SITE
WHERE D_DATE BETWEEN  CAST('1999-5-01' AS DATE) AND DATE_ADD(CAST('1999-5-01' AS DATE), 60) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'tx' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN (SELECT WS_ORDER_NUMBER
FROM WS_WH) AND WS1.WS_ORDER_NUMBER IN (SELECT WR_ORDER_NUMBER
FROM WEB_RETURNS,
WS_WH
WHERE WR_ORDER_NUMBER = WS_WH.WS_ORDER_NUMBER))
ORDER BY COUNT(DISTINCT WS_ORDER_NUMBER)
FETCH NEXT 100 ROWS ONLY
SELECT I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE, SUM(SS_EXT_SALES_PRICE) AS ITEMREVENUE, SUM(SS_EXT_SALES_PRICE) * 100 / (SUM(SUM(SS_EXT_SALES_PRICE)) OVER (PARTITION BY I_CLASS)) AS REVENUERATIO
FROM STORE_SALES,
ITEM,
DATE_DIM
WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ('jewelry', 'sports', 'books') AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN  CAST('2001-01-12' AS DATE) AND DATE_ADD(CAST('2001-01-12' AS DATE), 30)
GROUP BY I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE
ORDER BY I_CATEGORY, I_CLASS, I_ITEM_ID, I_ITEM_DESC, REVENUERATIO
SELECT SUBSTR(W_WAREHOUSE_NAME, 1, 20), SM_TYPE, CC_NAME, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 30 THEN 1 ELSE 0 END) AS 30 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 30 AND CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 60 THEN 1 ELSE 0 END) AS 31-60 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 60 AND CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 90 THEN 1 ELSE 0 END) AS 61-90 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 90 AND CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 120 THEN 1 ELSE 0 END) AS 91-120 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 120 THEN 1 ELSE 0 END) AS >120 day
FROM CATALOG_SALES,
WAREHOUSE,
SHIP_MODE,
CALL_CENTER,
DATE_DIM
WHERE D_MONTH_SEQ BETWEEN  1212 AND 1212 + 11 AND CS_SHIP_DATE_SK = D_DATE_SK AND CS_WAREHOUSE_SK = W_WAREHOUSE_SK AND CS_SHIP_MODE_SK = SM_SHIP_MODE_SK AND CS_CALL_CENTER_SK = CC_CALL_CENTER_SK
GROUP BY SUBSTR(W_WAREHOUSE_NAME, 1, 20), SM_TYPE, CC_NAME
ORDER BY SUBSTR(W_WAREHOUSE_NAME, 1, 20), SM_TYPE, CC_NAME
FETCH NEXT 100 ROWS ONLY
WITH WS_WH AS (SELECT WS1.WS_ORDER_NUMBER, WS1.WS_WAREHOUSE_SK AS WH1, WS2.WS_WAREHOUSE_SK AS WH2
FROM WEB_SALES AS WS1,
WEB_SALES AS WS2
WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK) (SELECT COUNT(DISTINCT WS_ORDER_NUMBER) AS order count, SUM(WS_EXT_SHIP_COST) AS total shipping cost, SUM(WS_NET_PROFIT) AS total net profit
FROM WEB_SALES AS WS1,
DATE_DIM,
CUSTOMER_ADDRESS,
WEB_SITE
WHERE D_DATE BETWEEN  CAST('1999-5-01' AS DATE) AND DATE_ADD(CAST('1999-5-01' AS DATE), 60) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'tx' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND WS1.WS_ORDER_NUMBER IN (SELECT WS_ORDER_NUMBER
FROM WS_WH) AND WS1.WS_ORDER_NUMBER IN (SELECT WR_ORDER_NUMBER
FROM WEB_RETURNS,
WS_WH
WHERE WR_ORDER_NUMBER = WS_WH.WS_ORDER_NUMBER))
ORDER BY COUNT(DISTINCT WS_ORDER_NUMBER)
FETCH NEXT 100 ROWS ONLY
SELECT I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE, SUM(SS_EXT_SALES_PRICE) AS ITEMREVENUE, SUM(SS_EXT_SALES_PRICE) * 100 / (SUM(SUM(SS_EXT_SALES_PRICE)) OVER (PARTITION BY I_CLASS)) AS REVENUERATIO
FROM STORE_SALES,
ITEM,
DATE_DIM
WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ('jewelry', 'sports', 'books') AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN  CAST('2001-01-12' AS DATE) AND DATE_ADD(CAST('2001-01-12' AS DATE), 30)
GROUP BY I_ITEM_ID, I_ITEM_DESC, I_CATEGORY, I_CLASS, I_CURRENT_PRICE
ORDER BY I_CATEGORY, I_CLASS, I_ITEM_ID, I_ITEM_DESC, REVENUERATIO
SELECT SUBSTR(W_WAREHOUSE_NAME, 1, 20), SM_TYPE, CC_NAME, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 30 THEN 1 ELSE 0 END) AS 30 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 30 AND CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 60 THEN 1 ELSE 0 END) AS 31-60 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 60 AND CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 90 THEN 1 ELSE 0 END) AS 61-90 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 90 AND CS_SHIP_DATE_SK - CS_SOLD_DATE_SK <= 120 THEN 1 ELSE 0 END) AS 91-120 day, SUM(CASE WHEN CS_SHIP_DATE_SK - CS_SOLD_DATE_SK > 120 THEN 1 ELSE 0 END) AS >120 day
FROM CATALOG_SALES,
WAREHOUSE,
SHIP_MODE,
CALL_CENTER,
DATE_DIM
WHERE D_MONTH_SEQ BETWEEN  1212 AND 1212 + 11 AND CS_SHIP_DATE_SK = D_DATE_SK AND CS_WAREHOUSE_SK = W_WAREHOUSE_SK AND CS_SHIP_MODE_SK = SM_SHIP_MODE_SK AND CS_CALL_CENTER_SK = CC_CALL_CENTER_SK
GROUP BY SUBSTR(W_WAREHOUSE_NAME, 1, 20), SM_TYPE, CC_NAME
ORDER BY SUBSTR(W_WAREHOUSE_NAME, 1, 20), SM_TYPE, CC_NAME
FETCH NEXT 100 ROWS ONLY
