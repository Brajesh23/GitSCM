---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT 'dc' AS SPPLY_CHN_ND, 'dc_vss' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, DM.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, DM.ITM_NBR, HM.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(SO.RECV_LOC_NBR, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, DM.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, DM.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(PO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, HM.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT * SO.NUM_CONVN, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, COALESCE(DM.DELV_DOC_NBR, HM.DELV_DOC_NBR, 'n/a') AS DELV_DOC_NBR, COALESCE(DM.DELV_DOC_ITM_NBR, HM.DELV_DOC_ITM_NBR, 0) AS DELV_DOC_ITM_NBR, COALESCE(DM.DEL_TYPE, 'n/a'), COALESCE(DM.ACT_DELV_QTY, 0.000), COALESCE(DM.ACTL_GDS_MOVMT_DT, '9999-12-31'), COALESCE(DM.DELV_PRTY, 0), COALESCE(DM.DELV_QTY, 0.000), COALESCE(DM.GDS_ISS_DATE, '9999-12-31'), COALESCE(DM.RCVG_STE_DELV, 'n/a'), COALESCE(DM.HDR_REC_CRTD_DT, '9999-12-31'), COALESCE(DM.REF_DOC_ITM_NBR, 0), COALESCE(DM.REF_DOC_NBR, 'n/a'), COALESCE(DM.SHP_RCVG_PT, 'n/a'), COALESCE(DM.GDS_MOVMT_CNTL, 'n/a'), COALESCE(DM.MOVMT_IND, 'n/a'), COALESCE(DM.POD_IND, 'n/a'), COALESCE(DM.POD_RLSE_IND, 'n/a'), COALESCE(DM.RECV_LOC_NBR, 'n/a'), COALESCE(DM.TRANSP_TYPE, 'n/a'), COALESCE(DM.TRANSP_ID, 'n/a'), COALESCE(HM.INTL_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR_2, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_TYPE, 'n/a'), COALESCE(HM.PCKG_MAT_TYPE, 'n/a'), COALESCE(HM.PCKD_QTY, 0.000), COALESCE(HM.PCKD_UOM, 'n/a'), COALESCE(IUM.NUMERATOR, 0.00), COALESCE(HM.GRS_WGT, 0.000), COALESCE(HM.WGT_UNT, 'n/a'), COALESCE(HM.LEN, 0.000), COALESCE(HM.WDT, 0.000), COALESCE(HM.HGT, 0.000), COALESCE(HM.DIM_UOM, 'n/a'), COALESCE(HM.REC_CHGD_DT, '9999-12-31'), COALESCE(HM.HNDLG_UNT_STAT, 'n/a'), COALESCE(HM.BOL_DT, '9999-12-31'), COALESCE(HM.STR_DT, '9999-12-31'), COALESCE(HM.DA_SCAN_DT, '9999-12-31'), COALESCE(HM.LOAD_NBR, 0), COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SUPL_LOC_NBR, COALESCE(PO.LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'stock_transfer_intra_company' AS BUSINESS_PROCESS, 'dc_vsd' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0)) AS PO
LEFT JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE CUST_PRCH_NBR <> 'n/a') AS SO ON PO.PURCH_ORD_NBR = SO.CUST_PRCH_NBR AND PO.PURCH_ORD_ITM_NBR = SO.CUST_PRCH_ITM_NBR AND PO.ITM_NBR = SO.ITM_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE ORG_NUM = '1108') AS A ON SO.RECV_LOC_NBR = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01') AS B ON SO.SHIP_TO_LOC_NBR = B.LOC_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.DELIVERY_MASTER
WHERE DEL_IND <> 'd' AND DEL_TYPE NOT IN ('el', 'elst') AND ITM_NBR <> '0') AS DM ON SO.SLS_ORD_NBR = DM.REF_DOC_NBR AND SO.SLS_ORD_ITM_NBR = DM.REF_DOC_ITM_NBR AND PO.ITM_NBR = DM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.HANDLING_MASTER
WHERE ITM_NBR <> '0') AS HM ON DM.DELV_DOC_ITM_NBR = HM.DELV_DOC_ITM_NBR AND DM.DELV_DOC_NBR = HM.DELV_DOC_NBR AND DM.ITM_NBR = HM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.ITEM_UNIT_MEASURE_MASTER
WHERE TRIM( ITM_NBR) <> '') AS IUM ON DM.ITM_NBR = IUM.ITM_NBR AND HM.PCKD_UOM = IUM.ALT_UOM);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT 'dc' AS SPPLY_CHN_ND, 'dc_vss' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, DM.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, DM.ITM_NBR, HM.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(SO.RECV_LOC_NBR, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, DM.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, DM.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(PO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, HM.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT * SO.NUM_CONVN, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, COALESCE(DM.DELV_DOC_NBR, HM.DELV_DOC_NBR, 'n/a') AS DELV_DOC_NBR, COALESCE(DM.DELV_DOC_ITM_NBR, HM.DELV_DOC_ITM_NBR, 0) AS DELV_DOC_ITM_NBR, COALESCE(DM.DEL_TYPE, 'n/a'), COALESCE(DM.ACT_DELV_QTY, 0.000), COALESCE(DM.ACTL_GDS_MOVMT_DT, '9999-12-31'), COALESCE(DM.DELV_PRTY, 0), COALESCE(DM.DELV_QTY, 0.000), COALESCE(DM.GDS_ISS_DATE, '9999-12-31'), COALESCE(DM.RCVG_STE_DELV, 'n/a'), COALESCE(DM.HDR_REC_CRTD_DT, '9999-12-31'), COALESCE(DM.REF_DOC_ITM_NBR, 0), COALESCE(DM.REF_DOC_NBR, 'n/a'), COALESCE(DM.SHP_RCVG_PT, 'n/a'), COALESCE(DM.GDS_MOVMT_CNTL, 'n/a'), COALESCE(DM.MOVMT_IND, 'n/a'), COALESCE(DM.POD_IND, 'n/a'), COALESCE(DM.POD_RLSE_IND, 'n/a'), COALESCE(DM.RECV_LOC_NBR, 'n/a'), COALESCE(DM.TRANSP_TYPE, 'n/a'), COALESCE(DM.TRANSP_ID, 'n/a'), COALESCE(HM.INTL_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR_2, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_TYPE, 'n/a'), COALESCE(HM.PCKG_MAT_TYPE, 'n/a'), COALESCE(HM.PCKD_QTY, 0.000), COALESCE(HM.PCKD_UOM, 'n/a'), COALESCE(IUM.NUMERATOR, 0.00), COALESCE(HM.GRS_WGT, 0.000), COALESCE(HM.WGT_UNT, 'n/a'), COALESCE(HM.LEN, 0.000), COALESCE(HM.WDT, 0.000), COALESCE(HM.HGT, 0.000), COALESCE(HM.DIM_UOM, 'n/a'), COALESCE(HM.REC_CHGD_DT, '9999-12-31'), COALESCE(HM.HNDLG_UNT_STAT, 'n/a'), COALESCE(HM.BOL_DT, '9999-12-31'), COALESCE(HM.STR_DT, '9999-12-31'), COALESCE(HM.DA_SCAN_DT, '9999-12-31'), COALESCE(HM.LOAD_NBR, 0), COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SUPL_LOC_NBR, COALESCE(PO.LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'stock_transfer_intra_company' AS BUSINESS_PROCESS, 'dc_vsd' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0)) AS PO
LEFT JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE CUST_PRCH_NBR <> 'n/a') AS SO ON PO.PURCH_ORD_NBR = SO.CUST_PRCH_NBR AND PO.PURCH_ORD_ITM_NBR = SO.CUST_PRCH_ITM_NBR AND PO.ITM_NBR = SO.ITM_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE ORG_NUM = '1108') AS A ON SO.RECV_LOC_NBR = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01') AS B ON SO.SHIP_TO_LOC_NBR = B.LOC_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.DELIVERY_MASTER
WHERE DEL_IND <> 'd' AND DEL_TYPE NOT IN ('el', 'elst') AND ITM_NBR <> '0') AS DM ON SO.SLS_ORD_NBR = DM.REF_DOC_NBR AND SO.SLS_ORD_ITM_NBR = DM.REF_DOC_ITM_NBR AND PO.ITM_NBR = DM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.HANDLING_MASTER
WHERE ITM_NBR <> '0') AS HM ON DM.DELV_DOC_ITM_NBR = HM.DELV_DOC_ITM_NBR AND DM.DELV_DOC_NBR = HM.DELV_DOC_NBR AND DM.ITM_NBR = HM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.ITEM_UNIT_MEASURE_MASTER
WHERE TRIM( ITM_NBR) <> '') AS IUM ON DM.ITM_NBR = IUM.ITM_NBR AND HM.PCKD_UOM = IUM.ALT_UOM);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT 'dc' AS SPPLY_CHN_ND, 'dc_vss' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, DM.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, DM.ITM_NBR, HM.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(SO.RECV_LOC_NBR, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, DM.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, DM.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(PO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, HM.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT * SO.NUM_CONVN, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, COALESCE(DM.DELV_DOC_NBR, HM.DELV_DOC_NBR, 'n/a') AS DELV_DOC_NBR, COALESCE(DM.DELV_DOC_ITM_NBR, HM.DELV_DOC_ITM_NBR, 0) AS DELV_DOC_ITM_NBR, COALESCE(DM.DEL_TYPE, 'n/a'), COALESCE(DM.ACT_DELV_QTY, 0.000), COALESCE(DM.ACTL_GDS_MOVMT_DT, '9999-12-31'), COALESCE(DM.DELV_PRTY, 0), COALESCE(DM.DELV_QTY, 0.000), COALESCE(DM.GDS_ISS_DATE, '9999-12-31'), COALESCE(DM.RCVG_STE_DELV, 'n/a'), COALESCE(DM.HDR_REC_CRTD_DT, '9999-12-31'), COALESCE(DM.REF_DOC_ITM_NBR, 0), COALESCE(DM.REF_DOC_NBR, 'n/a'), COALESCE(DM.SHP_RCVG_PT, 'n/a'), COALESCE(DM.GDS_MOVMT_CNTL, 'n/a'), COALESCE(DM.MOVMT_IND, 'n/a'), COALESCE(DM.POD_IND, 'n/a'), COALESCE(DM.POD_RLSE_IND, 'n/a'), COALESCE(DM.RECV_LOC_NBR, 'n/a'), COALESCE(DM.TRANSP_TYPE, 'n/a'), COALESCE(DM.TRANSP_ID, 'n/a'), COALESCE(HM.INTL_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR_2, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_TYPE, 'n/a'), COALESCE(HM.PCKG_MAT_TYPE, 'n/a'), COALESCE(HM.PCKD_QTY, 0.000), COALESCE(HM.PCKD_UOM, 'n/a'), COALESCE(IUM.NUMERATOR, 0.00), COALESCE(HM.GRS_WGT, 0.000), COALESCE(HM.WGT_UNT, 'n/a'), COALESCE(HM.LEN, 0.000), COALESCE(HM.WDT, 0.000), COALESCE(HM.HGT, 0.000), COALESCE(HM.DIM_UOM, 'n/a'), COALESCE(HM.REC_CHGD_DT, '9999-12-31'), COALESCE(HM.HNDLG_UNT_STAT, 'n/a'), COALESCE(HM.BOL_DT, '9999-12-31'), COALESCE(HM.STR_DT, '9999-12-31'), COALESCE(HM.DA_SCAN_DT, '9999-12-31'), COALESCE(HM.LOAD_NBR, 0), COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SUPL_LOC_NBR, COALESCE(PO.LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'stock_transfer_intra_company' AS BUSINESS_PROCESS, 'dc_vsd' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0)) AS PO
LEFT JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE CUST_PRCH_NBR <> 'n/a') AS SO ON PO.PURCH_ORD_NBR = SO.CUST_PRCH_NBR AND PO.PURCH_ORD_ITM_NBR = SO.CUST_PRCH_ITM_NBR AND PO.ITM_NBR = SO.ITM_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE ORG_NUM = '1108') AS A ON SO.RECV_LOC_NBR = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01') AS B ON SO.SHIP_TO_LOC_NBR = B.LOC_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.DELIVERY_MASTER
WHERE DEL_IND <> 'd' AND DEL_TYPE NOT IN ('el', 'elst') AND ITM_NBR <> '0') AS DM ON SO.SLS_ORD_NBR = DM.REF_DOC_NBR AND SO.SLS_ORD_ITM_NBR = DM.REF_DOC_ITM_NBR AND PO.ITM_NBR = DM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.HANDLING_MASTER
WHERE ITM_NBR <> '0') AS HM ON DM.DELV_DOC_ITM_NBR = HM.DELV_DOC_ITM_NBR AND DM.DELV_DOC_NBR = HM.DELV_DOC_NBR AND DM.ITM_NBR = HM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.ITEM_UNIT_MEASURE_MASTER
WHERE TRIM( ITM_NBR) <> '') AS IUM ON DM.ITM_NBR = IUM.ITM_NBR AND HM.PCKD_UOM = IUM.ALT_UOM);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT 'dc' AS SPPLY_CHN_ND, 'dc_vss' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, DM.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, DM.ITM_NBR, HM.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(SO.RECV_LOC_NBR, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, DM.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, DM.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(PO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, HM.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT * SO.NUM_CONVN, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, COALESCE(DM.DELV_DOC_NBR, HM.DELV_DOC_NBR, 'n/a') AS DELV_DOC_NBR, COALESCE(DM.DELV_DOC_ITM_NBR, HM.DELV_DOC_ITM_NBR, 0) AS DELV_DOC_ITM_NBR, COALESCE(DM.DEL_TYPE, 'n/a'), COALESCE(DM.ACT_DELV_QTY, 0.000), COALESCE(DM.ACTL_GDS_MOVMT_DT, '9999-12-31'), COALESCE(DM.DELV_PRTY, 0), COALESCE(DM.DELV_QTY, 0.000), COALESCE(DM.GDS_ISS_DATE, '9999-12-31'), COALESCE(DM.RCVG_STE_DELV, 'n/a'), COALESCE(DM.HDR_REC_CRTD_DT, '9999-12-31'), COALESCE(DM.REF_DOC_ITM_NBR, 0), COALESCE(DM.REF_DOC_NBR, 'n/a'), COALESCE(DM.SHP_RCVG_PT, 'n/a'), COALESCE(DM.GDS_MOVMT_CNTL, 'n/a'), COALESCE(DM.MOVMT_IND, 'n/a'), COALESCE(DM.POD_IND, 'n/a'), COALESCE(DM.POD_RLSE_IND, 'n/a'), COALESCE(DM.RECV_LOC_NBR, 'n/a'), COALESCE(DM.TRANSP_TYPE, 'n/a'), COALESCE(DM.TRANSP_ID, 'n/a'), COALESCE(HM.INTL_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_NBR_2, 'n/a'), COALESCE(HM.EXT_HNDLG_UNT_TYPE, 'n/a'), COALESCE(HM.PCKG_MAT_TYPE, 'n/a'), COALESCE(HM.PCKD_QTY, 0.000), COALESCE(HM.PCKD_UOM, 'n/a'), COALESCE(IUM.NUMERATOR, 0.00), COALESCE(HM.GRS_WGT, 0.000), COALESCE(HM.WGT_UNT, 'n/a'), COALESCE(HM.LEN, 0.000), COALESCE(HM.WDT, 0.000), COALESCE(HM.HGT, 0.000), COALESCE(HM.DIM_UOM, 'n/a'), COALESCE(HM.REC_CHGD_DT, '9999-12-31'), COALESCE(HM.HNDLG_UNT_STAT, 'n/a'), COALESCE(HM.BOL_DT, '9999-12-31'), COALESCE(HM.STR_DT, '9999-12-31'), COALESCE(HM.DA_SCAN_DT, '9999-12-31'), COALESCE(HM.LOAD_NBR, 0), COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SUPL_LOC_NBR, COALESCE(PO.LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'stock_transfer_intra_company' AS BUSINESS_PROCESS, 'dc_vsd' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0)) AS PO
LEFT JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE CUST_PRCH_NBR <> 'n/a') AS SO ON PO.PURCH_ORD_NBR = SO.CUST_PRCH_NBR AND PO.PURCH_ORD_ITM_NBR = SO.CUST_PRCH_ITM_NBR AND PO.ITM_NBR = SO.ITM_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE ORG_NUM = '1108') AS A ON SO.RECV_LOC_NBR = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01') AS B ON SO.SHIP_TO_LOC_NBR = B.LOC_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.DELIVERY_MASTER
WHERE DEL_IND <> 'd' AND DEL_TYPE NOT IN ('el', 'elst') AND ITM_NBR <> '0') AS DM ON SO.SLS_ORD_NBR = DM.REF_DOC_NBR AND SO.SLS_ORD_ITM_NBR = DM.REF_DOC_ITM_NBR AND PO.ITM_NBR = DM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.HANDLING_MASTER
WHERE ITM_NBR <> '0') AS HM ON DM.DELV_DOC_ITM_NBR = HM.DELV_DOC_ITM_NBR AND DM.DELV_DOC_NBR = HM.DELV_DOC_NBR AND DM.ITM_NBR = HM.ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.ITEM_UNIT_MEASURE_MASTER
WHERE TRIM( ITM_NBR) <> '') AS IUM ON DM.ITM_NBR = IUM.ITM_NBR AND HM.PCKD_UOM = IUM.ALT_UOM);
