! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
insert overwrite table scct_db.scem_tracking_objects select  apo_integr , arriv_harb , arriv_loc , asn_del_dt , asn_quant , batch , bom , bom_alt , booking_id , brand , bw_profile , carrier , carrier_p , carrier_s , cfs_bypass , cfs_hold , choice , class , company_code , container_number , cargo_receipt_qty_total_ctn , currency , customs_dist_id , daily_cut_date , daily_cut_qty , daily_fd_off_dt , daily_fd_off_qt , del_date , del_priority , delet_ind , deliv_loc , delv_numb , dept_loc , dox_recv_date , dox_recv_time , departure_qty_total_ctn , dsr_comments , dsr_eta_final , dsr_eta_cfs , dsr_reason_code , dsr_reason_desc , dsr_status , eh_active_date , eh_active_time , eh_appobjid , eh_appobjtype , eh_appsys , eh_created_by , eh_created_date_est , eh_created_time_est , eh_created_date_time_est , eh_duration_01 , eh_duration_02 , eh_duration_03 , eh_duration_04 , eh_duration_05 , eh_guid , eh_inactive_date , eh_inactive_time , eh_proc_mode , eh_start_date , eh_start_time , eh_trkid_cd , eh_trkid_cs , eh_type , eh_tzone , eh_updated_by , eh_updated_date_est , eh_updated_time_est , eh_updated_date_time_est , em_client , enterprise , equipment , explosion_dt , fcr_number , departure_edi_finl_dest_eta_dt , finl_dest_loc_id , funct_loc , gr_quant , hawbfcr , inco1 , inco2 , info_type , insp_lot , inv_doc_no , itm_cat , lbi_ownership_dt , material , mawb , mrp_area , mrp_contrl , net_price , not_cat_type , not_code_grp , not_coding , not_finish_dt , not_start_dt , not_type , obol , oi_ebeln , ord_categ , ord_type , order_rs_code , pack_date_daily , pack_qty_daily , planned_mode , plant , pln_finish_dt , pln_start_dt , po_creator , po_deli_dt , po_doc_dt , poi_ack_qt , poi_quant , port_ent_eta_dat , port_ent_loc_id , port_lad_etd_dt , port_of_discharg , port_of_entry , port_of_lading , priority , prod_sched , prod_st_dt_act , prod_st_dt_pln , prod_vers , prt_disch_eta_dt , prt_disch_loc_id , purch_grp , purch_ord_ln_no , purch_org , quantity , quantity_unit , report_by , req_del_date , requisit , resp_partner , rocancel , rout_cnt , rout_grp , route , route_p , route_s , salesorder_no , sector , ship_to_party , shipmt_type , shipping_cond , shipping_point , shipping_type , sold_to_party , style , total_vol_unit , total_volume , total_weight , total_wght_unit , trailer_number , trans_mode , unloading_point , uom , vendor , vendor_country , vendor_name , vendor_ord_type , vendor_season , vendor_year , vessel_name , voyage , work_center , z_amount_cc , z_date1 , z_date1_sup , z_date2 , z_date2_sup , z_date3 , z_date3_sup , z_date4 , z_date4_sup , z_date5 , z_date5_sup , z_insufficient_greige , z_not_assigned , z_qty1 , z_qty1_sup , z_qty2 , z_qty2_sup , z_qty3 , z_qty3_sup , z_qty4 , z_qty4_sup , z_qty5 , z_qty5_sup , z_rmpo_brand , z_rmpo_buy_strategy , z_rmpo_category , z_rmpo_dept_code , z_rmpo_fabric_status , z_rmpo_floor_set , z_rmpo_floorset_name , z_rmpo_material_type_color , z_rmpo_order_date , z_rmpo_order_qty , z_rmpo_orig_committ_type , z_rmpo_plan_grp , z_rmpo_quality_num , z_rmpo_stat , z_rmpo_supplier , z_rmpo_vendor , z_rolling , z_vendor , z_vendor_rmpo , z_vpo , zcollection , zcolor_mrkt , cpo_number , zdelivery_ind , zfactory_cost , zfirst_cost , zflex_optiva , zlanded_cost , zlbi_cnf_gac , zlbi_cnf_mode , zlbi_cnf_ndc , zlbi_cnf_stat , zlbi_in_mode , zlbi_new_air_ndc , zlbi_new_ocn_ndc , zlbi_prod_delay , zlbi_remarks_cntrl , zlbi_so_no , zlbi_so_po_prev , zlbi_sopo_date , zlbi_tot_co_qty , zlbi_tot_qty , zlbi_vq_gac , zlbi_vq_mode , zlbi_vq_ndc , zlbi_vq_stat , zorig_lbi_own_dt , zoriginal_gac , zoriginal_ndc , zready_date , zready_qt , zretail_price , zrmpo_age , zrmpo_brand , zrmpo_buy_strategy , zrmpo_c_liability_typ , zrmpo_category , zrmpo_close_dt , zrmpo_collection , zrmpo_color , zrmpo_color_desc , zrmpo_cost , zrmpo_create_dt , zrmpo_cur_ownership , zrmpo_dept_code , zrmpo_dispute_case , zrmpo_emo_space , zrmpo_est_yy , zrmpo_expire_dt , zrmpo_fabric_status , zrmpo_flex_rm_id , zrmpo_flex_style_num , zrmpo_floor_set , zrmpo_floorset_name , zrmpo_material_desc , zrmpo_material_type , zrmpo_material_type_color , zrmpo_material_width , zrmpo_month_till_expire , zrmpo_orig_committ_type , zrmpo_orig_ownership , zrmpo_orig_season , zrmpo_orig_value , zrmpo_pending_upd , zrmpo_plan_collection , zrmpo_plan_grp , zrmpo_plan_order_dt , zrmpo_po_color_desc , zrmpo_prev_ownership , zrmpo_quality_num , zrmpo_ready_dt , zrmpo_risk_amount , zrmpo_risk_percent , zrmpo_shared_rm , zrmpo_stat , zrmpo_style_desc , zrmpo_subbrand , zrmpo_sup_cost , zrmpo_sup_expire_dt , zrmpo_sup_notes , zrmpo_sup_ready_dt , zrmpo_supplier , zrmpo_to_party , zrmpo_total_value , zrmpo_units_yy , zrmpo_uom , zrmpo_update_dt , zrmpo_update_dt_usr , zrmpo_update_stat , zrpo_brand , zrpo_buy_strategy , zrpo_dept_cat , zrpo_dept_code , zrpo_est_cost , zrpo_fiscal_month , zrpo_flex_style , zrpo_generic , zrpo_hq_vendor , zrpo_order_date , zrpo_order_qty , zrpo_order_status , zrpo_rapid_po , zrpo_reason_desc , zsc_season_code , act_gac_dt , zscv_category , zscv_cut_qty , zscv_deleted , zscv_department , zscv_division , zscv_fset_date , zscv_lics_ponum , zscv_lz_mcq_amt , zscv_lz_mcq_conf , zscv_lz_qt_price , zscv_lza_callout , zscv_markup , zscv_mast_flag , zscv_pack_date , zscv_pack_qty , zscv_po_ack , zscv_po_multiple , zscv_po_price , zscv_po_status , zscv_prodoffice , zscv_revisedgac , zscv_revisedndc , zscv_revisemode , zscv_rm_vendname , zscv_rm_vendnum , zscv_season , zscv_sew_adate , zscv_sew_pdate , zscv_sew_qty , zscv_so_create , zscv_so_multiple , zscv_tbc_status , zscv_top_date , zscv_vend_close , zscv_vend_flag , zscv_vend_refnun , zscv_xmill_adt , zscv_xmill_pdt , zscv_your_ref , zseason_cat , zseason_year , zship_to_name , zvendor_ref_num , zvsdsku , eh_created_date from  scct_work_db.scem_tracking_objects_tmp where di_operation_type in ('i', 'u', 'e')
! echo completed loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
insert overwrite table scct_db.scem_tracking_objects select  apo_integr , arriv_harb , arriv_loc , asn_del_dt , asn_quant , batch , bom , bom_alt , booking_id , brand , bw_profile , carrier , carrier_p , carrier_s , cfs_bypass , cfs_hold , choice , class , company_code , container_number , cargo_receipt_qty_total_ctn , currency , customs_dist_id , daily_cut_date , daily_cut_qty , daily_fd_off_dt , daily_fd_off_qt , del_date , del_priority , delet_ind , deliv_loc , delv_numb , dept_loc , dox_recv_date , dox_recv_time , departure_qty_total_ctn , dsr_comments , dsr_eta_final , dsr_eta_cfs , dsr_reason_code , dsr_reason_desc , dsr_status , eh_active_date , eh_active_time , eh_appobjid , eh_appobjtype , eh_appsys , eh_created_by , eh_created_date_est , eh_created_time_est , eh_created_date_time_est , eh_duration_01 , eh_duration_02 , eh_duration_03 , eh_duration_04 , eh_duration_05 , eh_guid , eh_inactive_date , eh_inactive_time , eh_proc_mode , eh_start_date , eh_start_time , eh_trkid_cd , eh_trkid_cs , eh_type , eh_tzone , eh_updated_by , eh_updated_date_est , eh_updated_time_est , eh_updated_date_time_est , em_client , enterprise , equipment , explosion_dt , fcr_number , departure_edi_finl_dest_eta_dt , finl_dest_loc_id , funct_loc , gr_quant , hawbfcr , inco1 , inco2 , info_type , insp_lot , inv_doc_no , itm_cat , lbi_ownership_dt , material , mawb , mrp_area , mrp_contrl , net_price , not_cat_type , not_code_grp , not_coding , not_finish_dt , not_start_dt , not_type , obol , oi_ebeln , ord_categ , ord_type , order_rs_code , pack_date_daily , pack_qty_daily , planned_mode , plant , pln_finish_dt , pln_start_dt , po_creator , po_deli_dt , po_doc_dt , poi_ack_qt , poi_quant , port_ent_eta_dat , port_ent_loc_id , port_lad_etd_dt , port_of_discharg , port_of_entry , port_of_lading , priority , prod_sched , prod_st_dt_act , prod_st_dt_pln , prod_vers , prt_disch_eta_dt , prt_disch_loc_id , purch_grp , purch_ord_ln_no , purch_org , quantity , quantity_unit , report_by , req_del_date , requisit , resp_partner , rocancel , rout_cnt , rout_grp , route , route_p , route_s , salesorder_no , sector , ship_to_party , shipmt_type , shipping_cond , shipping_point , shipping_type , sold_to_party , style , total_vol_unit , total_volume , total_weight , total_wght_unit , trailer_number , trans_mode , unloading_point , uom , vendor , vendor_country , vendor_name , vendor_ord_type , vendor_season , vendor_year , vessel_name , voyage , work_center , z_amount_cc , z_date1 , z_date1_sup , z_date2 , z_date2_sup , z_date3 , z_date3_sup , z_date4 , z_date4_sup , z_date5 , z_date5_sup , z_insufficient_greige , z_not_assigned , z_qty1 , z_qty1_sup , z_qty2 , z_qty2_sup , z_qty3 , z_qty3_sup , z_qty4 , z_qty4_sup , z_qty5 , z_qty5_sup , z_rmpo_brand , z_rmpo_buy_strategy , z_rmpo_category , z_rmpo_dept_code , z_rmpo_fabric_status , z_rmpo_floor_set , z_rmpo_floorset_name , z_rmpo_material_type_color , z_rmpo_order_date , z_rmpo_order_qty , z_rmpo_orig_committ_type , z_rmpo_plan_grp , z_rmpo_quality_num , z_rmpo_stat , z_rmpo_supplier , z_rmpo_vendor , z_rolling , z_vendor , z_vendor_rmpo , z_vpo , zcollection , zcolor_mrkt , cpo_number , zdelivery_ind , zfactory_cost , zfirst_cost , zflex_optiva , zlanded_cost , zlbi_cnf_gac , zlbi_cnf_mode , zlbi_cnf_ndc , zlbi_cnf_stat , zlbi_in_mode , zlbi_new_air_ndc , zlbi_new_ocn_ndc , zlbi_prod_delay , zlbi_remarks_cntrl , zlbi_so_no , zlbi_so_po_prev , zlbi_sopo_date , zlbi_tot_co_qty , zlbi_tot_qty , zlbi_vq_gac , zlbi_vq_mode , zlbi_vq_ndc , zlbi_vq_stat , zorig_lbi_own_dt , zoriginal_gac , zoriginal_ndc , zready_date , zready_qt , zretail_price , zrmpo_age , zrmpo_brand , zrmpo_buy_strategy , zrmpo_c_liability_typ , zrmpo_category , zrmpo_close_dt , zrmpo_collection , zrmpo_color , zrmpo_color_desc , zrmpo_cost , zrmpo_create_dt , zrmpo_cur_ownership , zrmpo_dept_code , zrmpo_dispute_case , zrmpo_emo_space , zrmpo_est_yy , zrmpo_expire_dt , zrmpo_fabric_status , zrmpo_flex_rm_id , zrmpo_flex_style_num , zrmpo_floor_set , zrmpo_floorset_name , zrmpo_material_desc , zrmpo_material_type , zrmpo_material_type_color , zrmpo_material_width , zrmpo_month_till_expire , zrmpo_orig_committ_type , zrmpo_orig_ownership , zrmpo_orig_season , zrmpo_orig_value , zrmpo_pending_upd , zrmpo_plan_collection , zrmpo_plan_grp , zrmpo_plan_order_dt , zrmpo_po_color_desc , zrmpo_prev_ownership , zrmpo_quality_num , zrmpo_ready_dt , zrmpo_risk_amount , zrmpo_risk_percent , zrmpo_shared_rm , zrmpo_stat , zrmpo_style_desc , zrmpo_subbrand , zrmpo_sup_cost , zrmpo_sup_expire_dt , zrmpo_sup_notes , zrmpo_sup_ready_dt , zrmpo_supplier , zrmpo_to_party , zrmpo_total_value , zrmpo_units_yy , zrmpo_uom , zrmpo_update_dt , zrmpo_update_dt_usr , zrmpo_update_stat , zrpo_brand , zrpo_buy_strategy , zrpo_dept_cat , zrpo_dept_code , zrpo_est_cost , zrpo_fiscal_month , zrpo_flex_style , zrpo_generic , zrpo_hq_vendor , zrpo_order_date , zrpo_order_qty , zrpo_order_status , zrpo_rapid_po , zrpo_reason_desc , zsc_season_code , act_gac_dt , zscv_category , zscv_cut_qty , zscv_deleted , zscv_department , zscv_division , zscv_fset_date , zscv_lics_ponum , zscv_lz_mcq_amt , zscv_lz_mcq_conf , zscv_lz_qt_price , zscv_lza_callout , zscv_markup , zscv_mast_flag , zscv_pack_date , zscv_pack_qty , zscv_po_ack , zscv_po_multiple , zscv_po_price , zscv_po_status , zscv_prodoffice , zscv_revisedgac , zscv_revisedndc , zscv_revisemode , zscv_rm_vendname , zscv_rm_vendnum , zscv_season , zscv_sew_adate , zscv_sew_pdate , zscv_sew_qty , zscv_so_create , zscv_so_multiple , zscv_tbc_status , zscv_top_date , zscv_vend_close , zscv_vend_flag , zscv_vend_refnun , zscv_xmill_adt , zscv_xmill_pdt , zscv_your_ref , zseason_cat , zseason_year , zship_to_name , zvendor_ref_num , zvsdsku , eh_created_date from  scct_work_db.scem_tracking_objects_tmp where di_operation_type in ('i', 'u', 'e')
! echo completed loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
insert overwrite table scct_db.scem_tracking_objects select  apo_integr , arriv_harb , arriv_loc , asn_del_dt , asn_quant , batch , bom , bom_alt , booking_id , brand , bw_profile , carrier , carrier_p , carrier_s , cfs_bypass , cfs_hold , choice , class , company_code , container_number , cargo_receipt_qty_total_ctn , currency , customs_dist_id , daily_cut_date , daily_cut_qty , daily_fd_off_dt , daily_fd_off_qt , del_date , del_priority , delet_ind , deliv_loc , delv_numb , dept_loc , dox_recv_date , dox_recv_time , departure_qty_total_ctn , dsr_comments , dsr_eta_final , dsr_eta_cfs , dsr_reason_code , dsr_reason_desc , dsr_status , eh_active_date , eh_active_time , eh_appobjid , eh_appobjtype , eh_appsys , eh_created_by , eh_created_date_est , eh_created_time_est , eh_created_date_time_est , eh_duration_01 , eh_duration_02 , eh_duration_03 , eh_duration_04 , eh_duration_05 , eh_guid , eh_inactive_date , eh_inactive_time , eh_proc_mode , eh_start_date , eh_start_time , eh_trkid_cd , eh_trkid_cs , eh_type , eh_tzone , eh_updated_by , eh_updated_date_est , eh_updated_time_est , eh_updated_date_time_est , em_client , enterprise , equipment , explosion_dt , fcr_number , departure_edi_finl_dest_eta_dt , finl_dest_loc_id , funct_loc , gr_quant , hawbfcr , inco1 , inco2 , info_type , insp_lot , inv_doc_no , itm_cat , lbi_ownership_dt , material , mawb , mrp_area , mrp_contrl , net_price , not_cat_type , not_code_grp , not_coding , not_finish_dt , not_start_dt , not_type , obol , oi_ebeln , ord_categ , ord_type , order_rs_code , pack_date_daily , pack_qty_daily , planned_mode , plant , pln_finish_dt , pln_start_dt , po_creator , po_deli_dt , po_doc_dt , poi_ack_qt , poi_quant , port_ent_eta_dat , port_ent_loc_id , port_lad_etd_dt , port_of_discharg , port_of_entry , port_of_lading , priority , prod_sched , prod_st_dt_act , prod_st_dt_pln , prod_vers , prt_disch_eta_dt , prt_disch_loc_id , purch_grp , purch_ord_ln_no , purch_org , quantity , quantity_unit , report_by , req_del_date , requisit , resp_partner , rocancel , rout_cnt , rout_grp , route , route_p , route_s , salesorder_no , sector , ship_to_party , shipmt_type , shipping_cond , shipping_point , shipping_type , sold_to_party , style , total_vol_unit , total_volume , total_weight , total_wght_unit , trailer_number , trans_mode , unloading_point , uom , vendor , vendor_country , vendor_name , vendor_ord_type , vendor_season , vendor_year , vessel_name , voyage , work_center , z_amount_cc , z_date1 , z_date1_sup , z_date2 , z_date2_sup , z_date3 , z_date3_sup , z_date4 , z_date4_sup , z_date5 , z_date5_sup , z_insufficient_greige , z_not_assigned , z_qty1 , z_qty1_sup , z_qty2 , z_qty2_sup , z_qty3 , z_qty3_sup , z_qty4 , z_qty4_sup , z_qty5 , z_qty5_sup , z_rmpo_brand , z_rmpo_buy_strategy , z_rmpo_category , z_rmpo_dept_code , z_rmpo_fabric_status , z_rmpo_floor_set , z_rmpo_floorset_name , z_rmpo_material_type_color , z_rmpo_order_date , z_rmpo_order_qty , z_rmpo_orig_committ_type , z_rmpo_plan_grp , z_rmpo_quality_num , z_rmpo_stat , z_rmpo_supplier , z_rmpo_vendor , z_rolling , z_vendor , z_vendor_rmpo , z_vpo , zcollection , zcolor_mrkt , cpo_number , zdelivery_ind , zfactory_cost , zfirst_cost , zflex_optiva , zlanded_cost , zlbi_cnf_gac , zlbi_cnf_mode , zlbi_cnf_ndc , zlbi_cnf_stat , zlbi_in_mode , zlbi_new_air_ndc , zlbi_new_ocn_ndc , zlbi_prod_delay , zlbi_remarks_cntrl , zlbi_so_no , zlbi_so_po_prev , zlbi_sopo_date , zlbi_tot_co_qty , zlbi_tot_qty , zlbi_vq_gac , zlbi_vq_mode , zlbi_vq_ndc , zlbi_vq_stat , zorig_lbi_own_dt , zoriginal_gac , zoriginal_ndc , zready_date , zready_qt , zretail_price , zrmpo_age , zrmpo_brand , zrmpo_buy_strategy , zrmpo_c_liability_typ , zrmpo_category , zrmpo_close_dt , zrmpo_collection , zrmpo_color , zrmpo_color_desc , zrmpo_cost , zrmpo_create_dt , zrmpo_cur_ownership , zrmpo_dept_code , zrmpo_dispute_case , zrmpo_emo_space , zrmpo_est_yy , zrmpo_expire_dt , zrmpo_fabric_status , zrmpo_flex_rm_id , zrmpo_flex_style_num , zrmpo_floor_set , zrmpo_floorset_name , zrmpo_material_desc , zrmpo_material_type , zrmpo_material_type_color , zrmpo_material_width , zrmpo_month_till_expire , zrmpo_orig_committ_type , zrmpo_orig_ownership , zrmpo_orig_season , zrmpo_orig_value , zrmpo_pending_upd , zrmpo_plan_collection , zrmpo_plan_grp , zrmpo_plan_order_dt , zrmpo_po_color_desc , zrmpo_prev_ownership , zrmpo_quality_num , zrmpo_ready_dt , zrmpo_risk_amount , zrmpo_risk_percent , zrmpo_shared_rm , zrmpo_stat , zrmpo_style_desc , zrmpo_subbrand , zrmpo_sup_cost , zrmpo_sup_expire_dt , zrmpo_sup_notes , zrmpo_sup_ready_dt , zrmpo_supplier , zrmpo_to_party , zrmpo_total_value , zrmpo_units_yy , zrmpo_uom , zrmpo_update_dt , zrmpo_update_dt_usr , zrmpo_update_stat , zrpo_brand , zrpo_buy_strategy , zrpo_dept_cat , zrpo_dept_code , zrpo_est_cost , zrpo_fiscal_month , zrpo_flex_style , zrpo_generic , zrpo_hq_vendor , zrpo_order_date , zrpo_order_qty , zrpo_order_status , zrpo_rapid_po , zrpo_reason_desc , zsc_season_code , act_gac_dt , zscv_category , zscv_cut_qty , zscv_deleted , zscv_department , zscv_division , zscv_fset_date , zscv_lics_ponum , zscv_lz_mcq_amt , zscv_lz_mcq_conf , zscv_lz_qt_price , zscv_lza_callout , zscv_markup , zscv_mast_flag , zscv_pack_date , zscv_pack_qty , zscv_po_ack , zscv_po_multiple , zscv_po_price , zscv_po_status , zscv_prodoffice , zscv_revisedgac , zscv_revisedndc , zscv_revisemode , zscv_rm_vendname , zscv_rm_vendnum , zscv_season , zscv_sew_adate , zscv_sew_pdate , zscv_sew_qty , zscv_so_create , zscv_so_multiple , zscv_tbc_status , zscv_top_date , zscv_vend_close , zscv_vend_flag , zscv_vend_refnun , zscv_xmill_adt , zscv_xmill_pdt , zscv_your_ref , zseason_cat , zseason_year , zship_to_name , zvendor_ref_num , zvsdsku , eh_created_date from  scct_work_db.scem_tracking_objects_tmp where di_operation_type in ('i', 'u', 'e')
! echo completed loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
insert overwrite table scct_db.scem_tracking_objects select  apo_integr , arriv_harb , arriv_loc , asn_del_dt , asn_quant , batch , bom , bom_alt , booking_id , brand , bw_profile , carrier , carrier_p , carrier_s , cfs_bypass , cfs_hold , choice , class , company_code , container_number , cargo_receipt_qty_total_ctn , currency , customs_dist_id , daily_cut_date , daily_cut_qty , daily_fd_off_dt , daily_fd_off_qt , del_date , del_priority , delet_ind , deliv_loc , delv_numb , dept_loc , dox_recv_date , dox_recv_time , departure_qty_total_ctn , dsr_comments , dsr_eta_final , dsr_eta_cfs , dsr_reason_code , dsr_reason_desc , dsr_status , eh_active_date , eh_active_time , eh_appobjid , eh_appobjtype , eh_appsys , eh_created_by , eh_created_date_est , eh_created_time_est , eh_created_date_time_est , eh_duration_01 , eh_duration_02 , eh_duration_03 , eh_duration_04 , eh_duration_05 , eh_guid , eh_inactive_date , eh_inactive_time , eh_proc_mode , eh_start_date , eh_start_time , eh_trkid_cd , eh_trkid_cs , eh_type , eh_tzone , eh_updated_by , eh_updated_date_est , eh_updated_time_est , eh_updated_date_time_est , em_client , enterprise , equipment , explosion_dt , fcr_number , departure_edi_finl_dest_eta_dt , finl_dest_loc_id , funct_loc , gr_quant , hawbfcr , inco1 , inco2 , info_type , insp_lot , inv_doc_no , itm_cat , lbi_ownership_dt , material , mawb , mrp_area , mrp_contrl , net_price , not_cat_type , not_code_grp , not_coding , not_finish_dt , not_start_dt , not_type , obol , oi_ebeln , ord_categ , ord_type , order_rs_code , pack_date_daily , pack_qty_daily , planned_mode , plant , pln_finish_dt , pln_start_dt , po_creator , po_deli_dt , po_doc_dt , poi_ack_qt , poi_quant , port_ent_eta_dat , port_ent_loc_id , port_lad_etd_dt , port_of_discharg , port_of_entry , port_of_lading , priority , prod_sched , prod_st_dt_act , prod_st_dt_pln , prod_vers , prt_disch_eta_dt , prt_disch_loc_id , purch_grp , purch_ord_ln_no , purch_org , quantity , quantity_unit , report_by , req_del_date , requisit , resp_partner , rocancel , rout_cnt , rout_grp , route , route_p , route_s , salesorder_no , sector , ship_to_party , shipmt_type , shipping_cond , shipping_point , shipping_type , sold_to_party , style , total_vol_unit , total_volume , total_weight , total_wght_unit , trailer_number , trans_mode , unloading_point , uom , vendor , vendor_country , vendor_name , vendor_ord_type , vendor_season , vendor_year , vessel_name , voyage , work_center , z_amount_cc , z_date1 , z_date1_sup , z_date2 , z_date2_sup , z_date3 , z_date3_sup , z_date4 , z_date4_sup , z_date5 , z_date5_sup , z_insufficient_greige , z_not_assigned , z_qty1 , z_qty1_sup , z_qty2 , z_qty2_sup , z_qty3 , z_qty3_sup , z_qty4 , z_qty4_sup , z_qty5 , z_qty5_sup , z_rmpo_brand , z_rmpo_buy_strategy , z_rmpo_category , z_rmpo_dept_code , z_rmpo_fabric_status , z_rmpo_floor_set , z_rmpo_floorset_name , z_rmpo_material_type_color , z_rmpo_order_date , z_rmpo_order_qty , z_rmpo_orig_committ_type , z_rmpo_plan_grp , z_rmpo_quality_num , z_rmpo_stat , z_rmpo_supplier , z_rmpo_vendor , z_rolling , z_vendor , z_vendor_rmpo , z_vpo , zcollection , zcolor_mrkt , cpo_number , zdelivery_ind , zfactory_cost , zfirst_cost , zflex_optiva , zlanded_cost , zlbi_cnf_gac , zlbi_cnf_mode , zlbi_cnf_ndc , zlbi_cnf_stat , zlbi_in_mode , zlbi_new_air_ndc , zlbi_new_ocn_ndc , zlbi_prod_delay , zlbi_remarks_cntrl , zlbi_so_no , zlbi_so_po_prev , zlbi_sopo_date , zlbi_tot_co_qty , zlbi_tot_qty , zlbi_vq_gac , zlbi_vq_mode , zlbi_vq_ndc , zlbi_vq_stat , zorig_lbi_own_dt , zoriginal_gac , zoriginal_ndc , zready_date , zready_qt , zretail_price , zrmpo_age , zrmpo_brand , zrmpo_buy_strategy , zrmpo_c_liability_typ , zrmpo_category , zrmpo_close_dt , zrmpo_collection , zrmpo_color , zrmpo_color_desc , zrmpo_cost , zrmpo_create_dt , zrmpo_cur_ownership , zrmpo_dept_code , zrmpo_dispute_case , zrmpo_emo_space , zrmpo_est_yy , zrmpo_expire_dt , zrmpo_fabric_status , zrmpo_flex_rm_id , zrmpo_flex_style_num , zrmpo_floor_set , zrmpo_floorset_name , zrmpo_material_desc , zrmpo_material_type , zrmpo_material_type_color , zrmpo_material_width , zrmpo_month_till_expire , zrmpo_orig_committ_type , zrmpo_orig_ownership , zrmpo_orig_season , zrmpo_orig_value , zrmpo_pending_upd , zrmpo_plan_collection , zrmpo_plan_grp , zrmpo_plan_order_dt , zrmpo_po_color_desc , zrmpo_prev_ownership , zrmpo_quality_num , zrmpo_ready_dt , zrmpo_risk_amount , zrmpo_risk_percent , zrmpo_shared_rm , zrmpo_stat , zrmpo_style_desc , zrmpo_subbrand , zrmpo_sup_cost , zrmpo_sup_expire_dt , zrmpo_sup_notes , zrmpo_sup_ready_dt , zrmpo_supplier , zrmpo_to_party , zrmpo_total_value , zrmpo_units_yy , zrmpo_uom , zrmpo_update_dt , zrmpo_update_dt_usr , zrmpo_update_stat , zrpo_brand , zrpo_buy_strategy , zrpo_dept_cat , zrpo_dept_code , zrpo_est_cost , zrpo_fiscal_month , zrpo_flex_style , zrpo_generic , zrpo_hq_vendor , zrpo_order_date , zrpo_order_qty , zrpo_order_status , zrpo_rapid_po , zrpo_reason_desc , zsc_season_code , act_gac_dt , zscv_category , zscv_cut_qty , zscv_deleted , zscv_department , zscv_division , zscv_fset_date , zscv_lics_ponum , zscv_lz_mcq_amt , zscv_lz_mcq_conf , zscv_lz_qt_price , zscv_lza_callout , zscv_markup , zscv_mast_flag , zscv_pack_date , zscv_pack_qty , zscv_po_ack , zscv_po_multiple , zscv_po_price , zscv_po_status , zscv_prodoffice , zscv_revisedgac , zscv_revisedndc , zscv_revisemode , zscv_rm_vendname , zscv_rm_vendnum , zscv_season , zscv_sew_adate , zscv_sew_pdate , zscv_sew_qty , zscv_so_create , zscv_so_multiple , zscv_tbc_status , zscv_top_date , zscv_vend_close , zscv_vend_flag , zscv_vend_refnun , zscv_xmill_adt , zscv_xmill_pdt , zscv_your_ref , zseason_cat , zseason_year , zship_to_name , zvendor_ref_num , zvsdsku , eh_created_date from  scct_work_db.scem_tracking_objects_tmp where di_operation_type in ('i', 'u', 'e')
! echo completed loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
