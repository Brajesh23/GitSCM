--! echo completed loading into scct_work_db.dy_pyrl_pos_audited_unaudited_master ;
---jobname:scct-aces-hive-stg1-scct_work_db.dy_pyrl_pos_audited_unaudited_merge -------------------------------------------------------------------------- ---target: stage1 table: scct_work_db.dy_pyrl_pos_audited_unaudited_merge ---source: scct_work_db.dy_pyrl_pos_unaudited_tmp1, dy_pyrl_pos_audited_unaudited_master ---load type: incremental load ---back posting: yes --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 10feb20 scctp4-3096 ryadav initial version   ------------------------- ---loading scct_work_db.dy_pyrl_pos_audited_unaudited_merge work table data -------------------------  --set tez.job.name=stage1_scct_db:dy_pyrl_pos_audited_unaudited_merge :load work table dy_pyrl_pos_audited_unaudited_merge ;
--! echo started loading into scct_work_db.dy_pyrl_pos_audited_unaudited_merge ;
insert overwrite into scct_work_db.dy_pyrl_pos_audited_unaudited_merge select coalesce(a.lgcy_sto_nbr,b.lgcy_sto_nbr) as lgcy_sto_nbr ,coalesce(a.brnd_cd,b.brnd_cd) as brnd_cd ,coalesce(a.assc_ssn_nbr,b.assc_ssn_nbr) as assc_ssn_nbr ,coalesce(a.clk_pnch_in_dttm,b.clk_pnch_in_dttm) as clk_pnch_in_dttm ,coalesce(a.clk_pnch_out_dttm,b.clk_pnch_out_dttm) as clk_pnch_out_dttm ,coalesce(a.pyrl_hr_amt,b.pyrl_hr_amt) as pyrl_hr_amt ,coalesce(a.pos_pyrl_cd,b.pos_pyrl_cd) as pos_pyrl_cd ,coalesce(a.hrly_ind,b.hrly_ind) as hrly_ind ,coalesce(a.trxn_post_dt,b.trxn_post_dt) as trxn_post_dt ,coalesce(a.clk_pnch_evnt_id,b.clk_pnch_evnt_id) as clk_pnch_evnt_id ,coalesce(a.lst_mod_dttm,b.lst_mod_dttm) as lst_mod_dttm ,coalesce(a.lst_mod_pty_id_val,b.lst_mod_pty_id_val) as lst_mod_pty_id_val ,coalesce(a.pyrl_tme_typ_nme,b.pyrl_tme_typ_nme) as pyrl_tme_typ_nme ,coalesce(a.prod_pyrl_ind,b.prod_pyrl_ind) as prod_pyrl_ind ,coalesce(a.tplh_flg_ind,b.tplh_flg_ind) as tplh_flg_ind from scct_work_db.dy_pyrl_pos_unaudited_tmp1 a full outer join scct_work_db.dy_pyrl_pos_audited_unaudited_master b on a.assc_ssn_nbr=b.assc_ssn_nbr and a.brnd_cd=b.brnd_cd and a.lgcy_sto_nbr=b.lgcy_sto_nbr and a.pos_pyrl_cd=b.pos_pyrl_cd and a.clk_pnch_evnt_id=b.clk_pnch_evnt_id and cast(a.clk_pnch_in_dttm as date)=cast(b.clk_pnch_in_dttm as date)
insert overwrite into scct_work_db.dy_pyrl_pos_audited_unaudited_master  select lgcy_sto_nbr ,brnd_cd ,assc_ssn_nbr ,clk_pnch_in_dttm ,clk_pnch_out_dttm ,pyrl_hr_amt ,pos_pyrl_cd ,hrly_ind ,trxn_post_dt ,clk_pnch_evnt_id ,lst_mod_dttm ,lst_mod_pty_id_val ,pyrl_tme_typ_nme ,prod_pyrl_ind ,tplh_flg_ind from scct_work_db.dy_pyrl_pos_audited_unaudited_merge
--! echo completed loading into scct_work_db.dy_pyrl_pos_audited_unaudited_merge ;
