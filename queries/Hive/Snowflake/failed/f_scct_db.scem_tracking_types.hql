! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
insert overwrite table scct_db.scem_tracking_types select  coalesce((case when trim(app_log_flag) = '' then null else trim(app_log_flag) end) , 'n/a') as app_log_flg ,coalesce((case when trim(auth_profile) = '' then null else trim(auth_profile) end) , 'n/a') as auth_profile ,coalesce((case when trim(bwprofile) = '' then null else trim(bwprofile) end) , 'n/a') as bw_profile ,coalesce((case when trim(chgdoc_activ) = '' then null else trim(chgdoc_activ) end) , 'n/a') as chgdoc_active ,coalesce((case when trim(chk_unexpected) = '' then null else trim(chk_unexpected) end) , 'n/a') as chk_unexpected ,coalesce((case when trim(condition_id) = '' then null else trim(condition_id) end) , 'n/a') as condition_id ,coalesce((case when trim(cond_rule) = '' then null else trim(cond_rule) end) , 'n/a') as cond_rule ,coalesce((case when trim(created_by) = '' then null else trim(created_by) end) , 'n/a') as created_by ,coalesce((case when created_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(created_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as created_dt ,coalesce((case when trim(disable_eehist) = '' then null else trim(disable_eehist) end) , 'n/a') as disable_ee_hist ,coalesce((case when trim(disable_msmhist) = '' then null else trim(disable_msmhist) end) , 'n/a') as disable_msm_hist ,coalesce((case when trim(disable_stathist) = '' then null else trim(disable_stathist) end) , 'n/a') as disable_stathist ,coalesce((case when trim(ee_process_rule) = '' then null else trim(ee_process_rule) end) , 'n/a') as ee_process_rule ,coalesce((case when trim(ee_profile) = '' then null else trim(ee_profile) end) , 'n/a') as ee_profile ,coalesce((case when trim(evm_ext_table_id) = '' then null else trim(evm_ext_table_id) end) , 'n/a') as evm_ext_table_id ,coalesce((case when trim(ext_table_id) = '' then null else trim(ext_table_id) end) , 'n/a') as ext_table_id ,coalesce((case when trim(loglvl_ehpost) = '' then null else trim(loglvl_ehpost) end) , 'n/a') as log_lvl_eh_post ,coalesce((case when trim(loglvl_extupd) = '' then null else trim(loglvl_extupd) end) , 'n/a') as log_lvl_ext_upd ,coalesce((case when trim(loglvl_msgprc) = '' then null else trim(loglvl_msgprc) end) , 'n/a') as log_lvl_msg_prc ,coalesce((case when trim(mandt) = '' then null else trim(mandt) end) , 0) as mandt ,coalesce((case when trim(no_default_qryid) = '' then null else trim(no_default_qryid) end) , 'n/a') as no_default_qry_id ,coalesce((case when trim(no_load_cntrl) = '' then null else trim(no_load_cntrl) end) , 'n/a') as no_load_cntrl ,coalesce((case when trim(no_load_hier) = '' then null else trim(no_load_hier) end) , 'n/a') as no_load_hier ,coalesce((case when trim(no_load_info) = '' then null else trim(no_load_info) end) , 'n/a') as no_load_info ,coalesce((case when trim(no_load_queryid) = '' then null else trim(no_load_queryid) end) , 'n/a') as no_load_query_id ,coalesce((case when trim(no_load_sys) = '' then null else trim(no_load_sys) end) , 'n/a') as no_load_sys ,coalesce((case when trim(no_load_tasks) = '' then null else trim(no_load_tasks) end) , 'n/a') as no_load_tasks ,coalesce((case when trim(no_load_trkid) = '' then null else trim(no_load_trkid) end) , 'n/a') as no_load_trk_id ,coalesce((case when priority = '' then null else priority end) , 0) as priority ,coalesce((case when trim(reproc_sort_rule) = '' then null else trim(reproc_sort_rule) end) , 'n/a') as reproc_sort_rule ,coalesce((case when trim(ruleset) = '' then null else trim(ruleset) end) , 'n/a') as ruleset ,coalesce((case when trim(status_prof) = '' then null else trim(status_prof) end) , 'n/a') as status_prof ,coalesce((case when trim(trk_mode) = '' then null else trim(trk_mode) end) , 'n/a') as trk_mode ,coalesce((case when trim(trk_obj_type) = '' then null else trim(trk_obj_type) end) , 'n/a') as trk_obj_type ,coalesce((case when trim(trk_type) = '' then null else trim(trk_type) end) , 'n/a') as trk_type ,coalesce((case when trim(updated_by) = '' then null else trim(updated_by) end), 'n/a') as updated_by ,coalesce((case when updated_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(updated_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as updated_dt ,coalesce((case when trim(update_proc_1) = '' then null else trim(update_proc_1) end) , 'n/a') as update_proc_1 ,coalesce((case when trim(update_proc_2) = '' then null else trim(update_proc_2) end) , 'n/a') as update_proc_2 from sap_stage0.saptrx_trktype
! echo completed loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
insert overwrite table scct_db.scem_tracking_types select  coalesce((case when trim(app_log_flag) = '' then null else trim(app_log_flag) end) , 'n/a') as app_log_flg ,coalesce((case when trim(auth_profile) = '' then null else trim(auth_profile) end) , 'n/a') as auth_profile ,coalesce((case when trim(bwprofile) = '' then null else trim(bwprofile) end) , 'n/a') as bw_profile ,coalesce((case when trim(chgdoc_activ) = '' then null else trim(chgdoc_activ) end) , 'n/a') as chgdoc_active ,coalesce((case when trim(chk_unexpected) = '' then null else trim(chk_unexpected) end) , 'n/a') as chk_unexpected ,coalesce((case when trim(condition_id) = '' then null else trim(condition_id) end) , 'n/a') as condition_id ,coalesce((case when trim(cond_rule) = '' then null else trim(cond_rule) end) , 'n/a') as cond_rule ,coalesce((case when trim(created_by) = '' then null else trim(created_by) end) , 'n/a') as created_by ,coalesce((case when created_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(created_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as created_dt ,coalesce((case when trim(disable_eehist) = '' then null else trim(disable_eehist) end) , 'n/a') as disable_ee_hist ,coalesce((case when trim(disable_msmhist) = '' then null else trim(disable_msmhist) end) , 'n/a') as disable_msm_hist ,coalesce((case when trim(disable_stathist) = '' then null else trim(disable_stathist) end) , 'n/a') as disable_stathist ,coalesce((case when trim(ee_process_rule) = '' then null else trim(ee_process_rule) end) , 'n/a') as ee_process_rule ,coalesce((case when trim(ee_profile) = '' then null else trim(ee_profile) end) , 'n/a') as ee_profile ,coalesce((case when trim(evm_ext_table_id) = '' then null else trim(evm_ext_table_id) end) , 'n/a') as evm_ext_table_id ,coalesce((case when trim(ext_table_id) = '' then null else trim(ext_table_id) end) , 'n/a') as ext_table_id ,coalesce((case when trim(loglvl_ehpost) = '' then null else trim(loglvl_ehpost) end) , 'n/a') as log_lvl_eh_post ,coalesce((case when trim(loglvl_extupd) = '' then null else trim(loglvl_extupd) end) , 'n/a') as log_lvl_ext_upd ,coalesce((case when trim(loglvl_msgprc) = '' then null else trim(loglvl_msgprc) end) , 'n/a') as log_lvl_msg_prc ,coalesce((case when trim(mandt) = '' then null else trim(mandt) end) , 0) as mandt ,coalesce((case when trim(no_default_qryid) = '' then null else trim(no_default_qryid) end) , 'n/a') as no_default_qry_id ,coalesce((case when trim(no_load_cntrl) = '' then null else trim(no_load_cntrl) end) , 'n/a') as no_load_cntrl ,coalesce((case when trim(no_load_hier) = '' then null else trim(no_load_hier) end) , 'n/a') as no_load_hier ,coalesce((case when trim(no_load_info) = '' then null else trim(no_load_info) end) , 'n/a') as no_load_info ,coalesce((case when trim(no_load_queryid) = '' then null else trim(no_load_queryid) end) , 'n/a') as no_load_query_id ,coalesce((case when trim(no_load_sys) = '' then null else trim(no_load_sys) end) , 'n/a') as no_load_sys ,coalesce((case when trim(no_load_tasks) = '' then null else trim(no_load_tasks) end) , 'n/a') as no_load_tasks ,coalesce((case when trim(no_load_trkid) = '' then null else trim(no_load_trkid) end) , 'n/a') as no_load_trk_id ,coalesce((case when priority = '' then null else priority end) , 0) as priority ,coalesce((case when trim(reproc_sort_rule) = '' then null else trim(reproc_sort_rule) end) , 'n/a') as reproc_sort_rule ,coalesce((case when trim(ruleset) = '' then null else trim(ruleset) end) , 'n/a') as ruleset ,coalesce((case when trim(status_prof) = '' then null else trim(status_prof) end) , 'n/a') as status_prof ,coalesce((case when trim(trk_mode) = '' then null else trim(trk_mode) end) , 'n/a') as trk_mode ,coalesce((case when trim(trk_obj_type) = '' then null else trim(trk_obj_type) end) , 'n/a') as trk_obj_type ,coalesce((case when trim(trk_type) = '' then null else trim(trk_type) end) , 'n/a') as trk_type ,coalesce((case when trim(updated_by) = '' then null else trim(updated_by) end), 'n/a') as updated_by ,coalesce((case when updated_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(updated_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as updated_dt ,coalesce((case when trim(update_proc_1) = '' then null else trim(update_proc_1) end) , 'n/a') as update_proc_1 ,coalesce((case when trim(update_proc_2) = '' then null else trim(update_proc_2) end) , 'n/a') as update_proc_2 from sap_stage0.saptrx_trktype
! echo completed loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
insert overwrite table scct_db.scem_tracking_types select  coalesce((case when trim(app_log_flag) = '' then null else trim(app_log_flag) end) , 'n/a') as app_log_flg ,coalesce((case when trim(auth_profile) = '' then null else trim(auth_profile) end) , 'n/a') as auth_profile ,coalesce((case when trim(bwprofile) = '' then null else trim(bwprofile) end) , 'n/a') as bw_profile ,coalesce((case when trim(chgdoc_activ) = '' then null else trim(chgdoc_activ) end) , 'n/a') as chgdoc_active ,coalesce((case when trim(chk_unexpected) = '' then null else trim(chk_unexpected) end) , 'n/a') as chk_unexpected ,coalesce((case when trim(condition_id) = '' then null else trim(condition_id) end) , 'n/a') as condition_id ,coalesce((case when trim(cond_rule) = '' then null else trim(cond_rule) end) , 'n/a') as cond_rule ,coalesce((case when trim(created_by) = '' then null else trim(created_by) end) , 'n/a') as created_by ,coalesce((case when created_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(created_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as created_dt ,coalesce((case when trim(disable_eehist) = '' then null else trim(disable_eehist) end) , 'n/a') as disable_ee_hist ,coalesce((case when trim(disable_msmhist) = '' then null else trim(disable_msmhist) end) , 'n/a') as disable_msm_hist ,coalesce((case when trim(disable_stathist) = '' then null else trim(disable_stathist) end) , 'n/a') as disable_stathist ,coalesce((case when trim(ee_process_rule) = '' then null else trim(ee_process_rule) end) , 'n/a') as ee_process_rule ,coalesce((case when trim(ee_profile) = '' then null else trim(ee_profile) end) , 'n/a') as ee_profile ,coalesce((case when trim(evm_ext_table_id) = '' then null else trim(evm_ext_table_id) end) , 'n/a') as evm_ext_table_id ,coalesce((case when trim(ext_table_id) = '' then null else trim(ext_table_id) end) , 'n/a') as ext_table_id ,coalesce((case when trim(loglvl_ehpost) = '' then null else trim(loglvl_ehpost) end) , 'n/a') as log_lvl_eh_post ,coalesce((case when trim(loglvl_extupd) = '' then null else trim(loglvl_extupd) end) , 'n/a') as log_lvl_ext_upd ,coalesce((case when trim(loglvl_msgprc) = '' then null else trim(loglvl_msgprc) end) , 'n/a') as log_lvl_msg_prc ,coalesce((case when trim(mandt) = '' then null else trim(mandt) end) , 0) as mandt ,coalesce((case when trim(no_default_qryid) = '' then null else trim(no_default_qryid) end) , 'n/a') as no_default_qry_id ,coalesce((case when trim(no_load_cntrl) = '' then null else trim(no_load_cntrl) end) , 'n/a') as no_load_cntrl ,coalesce((case when trim(no_load_hier) = '' then null else trim(no_load_hier) end) , 'n/a') as no_load_hier ,coalesce((case when trim(no_load_info) = '' then null else trim(no_load_info) end) , 'n/a') as no_load_info ,coalesce((case when trim(no_load_queryid) = '' then null else trim(no_load_queryid) end) , 'n/a') as no_load_query_id ,coalesce((case when trim(no_load_sys) = '' then null else trim(no_load_sys) end) , 'n/a') as no_load_sys ,coalesce((case when trim(no_load_tasks) = '' then null else trim(no_load_tasks) end) , 'n/a') as no_load_tasks ,coalesce((case when trim(no_load_trkid) = '' then null else trim(no_load_trkid) end) , 'n/a') as no_load_trk_id ,coalesce((case when priority = '' then null else priority end) , 0) as priority ,coalesce((case when trim(reproc_sort_rule) = '' then null else trim(reproc_sort_rule) end) , 'n/a') as reproc_sort_rule ,coalesce((case when trim(ruleset) = '' then null else trim(ruleset) end) , 'n/a') as ruleset ,coalesce((case when trim(status_prof) = '' then null else trim(status_prof) end) , 'n/a') as status_prof ,coalesce((case when trim(trk_mode) = '' then null else trim(trk_mode) end) , 'n/a') as trk_mode ,coalesce((case when trim(trk_obj_type) = '' then null else trim(trk_obj_type) end) , 'n/a') as trk_obj_type ,coalesce((case when trim(trk_type) = '' then null else trim(trk_type) end) , 'n/a') as trk_type ,coalesce((case when trim(updated_by) = '' then null else trim(updated_by) end), 'n/a') as updated_by ,coalesce((case when updated_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(updated_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as updated_dt ,coalesce((case when trim(update_proc_1) = '' then null else trim(update_proc_1) end) , 'n/a') as update_proc_1 ,coalesce((case when trim(update_proc_2) = '' then null else trim(update_proc_2) end) , 'n/a') as update_proc_2 from sap_stage0.saptrx_trktype
! echo completed loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
insert overwrite table scct_db.scem_tracking_types select  coalesce((case when trim(app_log_flag) = '' then null else trim(app_log_flag) end) , 'n/a') as app_log_flg ,coalesce((case when trim(auth_profile) = '' then null else trim(auth_profile) end) , 'n/a') as auth_profile ,coalesce((case when trim(bwprofile) = '' then null else trim(bwprofile) end) , 'n/a') as bw_profile ,coalesce((case when trim(chgdoc_activ) = '' then null else trim(chgdoc_activ) end) , 'n/a') as chgdoc_active ,coalesce((case when trim(chk_unexpected) = '' then null else trim(chk_unexpected) end) , 'n/a') as chk_unexpected ,coalesce((case when trim(condition_id) = '' then null else trim(condition_id) end) , 'n/a') as condition_id ,coalesce((case when trim(cond_rule) = '' then null else trim(cond_rule) end) , 'n/a') as cond_rule ,coalesce((case when trim(created_by) = '' then null else trim(created_by) end) , 'n/a') as created_by ,coalesce((case when created_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(created_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as created_dt ,coalesce((case when trim(disable_eehist) = '' then null else trim(disable_eehist) end) , 'n/a') as disable_ee_hist ,coalesce((case when trim(disable_msmhist) = '' then null else trim(disable_msmhist) end) , 'n/a') as disable_msm_hist ,coalesce((case when trim(disable_stathist) = '' then null else trim(disable_stathist) end) , 'n/a') as disable_stathist ,coalesce((case when trim(ee_process_rule) = '' then null else trim(ee_process_rule) end) , 'n/a') as ee_process_rule ,coalesce((case when trim(ee_profile) = '' then null else trim(ee_profile) end) , 'n/a') as ee_profile ,coalesce((case when trim(evm_ext_table_id) = '' then null else trim(evm_ext_table_id) end) , 'n/a') as evm_ext_table_id ,coalesce((case when trim(ext_table_id) = '' then null else trim(ext_table_id) end) , 'n/a') as ext_table_id ,coalesce((case when trim(loglvl_ehpost) = '' then null else trim(loglvl_ehpost) end) , 'n/a') as log_lvl_eh_post ,coalesce((case when trim(loglvl_extupd) = '' then null else trim(loglvl_extupd) end) , 'n/a') as log_lvl_ext_upd ,coalesce((case when trim(loglvl_msgprc) = '' then null else trim(loglvl_msgprc) end) , 'n/a') as log_lvl_msg_prc ,coalesce((case when trim(mandt) = '' then null else trim(mandt) end) , 0) as mandt ,coalesce((case when trim(no_default_qryid) = '' then null else trim(no_default_qryid) end) , 'n/a') as no_default_qry_id ,coalesce((case when trim(no_load_cntrl) = '' then null else trim(no_load_cntrl) end) , 'n/a') as no_load_cntrl ,coalesce((case when trim(no_load_hier) = '' then null else trim(no_load_hier) end) , 'n/a') as no_load_hier ,coalesce((case when trim(no_load_info) = '' then null else trim(no_load_info) end) , 'n/a') as no_load_info ,coalesce((case when trim(no_load_queryid) = '' then null else trim(no_load_queryid) end) , 'n/a') as no_load_query_id ,coalesce((case when trim(no_load_sys) = '' then null else trim(no_load_sys) end) , 'n/a') as no_load_sys ,coalesce((case when trim(no_load_tasks) = '' then null else trim(no_load_tasks) end) , 'n/a') as no_load_tasks ,coalesce((case when trim(no_load_trkid) = '' then null else trim(no_load_trkid) end) , 'n/a') as no_load_trk_id ,coalesce((case when priority = '' then null else priority end) , 0) as priority ,coalesce((case when trim(reproc_sort_rule) = '' then null else trim(reproc_sort_rule) end) , 'n/a') as reproc_sort_rule ,coalesce((case when trim(ruleset) = '' then null else trim(ruleset) end) , 'n/a') as ruleset ,coalesce((case when trim(status_prof) = '' then null else trim(status_prof) end) , 'n/a') as status_prof ,coalesce((case when trim(trk_mode) = '' then null else trim(trk_mode) end) , 'n/a') as trk_mode ,coalesce((case when trim(trk_obj_type) = '' then null else trim(trk_obj_type) end) , 'n/a') as trk_obj_type ,coalesce((case when trim(trk_type) = '' then null else trim(trk_type) end) , 'n/a') as trk_type ,coalesce((case when trim(updated_by) = '' then null else trim(updated_by) end), 'n/a') as updated_by ,coalesce((case when updated_date = 0 then null else from_unixtime(unix_timestamp(substring(cast(updated_date as bigint),1,8),'yyyymmdd'),'yyyy-mm-dd') end) ,'9999-12-31') as updated_dt ,coalesce((case when trim(update_proc_1) = '' then null else trim(update_proc_1) end) , 'n/a') as update_proc_1 ,coalesce((case when trim(update_proc_2) = '' then null else trim(update_proc_2) end) , 'n/a') as update_proc_2 from sap_stage0.saptrx_trktype
! echo completed loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_expected_events;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;
! echo started loading into scct_db.scem_tracking_events ;
! echo completed loading into scct_db.scem_tracking_events ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type <> 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column & settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;
! echo started loading into scct_db.scem_tracking_objects ;
! echo completed loading into scct_db.scem_tracking_objects ;
---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;
------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;
! echo started loading into scct_db.scem_tracking_types ;
! echo completed loading into scct_db.scem_tracking_types ;
