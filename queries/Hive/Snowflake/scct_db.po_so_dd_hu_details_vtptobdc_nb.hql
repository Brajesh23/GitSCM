---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT DISTINCT 'vendor' AS SPPLY_CHN_ND, 'vendor_turnkey' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, 'n/a' AS DM_DELV_DOC_NBR, 0 AS DM_DELV_DOC_ITM_NBR, 'n/a' AS DM_DEL_TYPE, 0.000 AS DM_ACT_DELV_QTY, '9999-12-31' AS DM_ACTL_GDS_MOVMT_DT, 0 AS DM_DELV_PRTY, 0.000 AS DM_DELV_QTY, '9999-12-31' AS DM_GDS_ISS_DATE, 'n/a' AS DM_RCVG_STE_DELV, '9999-12-31' AS DM_HDR_REC_CRTD_DT, 0 AS DM_REF_DOC_ITM_NBR, 'n/a' AS DM_REF_DOC_NBR, 'n/a' AS DM_SHP_RCVG_PT, 'n/a' AS DM_GDS_MOVMT_CNTL, 'n/a' AS DM_MOVMT_IND, 'n/a' AS DM_POD_IND, 'n/a' AS DM_POD_RLSE_IND, 'n/a' AS DM_RECV_LOC_NBR, 'n/a' AS DM_TRANSP_TYPE, 'n/a' AS DM_TRANSP_ID, 'n/a' AS HM_INTL_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR_2, 'n/a' AS HM_EXT_HNDLG_UNT_TYPE, 'n/a' AS HM_PCKG_MAT_TYPE, 0.000 AS HM_PCKD_QTY, 'n/a' AS HM_PCKD_UOM, 0.00 AS IUM_NUMERATOR, 0.000 AS HM_GRS_WGT, 'n/a' AS HM_WGT_UNT, 0.000 AS HM_LEN, 0.000 AS HM_WDT, 0.000 AS HM_HGT, 'n/a' AS HM_DIM_UOM, '9999-12-31' AS HM_REC_CHGD_DT, 'n/a' AS HM_HNDLG_UNT_STAT, '9999-12-31' AS HM_BOL_DT, '9999-12-31' AS HM_STR_DT, '9999-12-31' AS HM_DA_SCAN_DT, 0 AS HM_LOAD_NBR, COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a') AS SUPL_LOC_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'turnkey_production' AS BUSINESS_PROCESS, 'dc_brand' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'nb' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND SUBCON_COMP_FLG = 'n/a' AND ITM_CAT_CD <> '3' AND VEND_ACCT_ID <> 'n/a' AND LOC_NBR <> 'n/a' AND SLS_ORD_NBR <> 'n/a') AS PO
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '99') AS A ON PO.VEND_ACCT_ID = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01' AND ORG_NUM = '1117') AS B ON PO.LOC_NBR = B.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE SLS_DOC_TYPE = 'zom7') AS SO ON PO.SLS_ORD_NBR = SO.SLS_ORD_NBR AND PO.SLS_ORD_ITM_NBR = SO.SLS_ORD_ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND REF_PURCH_ORD_NBR <> 'n/a' AND REF_PURCH_ORD_ITM_NBR <> 0) AS PO2 ON PO.PURCH_ORD_NBR = PO2.REF_PURCH_ORD_NBR AND PO.PURCH_ORD_ITM_NBR = PO2.REF_PURCH_ORD_ITM_NBR);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT DISTINCT 'vendor' AS SPPLY_CHN_ND, 'vendor_turnkey' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, 'n/a' AS DM_DELV_DOC_NBR, 0 AS DM_DELV_DOC_ITM_NBR, 'n/a' AS DM_DEL_TYPE, 0.000 AS DM_ACT_DELV_QTY, '9999-12-31' AS DM_ACTL_GDS_MOVMT_DT, 0 AS DM_DELV_PRTY, 0.000 AS DM_DELV_QTY, '9999-12-31' AS DM_GDS_ISS_DATE, 'n/a' AS DM_RCVG_STE_DELV, '9999-12-31' AS DM_HDR_REC_CRTD_DT, 0 AS DM_REF_DOC_ITM_NBR, 'n/a' AS DM_REF_DOC_NBR, 'n/a' AS DM_SHP_RCVG_PT, 'n/a' AS DM_GDS_MOVMT_CNTL, 'n/a' AS DM_MOVMT_IND, 'n/a' AS DM_POD_IND, 'n/a' AS DM_POD_RLSE_IND, 'n/a' AS DM_RECV_LOC_NBR, 'n/a' AS DM_TRANSP_TYPE, 'n/a' AS DM_TRANSP_ID, 'n/a' AS HM_INTL_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR_2, 'n/a' AS HM_EXT_HNDLG_UNT_TYPE, 'n/a' AS HM_PCKG_MAT_TYPE, 0.000 AS HM_PCKD_QTY, 'n/a' AS HM_PCKD_UOM, 0.00 AS IUM_NUMERATOR, 0.000 AS HM_GRS_WGT, 'n/a' AS HM_WGT_UNT, 0.000 AS HM_LEN, 0.000 AS HM_WDT, 0.000 AS HM_HGT, 'n/a' AS HM_DIM_UOM, '9999-12-31' AS HM_REC_CHGD_DT, 'n/a' AS HM_HNDLG_UNT_STAT, '9999-12-31' AS HM_BOL_DT, '9999-12-31' AS HM_STR_DT, '9999-12-31' AS HM_DA_SCAN_DT, 0 AS HM_LOAD_NBR, COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a') AS SUPL_LOC_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'turnkey_production' AS BUSINESS_PROCESS, 'dc_brand' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'nb' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND SUBCON_COMP_FLG = 'n/a' AND ITM_CAT_CD <> '3' AND VEND_ACCT_ID <> 'n/a' AND LOC_NBR <> 'n/a' AND SLS_ORD_NBR <> 'n/a') AS PO
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '99') AS A ON PO.VEND_ACCT_ID = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01' AND ORG_NUM = '1117') AS B ON PO.LOC_NBR = B.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE SLS_DOC_TYPE = 'zom7') AS SO ON PO.SLS_ORD_NBR = SO.SLS_ORD_NBR AND PO.SLS_ORD_ITM_NBR = SO.SLS_ORD_ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND REF_PURCH_ORD_NBR <> 'n/a' AND REF_PURCH_ORD_ITM_NBR <> 0) AS PO2 ON PO.PURCH_ORD_NBR = PO2.REF_PURCH_ORD_NBR AND PO.PURCH_ORD_ITM_NBR = PO2.REF_PURCH_ORD_ITM_NBR);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT DISTINCT 'vendor' AS SPPLY_CHN_ND, 'vendor_turnkey' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, 'n/a' AS DM_DELV_DOC_NBR, 0 AS DM_DELV_DOC_ITM_NBR, 'n/a' AS DM_DEL_TYPE, 0.000 AS DM_ACT_DELV_QTY, '9999-12-31' AS DM_ACTL_GDS_MOVMT_DT, 0 AS DM_DELV_PRTY, 0.000 AS DM_DELV_QTY, '9999-12-31' AS DM_GDS_ISS_DATE, 'n/a' AS DM_RCVG_STE_DELV, '9999-12-31' AS DM_HDR_REC_CRTD_DT, 0 AS DM_REF_DOC_ITM_NBR, 'n/a' AS DM_REF_DOC_NBR, 'n/a' AS DM_SHP_RCVG_PT, 'n/a' AS DM_GDS_MOVMT_CNTL, 'n/a' AS DM_MOVMT_IND, 'n/a' AS DM_POD_IND, 'n/a' AS DM_POD_RLSE_IND, 'n/a' AS DM_RECV_LOC_NBR, 'n/a' AS DM_TRANSP_TYPE, 'n/a' AS DM_TRANSP_ID, 'n/a' AS HM_INTL_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR_2, 'n/a' AS HM_EXT_HNDLG_UNT_TYPE, 'n/a' AS HM_PCKG_MAT_TYPE, 0.000 AS HM_PCKD_QTY, 'n/a' AS HM_PCKD_UOM, 0.00 AS IUM_NUMERATOR, 0.000 AS HM_GRS_WGT, 'n/a' AS HM_WGT_UNT, 0.000 AS HM_LEN, 0.000 AS HM_WDT, 0.000 AS HM_HGT, 'n/a' AS HM_DIM_UOM, '9999-12-31' AS HM_REC_CHGD_DT, 'n/a' AS HM_HNDLG_UNT_STAT, '9999-12-31' AS HM_BOL_DT, '9999-12-31' AS HM_STR_DT, '9999-12-31' AS HM_DA_SCAN_DT, 0 AS HM_LOAD_NBR, COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a') AS SUPL_LOC_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'turnkey_production' AS BUSINESS_PROCESS, 'dc_brand' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'nb' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND SUBCON_COMP_FLG = 'n/a' AND ITM_CAT_CD <> '3' AND VEND_ACCT_ID <> 'n/a' AND LOC_NBR <> 'n/a' AND SLS_ORD_NBR <> 'n/a') AS PO
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '99') AS A ON PO.VEND_ACCT_ID = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01' AND ORG_NUM = '1117') AS B ON PO.LOC_NBR = B.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE SLS_DOC_TYPE = 'zom7') AS SO ON PO.SLS_ORD_NBR = SO.SLS_ORD_NBR AND PO.SLS_ORD_ITM_NBR = SO.SLS_ORD_ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND REF_PURCH_ORD_NBR <> 'n/a' AND REF_PURCH_ORD_ITM_NBR <> 0) AS PO2 ON PO.PURCH_ORD_NBR = PO2.REF_PURCH_ORD_NBR AND PO.PURCH_ORD_ITM_NBR = PO2.REF_PURCH_ORD_ITM_NBR);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
INSERT OVERWRITE INTO SCCT_DB.PO_SO_DD_HU_DETAILS
(SELECT DISTINCT 'vendor' AS SPPLY_CHN_ND, 'vendor_turnkey' AS FROM_NODE, PO.PURCH_ORD_NBR, PO.PURCH_ORD_ITM_NBR, COALESCE(PO.DEL_IND, 'n/a') AS DEL_IND, COALESCE(PO.ITM_NBR, '0') AS ITM_NBR, COALESCE(PO.CO_CD, 'n/a'), COALESCE(PO.LOC_NBR, 'n/a'), COALESCE(PO.PURCH_ORD_QTY, 0.000), COALESCE(PO.PURCH_ORD_QTY_UOM, 'n/a'), COALESCE(PO.ORD_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.BASE_UNT_NMRTR_CONVN_NBR, 0), COALESCE(PO.NET_ORD_VAL_CURCY, 0.00), COALESCE(PO.DELV_COMPLN_IND, 'n/a'), COALESCE(PO.BASE_UOM_CD, 'n/a'), COALESCE(PO.PURCH_ORD_QTY * PO.BASE_UNT_NMRTR_CONVN_NBR / PO.BASE_UNT_DNMNTR_CONVN_NBR, 0.000), COALESCE(PO.MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.ORIG_MAST_OWNSHP_DT, '9999-12-31'), COALESCE(PO.PURCH_DOC_TYPE_CD, 'n/a'), COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a'), COALESCE(PO.PURCHG_ORG_CD, 'n/a'), COALESCE(PO.PURCHG_GRP_CD, 'n/a'), COALESCE(PO.CUST_NBR, 'n/a'), COALESCE(PO.INCTRM_1, 'n/a'), COALESCE(PO.INCTRM_2, 'n/a'), COALESCE(PO.OUR_REF, 'n/a'), COALESCE(PO.TRANSP_MODE, 'n/a'), COALESCE(PO.SLS_ORD_NBR, 'n/a'), COALESCE(PO.SLS_ORD_ITM_NBR, 0), COALESCE(PO.COORIG, 'n/a'), COALESCE(PO.NDC_DT, '9999-12-31'), COALESCE(PO.STAT_NDC_DT, '9999-12-31'), COALESCE(PO.PO_CREATE_DT, '9999-12-31'), COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a'), COALESCE(PO.REC_CRTD_DT, '9999-12-31') AS REC_CRTD_DT, COALESCE(PO.FLOORSET_DT, '9999-12-31'), COALESCE(SO.SLS_ORD_NBR, 'n/a') AS SO_SLS_ORD_NBR, COALESCE(SO.SLS_ORD_ITM_NBR, 0) AS SO_SLS_ORD_ITM_NBR, COALESCE(SO.ITM_NBR, 'n/a') AS SO_ITM_NBR, COALESCE(SO.NET_VAL, 0.00) AS SO_NET_VAL, COALESCE(SO.ORD_QTY_SLS_UNT, 0.000) AS SO_ORD_QTY_SLS_UNT, COALESCE(SO.RECV_LOC_NBR, 'n/a') AS SO_RECV_LOC_NBR, COALESCE(SO.REC_CRTD_DT, '9999-12-31') AS SO_REC_CRTD_DT, COALESCE(SO.REC_CRTD_ID, 'n/a') AS SO_REC_CRTD_ID, COALESCE(SO.COST, 0.00) AS SO_COST, COALESCE(SO.REQSTD_DT, '9999-12-31') AS SO_REQSTD_DT, COALESCE(SO.CUST_PRCH_NBR, 'n/a') AS SO_CUST_PRCH_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS SO_SHIP_TO_LOC_NBR, COALESCE(SO.CNTRY_CD, 'n/a') AS SO_CNTRY_CD, COALESCE(SO.SLS_DOC_TYPE, 'n/a') AS SO_SLS_DOC_TYPE, 'n/a' AS DM_DELV_DOC_NBR, 0 AS DM_DELV_DOC_ITM_NBR, 'n/a' AS DM_DEL_TYPE, 0.000 AS DM_ACT_DELV_QTY, '9999-12-31' AS DM_ACTL_GDS_MOVMT_DT, 0 AS DM_DELV_PRTY, 0.000 AS DM_DELV_QTY, '9999-12-31' AS DM_GDS_ISS_DATE, 'n/a' AS DM_RCVG_STE_DELV, '9999-12-31' AS DM_HDR_REC_CRTD_DT, 0 AS DM_REF_DOC_ITM_NBR, 'n/a' AS DM_REF_DOC_NBR, 'n/a' AS DM_SHP_RCVG_PT, 'n/a' AS DM_GDS_MOVMT_CNTL, 'n/a' AS DM_MOVMT_IND, 'n/a' AS DM_POD_IND, 'n/a' AS DM_POD_RLSE_IND, 'n/a' AS DM_RECV_LOC_NBR, 'n/a' AS DM_TRANSP_TYPE, 'n/a' AS DM_TRANSP_ID, 'n/a' AS HM_INTL_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR, 'n/a' AS HM_EXT_HNDLG_UNT_NBR_2, 'n/a' AS HM_EXT_HNDLG_UNT_TYPE, 'n/a' AS HM_PCKG_MAT_TYPE, 0.000 AS HM_PCKD_QTY, 'n/a' AS HM_PCKD_UOM, 0.00 AS IUM_NUMERATOR, 0.000 AS HM_GRS_WGT, 'n/a' AS HM_WGT_UNT, 0.000 AS HM_LEN, 0.000 AS HM_WDT, 0.000 AS HM_HGT, 'n/a' AS HM_DIM_UOM, '9999-12-31' AS HM_REC_CHGD_DT, 'n/a' AS HM_HNDLG_UNT_STAT, '9999-12-31' AS HM_BOL_DT, '9999-12-31' AS HM_STR_DT, '9999-12-31' AS HM_DA_SCAN_DT, 0 AS HM_LOAD_NBR, COALESCE(CASE WHEN TRIM( PO.VEND_ACCT_ID) = '' THEN NULL ELSE TRIM( PO.VEND_ACCT_ID) END, 'n/a') AS SUPL_LOC_NBR, COALESCE(SO.SHIP_TO_LOC_NBR, 'n/a') AS RECV_LOC_NBR, 'turnkey_production' AS BUSINESS_PROCESS, 'dc_brand' AS TO_NODE, PO.PURCH_DOC_TYPE_CD AS PO_DOC_TYP
FROM (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'nb' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND SUBCON_COMP_FLG = 'n/a' AND ITM_CAT_CD <> '3' AND VEND_ACCT_ID <> 'n/a' AND LOC_NBR <> 'n/a' AND SLS_ORD_NBR <> 'n/a') AS PO
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '99') AS A ON PO.VEND_ACCT_ID = A.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.LOCATION_MASTER
WHERE LOC_TYP_CD = '01' AND ORG_NUM = '1117') AS B ON PO.LOC_NBR = B.LOC_NBR
INNER JOIN (SELECT *
FROM SCCT_DB.SO_MASTER
WHERE SLS_DOC_TYPE = 'zom7') AS SO ON PO.SLS_ORD_NBR = SO.SLS_ORD_NBR AND PO.SLS_ORD_ITM_NBR = SO.SLS_ORD_ITM_NBR
LEFT JOIN (SELECT *
FROM SCCT_DB.PO_MASTER
WHERE PURCH_DOC_TYPE_CD = 'zbpo' AND (DEL_IND <> 'l' OR DEL_IND = 'l' AND GR_QTY > 0) AND REF_PURCH_ORD_NBR <> 'n/a' AND REF_PURCH_ORD_ITM_NBR <> 0) AS PO2 ON PO.PURCH_ORD_NBR = PO2.REF_PURCH_ORD_NBR AND PO.PURCH_ORD_ITM_NBR = PO2.REF_PURCH_ORD_ITM_NBR);
