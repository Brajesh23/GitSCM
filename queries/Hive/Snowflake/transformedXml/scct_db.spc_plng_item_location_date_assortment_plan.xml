<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<SnowBlocks>
<SnowBlock id="1">
<Step id="spc_plng_day_item_location_presentation_qty_1">
<Print>![CDATA[completed loading into scct_db.spc_plng_day_item_location_presentation_qty ;]]</Print>
<Comment>![CDATA[---jobname:scct-ikb-hive-stg1-scct_db.spc_plng_item_location_date_assortment_plan --------------------------------------------------------------------------- ---target: stage1 table: scct_db.spc_plng_item_location_date_assortment_plan ---source: pkms_stage0 table : ltsmstr_lbi_reporting ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 20nov18 ssoma initial version -- 01.00.00.02 23sep19 scctp4-2471 ryadav mapr remediation changes for column names, item and location length   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;]]</Comment>
<Sql>![CDATA[------------------------- ---loading stage1 table spc_plng_item_location_date_assortment_plan from source table ltsmstr_lbi_reporting -------------------------  insert overwrite table scct_db.spc_plng_item_location_date_assortment_plan partition(snapshot_dt) select distinct coalesce((case when trim(productid)='' then null else lpad(trim(productid),18,0) end),'n/a') as itm_nbr ,coalesce((case when trim(storenumber)='' then null else coalesce(l.location_number,storenumber) end),'n/a') as loc_nbr ,coalesce((case when trim(mpq)='' then null else trim(mpq ) end),0.00) as minimum_presentation_qty ,coalesce((case when trim(startdate)='' then null else from_unixtime(unix_timestamp(startdate,'yyyymmdd'),'yyyy-mm-dd') end), '9999-12-31') as effective_dt ,coalesce((case when trim(enddate)='' then null else from_unixtime(unix_timestamp(enddate,'yyyymmdd'),'yyyy-mm-dd') end), '9999-12-31') as discontinue_dt ,coalesce((case when trim(poglocation)='' then null else trim(poglocation) end),'n/a') as pog_location ,coalesce((case when trim(pogkey)='' then null else trim(pogkey) end),'n/a') as pog_key ,coalesce((case when trim(pogname)='' then null else trim(pogname) end),'n/a') as pog_name ,date_sub(current_date,1) as snapshot_dt from ikb_stage0.ltsmstr_lbi_reporting llr left outer join (select location_number from analytics_db.location where location_type_code = '04')l  on lpad(llr.storenumber,10,0) = l.location_number distribute by snapshot_dt;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Print>![CDATA[completed loading into scct_db.scem_expected_events;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="2">
<Step id="spc_plng_day_item_location_presentation_qty_2">
<Sql>![CDATA[---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type &lt;&gt; 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column &amp; settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;]]</Comment>
<Print>![CDATA[started loading into scct_db.scem_tracking_events ;]]</Print>
<Print>![CDATA[completed loading into scct_db.scem_tracking_events ;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="3">
<Step id="spc_plng_day_item_location_presentation_qty_3">
<Sql>![CDATA[---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type &lt;&gt; 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column &amp; settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;]]</Comment>
<Print>![CDATA[started loading into scct_db.scem_tracking_objects ;]]</Print>
<Print>![CDATA[completed loading into scct_db.scem_tracking_objects ;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="4">
<Step id="spc_plng_day_item_location_presentation_qty_4">
<Sql>![CDATA[---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;]]</Comment>
<Print>![CDATA[started loading into scct_db.scem_tracking_types ;]]</Print>
<Print>![CDATA[completed loading into scct_db.scem_tracking_types ;]]</Print>
<Comment>![CDATA[---jobname:scct-ufposo-hive-stg1-so_line_kpi_dcb_to_dcm_aprl -------------------------------------------------------------------------- ---target: stage1 table: scct_db.so_line_kpi  ---source: tms_stage0 table : delivery_master, handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 07jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------   set hive.auto.convert.join.noconditionaltask.size=200000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading dd line kpi's data into so_line_kpi table -------------------------  set tez.job.name=load dd line kpis:so_line_kpi :load target from delivery_master ;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_line_kpi;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-usposo-hive-stg1-so_line_kpi_dcoutboundso -------------------------------------------------------------------------- ---target: stage1 table: scct_db.so_line_kpi  ---source: tms_stage0 table : delivery_master, handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 07jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------   set hive.auto.convert.join.noconditionaltask.size=200000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading dd line kpi's data into so_line_kpi table -------------------------  set tez.job.name=load dd line kpis:so_line_kpi :load target from delivery_master ;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_line_kpi;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-ufposo-hive-stg1-so_line_kpi_final -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_line_kpi  ---source: tms_stage0 table : so_line_kpi_work and so_line_kpi_work1 ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 04may20 scctp4-2922 ssoma initial version ---------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------  set mapreduce.job.reduces=200;]]</Comment>
<Comment>![CDATA[------------------------- ---loading po line kpi's data into dd_line_kpi table -------------------------  set tez.job.name=load po line kpis:so_line_kpi:load target from po_master ;]]</Comment>
<Print>![CDATA[started loading scct_work_db.so_line_kpi_work1 for all the modules;]]</Print>
<Print>![CDATA[started loading scct_work_db.so_line_kpi_work for all the modules;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-ufposo-hive-stg1-so_line_kpi_vss_to_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.so_line_kpi  ---source: tms_stage0 table : delivery_master, handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 07jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  --------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------    set hive.auto.convert.join.noconditionaltask.size=200000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading dd line kpi's data into so_line_kpi table -------------------------  set tez.job.name=load dd line kpis:so_line_kpi :load target from delivery_master ;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_line_kpi;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-masterdata-hive-stg1-scct_db.so_master -------------------------------------------------------------------------- ---target: stage1 table: so_master ---source: scct_raw_db.maprdb_vbak_raw, scct_raw_db.vbpa_raw, scct_raw_db.maprdb_vbap_raw ---load type: delta ---back posting: no -------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23may19 ssoma initial version -- 01.00.00.02 23sep19 scctp4-2471 ryadav mapr remediation changes for column names, item and location length -- 01.00.00.03 26sep19 scctp4-2481 ryadav added lpad in location join -- 01.00.00.04 04nov19 scctp4-2638 ssoma added cust_prch_itm_nbr(posex) column into so_master -- 01.00.00.05 03jun20 scctp4-1777 ashettap added chngind column into so_master -- 01.00.00.06 03jul20 scctp5-217 ashettap added 9 columns from sls_distr_doc_nbr through overall_sls_ord_blk_stat to so_master  ------------------------- ---job related hive settings to read huge dataset and merge files for target table -------------------------  set hive.auto.convert.join.noconditionaltask.size=3000000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading so_master stage 1 base table -------------------------  set tez.job.name=stage1:load_so_master:load_so_master;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_master;]]</Print>
<Print>![CDATA[completed loading into scct_db.so_master;]]</Print>
<Comment>![CDATA[------------------------- ---cocatenate files for target table so_master -------------------------  set tez.job.name=stage1:so_master:cocatenate files on so_master;]]</Comment>
<Print>![CDATA[started cocatenate files;]]</Print>
<Comment>![CDATA[alter table scct_db.so_master concatenate;]]</Comment>
<Print>![CDATA[completed cocatenate files;]]</Print>
<Comment>![CDATA[---jobname:scct-ikb-hive-stg2-scct_db.spc_plng_day_item_location_presentation_qty --------------------------------------------------------------------------- ---target: stage1 table: scct_db.spc_plng_day_item_location_presentation_qty  ---source: scct_work_db table : spc_presentation_temp2 ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 20nov18 ryadav initial version -- 01.00.00.02 23sep19 scctp4-2471 ryadav mapr remediation changes for column names, item and location length  ------------------------- ---loading spc_plng_day_item_location_presentation_qty stage 1 base data -------------------------  set tez.job.name=stage1:spc_plng_day_item_location_presentation_qty :load target table spc_plng_day_item_location_presentation_qty ;]]</Comment>
<Print>![CDATA[started loading into scct_db.spc_plng_day_item_location_presentation_qty ;]]</Print>
<Print>![CDATA[completed loading into scct_db.spc_plng_day_item_location_presentation_qty ;]]</Print>
<Comment>![CDATA[---jobname:scct-ikb-hive-stg1-scct_db.spc_plng_item_location_date_assortment_plan --------------------------------------------------------------------------- ---target: stage1 table: scct_db.spc_plng_item_location_date_assortment_plan ---source: pkms_stage0 table : ltsmstr_lbi_reporting ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 20nov18 ssoma initial version -- 01.00.00.02 23sep19 scctp4-2471 ryadav mapr remediation changes for column names, item and location length   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;]]</Comment>
</Step>
</SnowBlock>
<SnowBlock id="5">
<Step id="spc_plng_day_item_location_presentation_qty_5">
<Sql>![CDATA[------------------------- ---loading stage1 table spc_plng_item_location_date_assortment_plan from source table ltsmstr_lbi_reporting -------------------------  insert overwrite table scct_db.spc_plng_item_location_date_assortment_plan partition(snapshot_dt) select distinct coalesce((case when trim(productid)='' then null else lpad(trim(productid),18,0) end),'n/a') as itm_nbr ,coalesce((case when trim(storenumber)='' then null else coalesce(l.location_number,storenumber) end),'n/a') as loc_nbr ,coalesce((case when trim(mpq)='' then null else trim(mpq ) end),0.00) as minimum_presentation_qty ,coalesce((case when trim(startdate)='' then null else from_unixtime(unix_timestamp(startdate,'yyyymmdd'),'yyyy-mm-dd') end), '9999-12-31') as effective_dt ,coalesce((case when trim(enddate)='' then null else from_unixtime(unix_timestamp(enddate,'yyyymmdd'),'yyyy-mm-dd') end), '9999-12-31') as discontinue_dt ,coalesce((case when trim(poglocation)='' then null else trim(poglocation) end),'n/a') as pog_location ,coalesce((case when trim(pogkey)='' then null else trim(pogkey) end),'n/a') as pog_key ,coalesce((case when trim(pogname)='' then null else trim(pogname) end),'n/a') as pog_name ,date_sub(current_date,1) as snapshot_dt from ikb_stage0.ltsmstr_lbi_reporting llr left outer join (select location_number from analytics_db.location where location_type_code = '04')l  on lpad(llr.storenumber,10,0) = l.location_number distribute by snapshot_dt;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Print>![CDATA[completed loading into scct_db.scem_expected_events;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="6">
<Step id="spc_plng_day_item_location_presentation_qty_6">
<Sql>![CDATA[---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_events -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_events  ---source: sap_stage0 table : scem_tracking_events_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_events ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti changed patition key to eh_created_date and added logic to ignore records where di_operation_type &lt;&gt; 'd' -- 01.00.00.03 29nov19 scctp4-2623 akoti removed partition column &amp; settings, changed di_operation_type logic --  ------------------------- ---job related hive settings to merge files for target table ------------------------- set hive.merge.orcfile.stripe.level=false;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading scem_tracking_events target table data -------------------------  set tez.job.name=stage2:scem_tracking_events :load target table scem_tracking_events ;]]</Comment>
<Print>![CDATA[started loading into scct_db.scem_tracking_events ;]]</Print>
<Print>![CDATA[completed loading into scct_db.scem_tracking_events ;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="7">
<Step id="spc_plng_day_item_location_presentation_qty_7">
<Sql>![CDATA[---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_objects -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_objects  ---source: scct_work_db table : scem_tracking_objects_tmp ---description: this script will load the delta data to target table scct_db.scem_tracking_objects ---load type: full ---back posting: no ---author: sdhal ---created date: 29/07/2019 -------------------------------------------------------------------------- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 29jul19 sdhal initial version -- 01.00.00.02 06sep19 scctp4-2187 akoti added logic to ignore records where di_operation_type &lt;&gt; 'd' -- 01.00.00.03 19sep19 scctp4-2460 ryadav increased tez container size -- 01.00.00.04 29nov19 scctp4-2623 akoti removed partition column &amp; settings, changed di_operation_type logic -- 01.00.00.05 21jan20 scctp4-2988 akoti changed column name from act_po_gr_date to act_gac_date --  ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading scem_tracking_objects target table data -------------------------  set tez.job.name=stage2:scem_tracking_objects :load target table scem_tracking_objects ;]]</Comment>
<Print>![CDATA[started loading into scct_db.scem_tracking_objects ;]]</Print>
<Print>![CDATA[completed loading into scct_db.scem_tracking_objects ;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="8">
<Step id="spc_plng_day_item_location_presentation_qty_8">
<Sql>![CDATA[---jobname:scct-scem-hive-stg1-scct_db.scem_tracking_types -------------------------------------------------------------------------- ---target: stage1 table: scct_db.scem_tracking_types  ---source: scct_work_db table : scem_tracking_types_temp, scct_db table : scem_tracking_types ---load type: full ---back posting: no ---author: ryadav ---created date: 03/14/2019 --------------------------------------------------------------------------   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading scem_tracking_types target table data -------------------------  set tez.job.name=stage1:scem_tracking_types :load target table scem_tracking_types ;]]</Comment>
<Print>![CDATA[started loading into scct_db.scem_tracking_types ;]]</Print>
<Print>![CDATA[completed loading into scct_db.scem_tracking_types ;]]</Print>
<Comment>![CDATA[---jobname:scct-ufposo-hive-stg1-so_line_kpi_dcb_to_dcm_aprl -------------------------------------------------------------------------- ---target: stage1 table: scct_db.so_line_kpi  ---source: tms_stage0 table : delivery_master, handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 07jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------   set hive.auto.convert.join.noconditionaltask.size=200000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading dd line kpi's data into so_line_kpi table -------------------------  set tez.job.name=load dd line kpis:so_line_kpi :load target from delivery_master ;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_line_kpi;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-usposo-hive-stg1-so_line_kpi_dcoutboundso -------------------------------------------------------------------------- ---target: stage1 table: scct_db.so_line_kpi  ---source: tms_stage0 table : delivery_master, handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 07jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------   set hive.auto.convert.join.noconditionaltask.size=200000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading dd line kpi's data into so_line_kpi table -------------------------  set tez.job.name=load dd line kpis:so_line_kpi :load target from delivery_master ;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_line_kpi;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-ufposo-hive-stg1-so_line_kpi_final -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_line_kpi  ---source: tms_stage0 table : so_line_kpi_work and so_line_kpi_work1 ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 04may20 scctp4-2922 ssoma initial version ---------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------  set mapreduce.job.reduces=200;]]</Comment>
<Comment>![CDATA[------------------------- ---loading po line kpi's data into dd_line_kpi table -------------------------  set tez.job.name=load po line kpis:so_line_kpi:load target from po_master ;]]</Comment>
<Print>![CDATA[started loading scct_work_db.so_line_kpi_work1 for all the modules;]]</Print>
<Print>![CDATA[started loading scct_work_db.so_line_kpi_work for all the modules;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-ufposo-hive-stg1-so_line_kpi_vss_to_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.so_line_kpi  ---source: tms_stage0 table : delivery_master, handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 07jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  --------------------------------------------------------------------------  ------------------------- ---job related hive settings  -------------------------    set hive.auto.convert.join.noconditionaltask.size=200000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading dd line kpi's data into so_line_kpi table -------------------------  set tez.job.name=load dd line kpis:so_line_kpi :load target from delivery_master ;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_line_kpi;]]</Print>
<Print>![CDATA[completed so_line_kpi data load;]]</Print>
<Comment>![CDATA[---jobname:scct-masterdata-hive-stg1-scct_db.so_master -------------------------------------------------------------------------- ---target: stage1 table: so_master ---source: scct_raw_db.maprdb_vbak_raw, scct_raw_db.vbpa_raw, scct_raw_db.maprdb_vbap_raw ---load type: delta ---back posting: no -------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 23may19 ssoma initial version -- 01.00.00.02 23sep19 scctp4-2471 ryadav mapr remediation changes for column names, item and location length -- 01.00.00.03 26sep19 scctp4-2481 ryadav added lpad in location join -- 01.00.00.04 04nov19 scctp4-2638 ssoma added cust_prch_itm_nbr(posex) column into so_master -- 01.00.00.05 03jun20 scctp4-1777 ashettap added chngind column into so_master -- 01.00.00.06 03jul20 scctp5-217 ashettap added 9 columns from sls_distr_doc_nbr through overall_sls_ord_blk_stat to so_master  ------------------------- ---job related hive settings to read huge dataset and merge files for target table -------------------------  set hive.auto.convert.join.noconditionaltask.size=3000000000;]]</Comment>
<Comment>![CDATA[------------------------- ---loading so_master stage 1 base table -------------------------  set tez.job.name=stage1:load_so_master:load_so_master;]]</Comment>
<Print>![CDATA[started loading into scct_db.so_master;]]</Print>
<Print>![CDATA[completed loading into scct_db.so_master;]]</Print>
<Comment>![CDATA[------------------------- ---cocatenate files for target table so_master -------------------------  set tez.job.name=stage1:so_master:cocatenate files on so_master;]]</Comment>
<Print>![CDATA[started cocatenate files;]]</Print>
<Comment>![CDATA[alter table scct_db.so_master concatenate;]]</Comment>
<Print>![CDATA[completed cocatenate files;]]</Print>
<Comment>![CDATA[---jobname:scct-ikb-hive-stg2-scct_db.spc_plng_day_item_location_presentation_qty --------------------------------------------------------------------------- ---target: stage1 table: scct_db.spc_plng_day_item_location_presentation_qty  ---source: scct_work_db table : spc_presentation_temp2 ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 20nov18 ryadav initial version -- 01.00.00.02 23sep19 scctp4-2471 ryadav mapr remediation changes for column names, item and location length  ------------------------- ---loading spc_plng_day_item_location_presentation_qty stage 1 base data -------------------------  set tez.job.name=stage1:spc_plng_day_item_location_presentation_qty :load target table spc_plng_day_item_location_presentation_qty ;]]</Comment>
<Print>![CDATA[started loading into scct_db.spc_plng_day_item_location_presentation_qty ;]]</Print>
<Print>![CDATA[completed loading into scct_db.spc_plng_day_item_location_presentation_qty ;]]</Print>
<Comment>![CDATA[---jobname:scct-ikb-hive-stg1-scct_db.spc_plng_item_location_date_assortment_plan --------------------------------------------------------------------------- ---target: stage1 table: scct_db.spc_plng_item_location_date_assortment_plan ---source: pkms_stage0 table : ltsmstr_lbi_reporting ---load type: full ---back posting: no --------------------------------------------------------------------------  -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ ---------------------------- -- 01.00.00.01 20nov18 ssoma initial version -- 01.00.00.02 23sep19 scctp4-2471 ryadav mapr remediation changes for column names, item and location length   ------------------------- ---job related hive settings to merge files for target table -------------------------  set hive.merge.orcfile.stripe.level=false;]]</Comment>
</Step>
</SnowBlock>
<SnowBlock id="9">
<Step id="spc_plng_day_item_location_presentation_qty_9">
<Sql>![CDATA[------------------------- ---loading stage1 table spc_plng_item_location_date_assortment_plan from source table ltsmstr_lbi_reporting -------------------------  insert overwrite table scct_db.spc_plng_item_location_date_assortment_plan partition(snapshot_dt) select distinct coalesce((case when trim(productid)='' then null else lpad(trim(productid),18,0) end),'n/a') as itm_nbr ,coalesce((case when trim(storenumber)='' then null else coalesce(l.location_number,storenumber) end),'n/a') as loc_nbr ,coalesce((case when trim(mpq)='' then null else trim(mpq ) end),0.00) as minimum_presentation_qty ,coalesce((case when trim(startdate)='' then null else from_unixtime(unix_timestamp(startdate,'yyyymmdd'),'yyyy-mm-dd') end), '9999-12-31') as effective_dt ,coalesce((case when trim(enddate)='' then null else from_unixtime(unix_timestamp(enddate,'yyyymmdd'),'yyyy-mm-dd') end), '9999-12-31') as discontinue_dt ,coalesce((case when trim(poglocation)='' then null else trim(poglocation) end),'n/a') as pog_location ,coalesce((case when trim(pogkey)='' then null else trim(pogkey) end),'n/a') as pog_key ,coalesce((case when trim(pogname)='' then null else trim(pogname) end),'n/a') as pog_name ,date_sub(current_date,1) as snapshot_dt from ikb_stage0.ltsmstr_lbi_reporting llr left outer join (select location_number from analytics_db.location where location_type_code = '04')l  on lpad(llr.storenumber,10,0) = l.location_number distribute by snapshot_dt;]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
</Step>
<Step id="spc_plng_day_item_location_presentation_qty_10">
<Comment>![CDATA[end script]]</Comment>
</Step>
</SnowBlock>
</SnowBlocks>
