<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<SnowBlocks>
<SnowBlock id="1">
<Step id="-----------------------_1">
<Comment>![CDATA[------------------------- ---loading staging data into final stagnig table -------------------------  set tez.job.name=staging:tms_fuel_master_tmp1 :load target table from tms_fuel_master_tmp;]]</Comment>
<Print>![CDATA[started loading into scct_work_db.tms_fuel_master_tmp1;]]</Print>
<Sql>![CDATA[INSERT
  OVERWRITE INTO SCCT_WORK_DB.TMS_FUEL_MASTER_TMP1 (
    SELECT
      COALESCE(TMP.COMPANY_ID, T.COMPANY_ID),
      COALESCE(TMP.INDEX_ID, T.INDEX_ID),
      COALESCE(TMP.NAME, T.NAME),
      COALESCE(
        TMP.FUEL_INDEX_DESCRIPTION,
        T.FUEL_INDEX_DESCRIPTION
      ),
      COALESCE(TMP.FUEL_TYPE_ID, T.FUEL_TYPE_ID),
      COALESCE(TMP.COUNTRY_CD, T.COUNTRY_CD),
      COALESCE(TMP.INDEX_CREATED_DTTM, T.INDEX_CREATED_DTTM),
      COALESCE(TMP.INDEX_UPDATED_DTTM, T.INDEX_UPDATED_DTTM),
      COALESCE(TMP.RATE_ID, T.RATE_ID),
      COALESCE(TMP.RATE, T.RATE),
      COALESCE(
        TMP.FUEL_RATE_CURRENCY_CD,
        T.FUEL_RATE_CURRENCY_CD
      ),
      COALESCE(TMP.EFFECTIVE_DT, T.EFFECTIVE_DT),
      COALESCE(TMP.EXPIRATION_DT, T.EXPIRATION_DT),
      COALESCE(TMP.RATE_CREATED_DTTM, T.RATE_CREATED_DTTM),
      COALESCE(TMP.RATE_UPDATED_DTTM, T.RATE_UPDATED_DTTM),
      COALESCE(
        TMP.RATE_UOM_ABBREVIATION,
        T.RATE_UOM_ABBREVIATION
      ),
      COALESCE(TMP.RATE_UOM_DESCRIPTION, T.RATE_UOM_DESCRIPTION),
      COALESCE(TMP.FUEL_SURCHARGE_ID, T.FUEL_SURCHARGE_ID),
      COALESCE(TMP.LOWER_PRICE_LIMIT, T.LOWER_PRICE_LIMIT),
      COALESCE(TMP.UPPER_PRICE_LIMIT, T.UPPER_PRICE_LIMIT),
      COALESCE(TMP.SURCHARGE_AMOUNT, T.SURCHARGE_AMOUNT),
      COALESCE(
        TMP.FUEL_SURCHARGE_CURRENCY_CD,
        T.FUEL_SURCHARGE_CURRENCY_CD
      ),
      COALESCE(
        TMP.FUEL_SURCHARGE_ACCESSORIAL_ID,
        T.FUEL_SURCHARGE_ACCESSORIAL_ID
      ),
      COALESCE(TMP.SURCHARGE_PERCENT, T.SURCHARGE_PERCENT),
      COALESCE(
        TMP.SURCHARGE_CREATED_DTTM,
        T.SURCHARGE_CREATED_DTTM
      ),
      COALESCE(
        TMP.SURCHARGE_LAST_UPDATED_DTTM,
        T.SURCHARGE_LAST_UPDATED_DTTM
      ),
      COALESCE(TMP.ACCESSORIAL_CD, T.ACCESSORIAL_CD),
      COALESCE(TMP.ACCESSORIAL_TYPE, T.ACCESSORIAL_TYPE),
      COALESCE(TMP.DISTANCE_UOM, T.DISTANCE_UOM),
      COALESCE(
        TMP.ACCESSORIAL_CODE_DESCRIPTION,
        T.ACCESSORIAL_CODE_DESCRIPTION
      ),
      COALESCE(
        TMP.ACCESSORIAL_LAST_UPDATED_DTTM,
        T.ACCESSORIAL_LAST_UPDATED_DTTM
      ),
      COALESCE(TMP.IS_HAZMAT, T.IS_HAZMAT),
      COALESCE(
        TMP.IS_DEFAULT_FOR_INVOICE,
        T.IS_DEFAULT_FOR_INVOICE
      ),
      COALESCE(TMP.IS_FUEL_ACCESSORIAL, T.IS_FUEL_ACCESSORIAL),
      COALESCE(TMP.IS_TAX_ACCESSORIAL, T.IS_TAX_ACCESSORIAL),
      COALESCE(
        TMP.IS_ADD_TO_SPOT_CHARGE,
        T.IS_ADD_TO_SPOT_CHARGE
      ),
      COALESCE(TMP.FUEL_REGION, T.FUEL_REGION)
    FROM
      SCCT_DB.TMS_FUEL_MASTER AS TFULL
      JOIN SCCT_WORK_DB.TMS_FUEL_MASTER_TMP AS TMP ON T.INDEX_ID = TMP.INDEX_ID
      AND T.LOWER_PRICE_LIMIT = TMP.LOWER_PRICE_LIMIT
      AND T.UPPER_PRICE_LIMIT = TMP.UPPER_PRICE_LIMIT
      AND T.EFFECTIVE_DT = TMP.EFFECTIVE_DT
      AND T.EXPIRATION_DT = TMP.EXPIRATION_DT
      AND T.FUEL_SURCHARGE_ID = TMP.FUEL_SURCHARGE_ID
  );]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading staging data into final stagnig table -------------------------  set tez.job.name=staging:tms_fuel_master_tmp1 :load target table from tms_fuel_master_tmp;]]</Comment>
<Print>![CDATA[started loading into scct_work_db.tms_fuel_master_tmp1;]]</Print>
<Comment>![CDATA[------------------------- ---loading staging data into target table -------------------------  set tez.job.name=staging:tms_fuel_master :load target table from tms_fuel_master_tmp1;]]</Comment>
<Print>![CDATA[started loading into scct_db.tms_fuel_master;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="2">
<Step id="-----------------------_2">
<Sql>![CDATA[INSERT
  OVERWRITE INTO SCCT_DB.TMS_FUEL_MASTER (
    SELECT
      COMPANY_ID,
      INDEX_ID,
      NAME,
      FUEL_INDEX_DESCRIPTION,
      FUEL_TYPE_ID,
      COUNTRY_CD,
      INDEX_CREATED_DTTM,
      INDEX_UPDATED_DTTM,
      RATE_ID,
      RATE,
      FUEL_RATE_CURRENCY_CD,
      EFFECTIVE_DT,
      EXPIRATION_DT,
      RATE_CREATED_DTTM,
      RATE_UPDATED_DTTM,
      RATE_UOM_ABBREVIATION,
      RATE_UOM_DESCRIPTION,
      FUEL_SURCHARGE_ID,
      LOWER_PRICE_LIMIT,
      UPPER_PRICE_LIMIT,
      SURCHARGE_AMOUNT,
      FUEL_SURCHARGE_CURRENCY_CD,
      FUEL_SURCHARGE_ACCESSORIAL_ID,
      SURCHARGE_PERCENT,
      SURCHARGE_CREATED_DTTM,
      SURCHARGE_LAST_UPDATED_DTTM,
      ACCESSORIAL_CD,
      ACCESSORIAL_TYPE,
      DISTANCE_UOM,
      ACCESSORIAL_CODE_DESCRIPTION,
      ACCESSORIAL_LAST_UPDATED_DTTM,
      IS_HAZMAT,
      IS_DEFAULT_FOR_INVOICE,
      IS_FUEL_ACCESSORIAL,
      IS_TAX_ACCESSORIAL,
      IS_ADD_TO_SPOT_CHARGE,
      FUEL_REGIONFROM SCCT_WORK_DB.TMS_FUEL_MASTER_TMP1
  );]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading staging data into final stagnig table -------------------------  set tez.job.name=staging:tms_fuel_master_tmp1 :load target table from tms_fuel_master_tmp;]]</Comment>
<Print>![CDATA[started loading into scct_work_db.tms_fuel_master_tmp1;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="3">
<Step id="-----------------------_3">
<Sql>![CDATA[INSERT
  OVERWRITE INTO SCCT_WORK_DB.TMS_FUEL_MASTER_TMP1 (
    SELECT
      COALESCE(TMP.COMPANY_ID, T.COMPANY_ID),
      COALESCE(TMP.INDEX_ID, T.INDEX_ID),
      COALESCE(TMP.NAME, T.NAME),
      COALESCE(
        TMP.FUEL_INDEX_DESCRIPTION,
        T.FUEL_INDEX_DESCRIPTION
      ),
      COALESCE(TMP.FUEL_TYPE_ID, T.FUEL_TYPE_ID),
      COALESCE(TMP.COUNTRY_CD, T.COUNTRY_CD),
      COALESCE(TMP.INDEX_CREATED_DTTM, T.INDEX_CREATED_DTTM),
      COALESCE(TMP.INDEX_UPDATED_DTTM, T.INDEX_UPDATED_DTTM),
      COALESCE(TMP.RATE_ID, T.RATE_ID),
      COALESCE(TMP.RATE, T.RATE),
      COALESCE(
        TMP.FUEL_RATE_CURRENCY_CD,
        T.FUEL_RATE_CURRENCY_CD
      ),
      COALESCE(TMP.EFFECTIVE_DT, T.EFFECTIVE_DT),
      COALESCE(TMP.EXPIRATION_DT, T.EXPIRATION_DT),
      COALESCE(TMP.RATE_CREATED_DTTM, T.RATE_CREATED_DTTM),
      COALESCE(TMP.RATE_UPDATED_DTTM, T.RATE_UPDATED_DTTM),
      COALESCE(
        TMP.RATE_UOM_ABBREVIATION,
        T.RATE_UOM_ABBREVIATION
      ),
      COALESCE(TMP.RATE_UOM_DESCRIPTION, T.RATE_UOM_DESCRIPTION),
      COALESCE(TMP.FUEL_SURCHARGE_ID, T.FUEL_SURCHARGE_ID),
      COALESCE(TMP.LOWER_PRICE_LIMIT, T.LOWER_PRICE_LIMIT),
      COALESCE(TMP.UPPER_PRICE_LIMIT, T.UPPER_PRICE_LIMIT),
      COALESCE(TMP.SURCHARGE_AMOUNT, T.SURCHARGE_AMOUNT),
      COALESCE(
        TMP.FUEL_SURCHARGE_CURRENCY_CD,
        T.FUEL_SURCHARGE_CURRENCY_CD
      ),
      COALESCE(
        TMP.FUEL_SURCHARGE_ACCESSORIAL_ID,
        T.FUEL_SURCHARGE_ACCESSORIAL_ID
      ),
      COALESCE(TMP.SURCHARGE_PERCENT, T.SURCHARGE_PERCENT),
      COALESCE(
        TMP.SURCHARGE_CREATED_DTTM,
        T.SURCHARGE_CREATED_DTTM
      ),
      COALESCE(
        TMP.SURCHARGE_LAST_UPDATED_DTTM,
        T.SURCHARGE_LAST_UPDATED_DTTM
      ),
      COALESCE(TMP.ACCESSORIAL_CD, T.ACCESSORIAL_CD),
      COALESCE(TMP.ACCESSORIAL_TYPE, T.ACCESSORIAL_TYPE),
      COALESCE(TMP.DISTANCE_UOM, T.DISTANCE_UOM),
      COALESCE(
        TMP.ACCESSORIAL_CODE_DESCRIPTION,
        T.ACCESSORIAL_CODE_DESCRIPTION
      ),
      COALESCE(
        TMP.ACCESSORIAL_LAST_UPDATED_DTTM,
        T.ACCESSORIAL_LAST_UPDATED_DTTM
      ),
      COALESCE(TMP.IS_HAZMAT, T.IS_HAZMAT),
      COALESCE(
        TMP.IS_DEFAULT_FOR_INVOICE,
        T.IS_DEFAULT_FOR_INVOICE
      ),
      COALESCE(TMP.IS_FUEL_ACCESSORIAL, T.IS_FUEL_ACCESSORIAL),
      COALESCE(TMP.IS_TAX_ACCESSORIAL, T.IS_TAX_ACCESSORIAL),
      COALESCE(
        TMP.IS_ADD_TO_SPOT_CHARGE,
        T.IS_ADD_TO_SPOT_CHARGE
      ),
      COALESCE(TMP.FUEL_REGION, T.FUEL_REGION)
    FROM
      SCCT_DB.TMS_FUEL_MASTER AS TFULL
      JOIN SCCT_WORK_DB.TMS_FUEL_MASTER_TMP AS TMP ON T.INDEX_ID = TMP.INDEX_ID
      AND T.LOWER_PRICE_LIMIT = TMP.LOWER_PRICE_LIMIT
      AND T.UPPER_PRICE_LIMIT = TMP.UPPER_PRICE_LIMIT
      AND T.EFFECTIVE_DT = TMP.EFFECTIVE_DT
      AND T.EXPIRATION_DT = TMP.EXPIRATION_DT
      AND T.FUEL_SURCHARGE_ID = TMP.FUEL_SURCHARGE_ID
  );]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
<Comment>![CDATA[------------------------- ---loading staging data into final stagnig table -------------------------  set tez.job.name=staging:tms_fuel_master_tmp1 :load target table from tms_fuel_master_tmp;]]</Comment>
<Print>![CDATA[started loading into scct_work_db.tms_fuel_master_tmp1;]]</Print>
<Comment>![CDATA[------------------------- ---loading staging data into target table -------------------------  set tez.job.name=staging:tms_fuel_master :load target table from tms_fuel_master_tmp1;]]</Comment>
<Print>![CDATA[started loading into scct_db.tms_fuel_master;]]</Print>
</Step>
</SnowBlock>
<SnowBlock id="4">
<Step id="-----------------------_4">
<Sql>![CDATA[INSERT
  OVERWRITE INTO SCCT_DB.TMS_FUEL_MASTER (
    SELECT
      COMPANY_ID,
      INDEX_ID,
      NAME,
      FUEL_INDEX_DESCRIPTION,
      FUEL_TYPE_ID,
      COUNTRY_CD,
      INDEX_CREATED_DTTM,
      INDEX_UPDATED_DTTM,
      RATE_ID,
      RATE,
      FUEL_RATE_CURRENCY_CD,
      EFFECTIVE_DT,
      EXPIRATION_DT,
      RATE_CREATED_DTTM,
      RATE_UPDATED_DTTM,
      RATE_UOM_ABBREVIATION,
      RATE_UOM_DESCRIPTION,
      FUEL_SURCHARGE_ID,
      LOWER_PRICE_LIMIT,
      UPPER_PRICE_LIMIT,
      SURCHARGE_AMOUNT,
      FUEL_SURCHARGE_CURRENCY_CD,
      FUEL_SURCHARGE_ACCESSORIAL_ID,
      SURCHARGE_PERCENT,
      SURCHARGE_CREATED_DTTM,
      SURCHARGE_LAST_UPDATED_DTTM,
      ACCESSORIAL_CD,
      ACCESSORIAL_TYPE,
      DISTANCE_UOM,
      ACCESSORIAL_CODE_DESCRIPTION,
      ACCESSORIAL_LAST_UPDATED_DTTM,
      IS_HAZMAT,
      IS_DEFAULT_FOR_INVOICE,
      IS_FUEL_ACCESSORIAL,
      IS_TAX_ACCESSORIAL,
      IS_ADD_TO_SPOT_CHARGE,
      FUEL_REGIONFROM SCCT_WORK_DB.TMS_FUEL_MASTER_TMP1
  );]]</Sql>
<Condition if="ERRORCODE != 0 action=exit value=ERRORCODE"/>
</Step>
<Step id="-----------------------_5">
<Comment>![CDATA[end script]]</Comment>
</Step>
</SnowBlock>
</SnowBlocks>
