---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_zdtd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug20 scctp5-327 fyuan zdtd initial version ---------------------------------------------------------------------------- ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_po -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add component filter  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_podd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 20aug20 scctp5-327 fyuan add zdtd  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_posodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_sodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-e2e_dashboard-hive-stg1-scct_db.prepack_component -------------------------------------------------------------------------- ---target: stage1 table: scct_db.prepack_component  ---source: scct_db table : bom_item, bom_detail, analytics_view table : item ---load type: full ---back posting: no ---author: ryadav ---last modified date: 12/18/2018 --------------------------------------------------------------------------  ------------------------- ---loading prepack_component stage 1 base data -------------------------  ! echo started loading into scct_db.prepack_component ;
! echo completed loading into scct_db.prepack_component ;
---jobname:scct-e2e_outbound_visibility-hive-stg1-scct_db.purge_wms_outbound_e2e -------------------------------------------------------------------------- ---target: stage1 table: scct_db.wms_outbound_e2e ---source: scct_db table : scct_db.wms_outbound_e2e and operations_db.purge_tables  ---load type: incrimental ---back posting: no ---author: ssoma ---created date: 12/02/2019 --------------------------------------------------------------------------  ------------------------- ---loading worker table without str rows  -------------------------   insert overwrite table scct_work_db.wms_retail_warehouse_shipping_link_work select rs.retail_warehouse ,rs.retail_distro_nbr ,rs.retail_store_nbr ,rs.retail_season_nbr ,rs.retail_season_year_nbr ,rs.retail_style_nbr ,rs.retail_style_sfx_nbr ,rs.retail_sector ,rs.retail_sap_style ,rs.retail_sap_choice ,rs.retail_sap_size ,rs.retail_ticket_typ ,rs.retail_instore_dt ,rs.retail_distro_total_qty ,rs.retail_distro_allocated_qty ,rs.retail_distro_remaining_qty ,rs.retail_dtstor_status_flag ,rs.retail_record_expansion_fld ,rs.retail_delv_doc_nbr ,rs.retail_delv_doc_itm_nbr ,rs.retail_distro_last_modified_datetime ,rs.retail_distro_create_datetime ,rs.retail_pickticket_control_nbr ,rs.retail_pdpick_pkt_line_nbr ,rs.retail_pdpick_pick_wave_nbr ,rs.retail_wave_processing_typ ,rs.retail_inv_allocation_typ ,rs.retail_pick_determination_typ ,rs.retail_pick_loc_assignment_typ ,rs.retail_pickticket_pick_location ,rs.retail_original_pick_order_qty ,rs.retail_original_pick_qty ,rs.retail_pick_qty ,rs.retail_pick_shortage_qty ,rs.retail_pick_cancelled_qty ,rs.retail_pick_packed_qty ,rs.retail_pdpick_status_flg ,rs.retail_specl_instr_cd_1 ,rs.retail_pickticket_last_modified_datetime ,rs.retail_pdpick_user_id ,rs.retail_district ,rs.retail_shipto_name ,rs.retail_shipto_state ,rs.retail_shipto_zip ,rs.retail_shipto_country ,rs.retail_pickticket_header_created_datetime ,rs.retail_pickticket_header_last_modified_datetime ,rs.retail_phpick_user_id ,rs.retail_carton_nbr ,rs.retail_carton_line_nbr ,rs.retail_package_barcd ,rs.retail_cdcart_pkt_line_nbr ,rs.retail_cdcart_pick_wave_nbr ,rs.retail_carton_qty_to_be_packed ,rs.retail_carton_qty_packed ,rs.retail_carton_delivered_qty ,rs.retail_carton_cancelled_qty ,rs.retail_carton_pick_location ,rs.retail_cdcart_status_flag ,rs.retail_packer_id ,rs.retail_carton_line_create_datetime ,rs.retail_carton_line_last_modified_datetime ,rs.retail_cdcart_user_id ,rs.retail_misc_nbr_1 ,rs.retail_chcart_pick_wave_nbr ,rs.retail_chcart_status_flg ,rs.retail_pack_cd ,rs.retail_pack_typ ,rs.retail_single_sku_flg ,rs.retail_first_pick_location ,rs.retail_carton_typ ,rs.retail_carton_sz ,rs.retail_carton_volume ,rs.retail_estimated_weight ,rs.retail_actual_weight ,rs.retail_pallet_id ,rs.retail_product_value ,rs.retail_bill_of_lading ,rs.retail_shipment_nbr ,rs.retail_load_nbr ,rs.retail_path_nbr ,rs.retail_ship_via ,rs.retail_special_ins_cd_1 ,rs.retail_special_ins_cd_2 ,rs.retail_special_ins_cd_3 ,rs.retail_misc_10_byte_1 ,rs.retail_misc_20_byte_1 ,rs.retail_misc_20_byte_2 ,rs.retail_misc_20_byte_4 ,rs.retail_misc_20_byte_5 ,rs.retail_reference_case_nbr ,rs.retail_carton_nbr_x_of_y ,rs.retail_audit_status ,rs.retail_tms_parcel_nbr ,rs.retail_carton_length ,rs.retail_carton_width ,rs.retail_carton_height ,rs.retail_recipient_first_name ,rs.retail_carton_last_modified_datetime ,rs.retail_chcart_user_id ,rs.retail_pickticket_create_datetime ,rs.retail_carton_create_datetime ,rs.retail_carton_invoiced_datetime ,rs.retail_distro_to_wave_time_duration ,rs.retail_wave_to_invoiced_duration ,rs.retail_distro_total_reaches ,rs.retail_distro_allocated_reaches ,rs.retail_distro_remaining_reaches ,rs.retail_original_pick_order_reaches ,rs.retail_original_pick_reaches ,rs.retail_pick_reaches ,rs.retail_pick_shortage_reaches ,rs.retail_pick_cancelled_reaches ,rs.retail_pick_packed_reaches ,rs.retail_carton_reaches_to_be_packed ,rs.retail_carton_reaches_packed ,rs.retail_carton_delivered_reaches ,rs.retail_carton_cancelled_reaches ,rs.retail_fc_ltfc ,rs.retail_processing_area ,rs.shipping_misc_20_byte_3 ,rs.shipping_carton_nbr ,rs.shipping_warehouse ,rs.shipping_load_nbr ,rs.shipping_destination_typ ,rs.shipping_ship_via ,rs.shipping_master_bill_of_lading ,rs.shipping_trailer_nbr ,rs.shipping_tractor_nbr ,rs.shipping_driver ,rs.shipping_dock ,rs.shipping_door ,rs.shipping_dock_door_locn_brcd ,rs.shipping_tms_plan_nbr ,rs.shipping_status_flg ,rs.shipping_status_dt ,rs.shipping_load_closed_dt ,rs.shipping_load_closed_ts ,rs.shipping_tc_shipment_id ,rs.shipping_tpe_created_load ,rs.shipping_tpe_processing_status ,rs.shipping_misc_instruction_1 ,rs.shipping_created_dt ,rs.shipping_created_ts ,rs.shipping_last_modified_dt ,rs.shipping_last_modified_ts ,rs.shipping_user_id ,rs.shipping_record_type ,rs.shipping_trip_nbr ,rs.shipping_trip_type ,rs.shipping_dispatch_dt ,rs.shipping_dispatch_ts ,rs.shipping_carton_limit ,rs.shipping_run_nbr ,rs.shipping_thtrip_ship_via ,rs.shipping_thtrip_status_flg ,rs.shipping_delay_code ,rs.shipping_cartons_loaded ,rs.shipping_seal_nbr ,rs.shipping_date_billed ,rs.shipping_time_billed ,rs.shipping_thtrip_seal_nbr ,rs.shipping_misc1_numeric_fld ,rs.shipping_miscellaneous_20 ,rs.shipping_thtrip_created_dt ,rs.shipping_thtrip_created_ts ,rs.shipping_thtrip_last_modified_dt ,rs.shipping_thtrip_last_modified_ts ,rs.shipping_thtrip_user_id ,rs.shipping_load_create_dt_ts ,rs.shipping_load_closed_dt_ts ,rs.shipping_load_create_to_closed_duration ,rs.distro_create_date ,rs.batch_code from scct_db.wms_outbound_e2e rs join (select purge_min_dt, purge_max_dt from operations_db.purge_tables p join  (select date_sub(min(to_date(distro_create_datetime)),1) purge_max_dt from scct_db.wms_outbound_retail) r on 1=1 where p.run_ind='n') pt on 1=1 where rs.distro_create_date between pt.purge_min_dt and pt.purge_max_dt and rs.retail_pickticket_control_nbr not like 'str%';
! echo worker table load is completed;
------------------------- ---insert back to base table only not str retail_pickticket_control_nbr rows -------------------------   insert overwrite table scct_db.wms_outbound_e2e partition(distro_create_date) select retail_warehouse ,retail_distro_nbr ,retail_store_nbr ,retail_season_nbr ,retail_season_year_nbr ,retail_style_nbr ,retail_style_sfx_nbr ,retail_sector ,retail_sap_style ,retail_sap_choice ,retail_sap_size ,retail_ticket_typ ,retail_instore_dt ,retail_distro_total_qty ,retail_distro_allocated_qty ,retail_distro_remaining_qty ,retail_dtstor_status_flag ,retail_record_expansion_fld ,retail_delv_doc_nbr ,retail_delv_doc_itm_nbr ,retail_distro_last_modified_datetime ,retail_distro_create_datetime ,retail_pickticket_control_nbr ,retail_pdpick_pkt_line_nbr ,retail_pdpick_pick_wave_nbr ,retail_wave_processing_typ ,retail_inv_allocation_typ ,retail_pick_determination_typ ,retail_pick_loc_assignment_typ ,retail_pickticket_pick_location ,retail_original_pick_order_qty ,retail_original_pick_qty ,retail_pick_qty ,retail_pick_shortage_qty ,retail_pick_cancelled_qty ,retail_pick_packed_qty ,retail_pdpick_status_flg ,retail_specl_instr_cd_1 ,retail_pickticket_last_modified_datetime ,retail_pdpick_user_id ,retail_district ,retail_shipto_name ,retail_shipto_state ,retail_shipto_zip ,retail_shipto_country ,retail_pickticket_header_created_datetime ,retail_pickticket_header_last_modified_datetime ,retail_phpick_user_id ,retail_carton_nbr ,retail_carton_line_nbr ,retail_package_barcd ,retail_cdcart_pkt_line_nbr ,retail_cdcart_pick_wave_nbr ,retail_carton_qty_to_be_packed ,retail_carton_qty_packed ,retail_carton_delivered_qty ,retail_carton_cancelled_qty ,retail_carton_pick_location ,retail_cdcart_status_flag ,retail_packer_id ,retail_carton_line_create_datetime ,retail_carton_line_last_modified_datetime ,retail_cdcart_user_id ,retail_misc_nbr_1 ,retail_chcart_pick_wave_nbr ,retail_chcart_status_flg ,retail_pack_cd ,retail_pack_typ ,retail_single_sku_flg ,retail_first_pick_location ,retail_carton_typ ,retail_carton_sz ,retail_carton_volume ,retail_estimated_weight ,retail_actual_weight ,retail_pallet_id ,retail_product_value ,retail_bill_of_lading ,retail_shipment_nbr ,retail_load_nbr ,retail_path_nbr ,retail_ship_via ,retail_special_ins_cd_1 ,retail_special_ins_cd_2 ,retail_special_ins_cd_3 ,retail_misc_10_byte_1 ,retail_misc_20_byte_1 ,retail_misc_20_byte_2 ,retail_misc_20_byte_4 ,retail_misc_20_byte_5 ,retail_reference_case_nbr ,retail_carton_nbr_x_of_y ,retail_audit_status ,retail_tms_parcel_nbr ,retail_carton_length ,retail_carton_width ,retail_carton_height ,retail_recipient_first_name ,retail_carton_last_modified_datetime ,retail_chcart_user_id ,retail_pickticket_create_datetime ,retail_carton_create_datetime ,retail_carton_invoiced_datetime ,retail_distro_to_wave_time_duration ,retail_wave_to_invoiced_duration ,retail_distro_total_reaches ,retail_distro_allocated_reaches ,retail_distro_remaining_reaches ,retail_original_pick_order_reaches ,retail_original_pick_reaches ,retail_pick_reaches ,retail_pick_shortage_reaches ,retail_pick_cancelled_reaches ,retail_pick_packed_reaches ,retail_carton_reaches_to_be_packed ,retail_carton_reaches_packed ,retail_carton_delivered_reaches ,retail_carton_cancelled_reaches ,retail_fc_ltfc ,retail_processing_area ,shipping_misc_20_byte_3 ,shipping_carton_nbr ,shipping_warehouse ,shipping_load_nbr ,shipping_destination_typ ,shipping_ship_via ,shipping_master_bill_of_lading ,shipping_trailer_nbr ,shipping_tractor_nbr ,shipping_driver ,shipping_dock ,shipping_door ,shipping_dock_door_locn_brcd ,shipping_tms_plan_nbr ,shipping_status_flg ,shipping_status_dt ,shipping_load_closed_dt ,shipping_load_closed_ts ,shipping_tc_shipment_id ,shipping_tpe_created_load ,shipping_tpe_processing_status ,shipping_misc_instruction_1 ,shipping_created_dt ,shipping_created_ts ,shipping_last_modified_dt ,shipping_last_modified_ts ,shipping_user_id ,shipping_record_type ,shipping_trip_nbr ,shipping_trip_type ,shipping_dispatch_dt ,shipping_dispatch_ts ,shipping_carton_limit ,shipping_run_nbr ,shipping_thtrip_ship_via ,shipping_thtrip_status_flg ,shipping_delay_code ,shipping_cartons_loaded ,shipping_seal_nbr ,shipping_date_billed ,shipping_time_billed ,shipping_thtrip_seal_nbr ,shipping_misc1_numeric_fld ,shipping_miscellaneous_20 ,shipping_thtrip_created_dt ,shipping_thtrip_created_ts ,shipping_thtrip_last_modified_dt ,shipping_thtrip_last_modified_ts ,shipping_thtrip_user_id ,shipping_load_create_dt_ts ,shipping_load_closed_dt_ts ,shipping_load_create_to_closed_duration ,batch_code ,distro_create_date from scct_work_db.wms_retail_warehouse_shipping_link_work;
! echo purge str rows completed;
------------------------- ---update record into control table to purge str rows -------------------------   ! echo started entry into job control table;
------------------------- ---insert record into control table to purge str rows -------------------------  ! echo started entry into job control table;
! echo entry into job control table completed;
---jobname:scct-rockport-hive-stg1-scct_db.rockport_air_shipment -------------------------------------------------------------------------- ---target: stage1 table: scct_db.rockport_air_shipment ---source: rockport_stage0 table : trader_shipping_hdr, trader_shipping_dtl, trader_party, trader_plci3225 --- trader_packing, trader_delivery_dtl and trader_matrix_hdr;
---load type: full ---back posting: no ---author: ssoma ---created date: 02/05/2019 --------------------------------------------------------------------------  ------------------------- ---loading work table scct_db.trader_plci3225_work  -------------------------   ! echo started loading into scct_work_db.trader_plci3225_work;
INSERT OVERWRITE INTO SCCT_WORK_DB.TRADER_PLCI3225_WORK
(SELECT OWNER, PLACE_CODE, PLACE_NAME
FROM (SELECT OWNER, PLACE_CODE, PLACE_NAME, ROW_NUMBER() OVER (PARTITION BY TRIM( OWNER), TRIM( PLACE_CODE) ORDER BY FROM_UNIXTIME(LAST_UPDATE / 1000, 'yyyy-mm-dd hh:mm:ss') DESC) AS ROW_NUM
FROM ROCKPORT_STAGE0.TRADER_PLCI3225) AS A
WHERE A.ROW_NUM = 1);
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
INSERT OVERWRITE INTO SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1
(SELECT RASW1.MAWB_NBR, RASW1.HAWB_NBR, RASW1.REF_NBR, COALESCE(I.ITEM_NUMBER, RASW1.ITM_NBR), RASW1.SHIPPING_METHOD, RASW1.FLIGHT_NBR, RASW1.FORWARDER_ID, RASW1.FORWARDER_NAME, RASW1.CARRIER_CD, RASW1.PORT_OF_LADING_ID, RASW1.PORT_OF_LADING_NAME, RASW1.PORT_OF_DISCHARGE_ID, RASW1.PORT_OF_DISCHARGE_NAME, RASW1.DESTINATION_ID, RASW1.DESTINATION_NAME, RASW1.DIM_WGT, RASW1.DIM_WGT_UOM, RASW1.GROSS_WGT, RASW1.GROSS_WGT_UOM, RASW1.TOTAL_CARTONS, RASW1.ACTUAL_DEPART_DTM, RASW1.TRANSMISSION_DTM, RASW1.ETA_DTM, RASW1.CARGO_RECEIPT_DTM, RASW1.DOCS_AVAILABLE_DTM, RASW1.BRAND, RASW1.DELIVER_TO, RASW1.PO_NBR, RASW1.CONTRACT_NBR, RASW1.ORDER_NBR, RASW1.PO_UNIT, RASW1.PO_CARTONS_QTY, RASW1.PO_GROSS_WGT, RASW1.PO_GROSS_WGT_UOM, RASW1.PO_DIM_WGT, RASW1.PO_DIM_WGT_UOM, RASW1.PO_CHARGEABLE_WGT, RASW1.PO_CHARGEABLE_WGT_UOM, RASW1.GARMENT_PACK, RASW1.PRE_TKT, RASW1.HEADER_LAST_UPD_DTM, RASW1.DETAIL_LAST_UPD_DTM
FROM (SELECT RASW.MAWB_NBR, RASW.HAWB_NBR, RASW.REF_NBR, RASW.ITM_NBR, RASW.SHIPPING_METHOD, RASW.FLIGHT_NBR, RASW.FORWARDER_ID, RASW.FORWARDER_NAME, RASW.CARRIER_CD, RASW.PORT_OF_LADING_ID, RASW.PORT_OF_LADING_NAME, RASW.PORT_OF_DISCHARGE_ID, RASW.PORT_OF_DISCHARGE_NAME, RASW.DESTINATION_ID, RASW.DESTINATION_NAME, RASW.DIM_WGT, RASW.DIM_WGT_UOM, RASW.GROSS_WGT, RASW.GROSS_WGT_UOM, RASW.TOTAL_CARTONS, RASW.ACTUAL_DEPART_DTM, RASW.TRANSMISSION_DTM, RASW.ETA_DTM, RASW.CARGO_RECEIPT_DTM, RASW.DOCS_AVAILABLE_DTM, RASW.BRAND, RASW.DELIVER_TO, RASW.PO_NBR, RASW.CONTRACT_NBR, RASW.ORDER_NBR, RASW.PO_UNIT, RASW.PO_CARTONS_QTY, RASW.PO_GROSS_WGT, RASW.PO_GROSS_WGT_UOM, RASW.PO_DIM_WGT, RASW.PO_DIM_WGT_UOM, RASW.PO_CHARGEABLE_WGT, RASW.PO_CHARGEABLE_WGT_UOM, RASW.GARMENT_PACK, RASW.PRE_TKT, RASW.HEADER_LAST_UPD_DTM, RASW.DETAIL_LAST_UPD_DTM
FROM (SELECT MAWB_NBR, HAWB_NBR, REF_NBR, ITM_NBR, SHIPPING_METHOD, FLIGHT_NBR, FORWARDER_ID, FORWARDER_NAME, CARRIER_CD, PORT_OF_LADING_ID, PORT_OF_LADING_NAME, PORT_OF_DISCHARGE_ID, PORT_OF_DISCHARGE_NAME, DESTINATION_ID, DESTINATION_NAME, DIM_WGT, DIM_WGT_UOM, GROSS_WGT, GROSS_WGT_UOM, TOTAL_CARTONS, ACTUAL_DEPART_DTM, TRANSMISSION_DTM, ETA_DTM, CARGO_RECEIPT_DTM, DOCS_AVAILABLE_DTM, BRAND, DELIVER_TO, PO_NBR, CONTRACT_NBR, ORDER_NBR, PO_UNIT, PO_CARTONS_QTY, PO_GROSS_WGT, PO_GROSS_WGT_UOM, PO_DIM_WGT, PO_DIM_WGT_UOM, PO_CHARGEABLE_WGT, PO_CHARGEABLE_WGT_UOM, GARMENT_PACK, PRE_TKT, HEADER_LAST_UPD_DTM, DETAIL_LAST_UPD_DTM, ROW_NUMBER() OVER (PARTITION BY MAWB_NBR, HAWB_NBR, FORWARDER_ID, CONTRACT_NBR, ORDER_NBR, REF_NBR, ITM_NBR ORDER BY DETAIL_LAST_UPD_DTM DESC) AS ROW_NUM
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK) AS RASW
WHERE RASW.ROW_NUM = 1) AS RASW1
LEFT JOIN ANALYTICS_VIEW.ITEM AS I ON TRIM( RASW1.ITM_NBR) = TRIM( SUBSTRING(I.ITEM_NUMBER FROM -8)));
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
! echo completed loading into scct_work_db.rockport_air_shipment_work1;
! echo started loading into scct_db.rockport_air_shipment;
INSERT OVERWRITE INTO SCCT_DB.ROCKPORT_AIR_SHIPMENT
(SELECT COALESCE(RASW.MAWB_NBR, RAS.MAWB_NBR), COALESCE(RASW.HAWB_NBR, RAS.HAWB_NBR), COALESCE(RASW.REF_NBR, RAS.REF_NBR), COALESCE(RASW.ITM_NBR, RAS.ITM_NBR), COALESCE(RASW.SHIPPING_METHOD, RAS.SHIPPING_METHOD), COALESCE(RASW.FLIGHT_NBR, RAS.FLIGHT_NBR), COALESCE(RASW.FORWARDER_ID, RAS.FORWARDER_ID), COALESCE(RASW.FORWARDER_NAME, RAS.FORWARDER_NAME), COALESCE(RASW.CARRIER_CD, RAS.CARRIER_CD), COALESCE(RASW.PORT_OF_LADING_ID, RAS.PORT_OF_LADING_ID), COALESCE(RASW.PORT_OF_LADING_NAME, RAS.PORT_OF_LADING_NAME), COALESCE(RASW.PORT_OF_DISCHARGE_ID, RAS.PORT_OF_DISCHARGE_ID), COALESCE(RASW.PORT_OF_DISCHARGE_NAME, RAS.PORT_OF_DISCHARGE_NAME), COALESCE(RASW.DESTINATION_ID, RAS.DESTINATION_ID), COALESCE(RASW.DESTINATION_NAME, RAS.DESTINATION_NAME), COALESCE(RASW.DIM_WGT, RAS.DIM_WGT), COALESCE(RASW.DIM_WGT_UOM, RAS.DIM_WGT_UOM), COALESCE(RASW.GROSS_WGT, RAS.GROSS_WGT), COALESCE(RASW.GROSS_WGT_UOM, RAS.GROSS_WGT_UOM), COALESCE(RASW.TOTAL_CARTONS, RAS.TOTAL_CARTONS), COALESCE(RASW.ACTUAL_DEPART_DTM, RAS.ACTUAL_DEPART_DTM), COALESCE(RASW.TRANSMISSION_DTM, RAS.TRANSMISSION_DTM), COALESCE(RASW.ETA_DTM, RAS.ETA_DTM), COALESCE(RASW.CARGO_RECEIPT_DTM, RAS.CARGO_RECEIPT_DTM), COALESCE(RASW.DOCS_AVAILABLE_DTM, RAS.DOCS_AVAILABLE_DTM), COALESCE(RASW.BRAND, RAS.BRAND), COALESCE(RASW.DELIVER_TO, RAS.DELIVER_TO), COALESCE(RASW.PO_NBR, RAS.PO_NBR), COALESCE(RASW.CONTRACT_NBR, RAS.CONTRACT_NBR), COALESCE(RASW.ORDER_NBR, RAS.ORDER_NBR), COALESCE(RASW.PO_UNIT, RAS.PO_UNIT), COALESCE(RASW.PO_CARTONS_QTY, RAS.PO_CARTONS_QTY), COALESCE(RASW.PO_GROSS_WGT, RAS.PO_GROSS_WGT), COALESCE(RASW.PO_GROSS_WGT_UOM, RAS.PO_GROSS_WGT_UOM), COALESCE(RASW.PO_DIM_WGT, RAS.PO_DIM_WGT), COALESCE(RASW.PO_DIM_WGT_UOM, RAS.PO_DIM_WGT_UOM), COALESCE(RASW.PO_CHARGEABLE_WGT, RAS.PO_CHARGEABLE_WGT), COALESCE(RASW.PO_CHARGEABLE_WGT_UOM, RAS.PO_CHARGEABLE_WGT_UOM), COALESCE(RASW.GARMENT_PACK, RAS.GARMENT_PACK), COALESCE(RASW.PRE_TKT, RAS.PRE_TKT), COALESCE(RASW.HEADER_LAST_UPD_DTM, RAS.HEADER_LAST_UPD_DTM), COALESCE(RASW.DETAIL_LAST_UPD_DTM, RAS.DETAIL_LAST_UPD_DTM)
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1 AS RASW
FULL JOIN SCCT_DB.ROCKPORT_AIR_SHIPMENT AS RAS ON RASW.MAWB_NBR = RAS.MAWB_NBR AND RASW.FORWARDER_ID = RAS.FORWARDER_ID AND RASW.HAWB_NBR = RAS.HAWB_NBR AND RASW.CONTRACT_NBR = RAS.CONTRACT_NBR AND RASW.ORDER_NBR = RAS.ORDER_NBR AND RASW.REF_NBR = RAS.REF_NBR AND RASW.ITM_NBR = RAS.ITM_NBR);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_zdtd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug20 scctp5-327 fyuan zdtd initial version ---------------------------------------------------------------------------- ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_po -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add component filter  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_podd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 20aug20 scctp5-327 fyuan add zdtd  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_posodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_sodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-e2e_dashboard-hive-stg1-scct_db.prepack_component -------------------------------------------------------------------------- ---target: stage1 table: scct_db.prepack_component  ---source: scct_db table : bom_item, bom_detail, analytics_view table : item ---load type: full ---back posting: no ---author: ryadav ---last modified date: 12/18/2018 --------------------------------------------------------------------------  ------------------------- ---loading prepack_component stage 1 base data -------------------------  ! echo started loading into scct_db.prepack_component ;
! echo completed loading into scct_db.prepack_component ;
---jobname:scct-e2e_outbound_visibility-hive-stg1-scct_db.purge_wms_outbound_e2e -------------------------------------------------------------------------- ---target: stage1 table: scct_db.wms_outbound_e2e ---source: scct_db table : scct_db.wms_outbound_e2e and operations_db.purge_tables  ---load type: incrimental ---back posting: no ---author: ssoma ---created date: 12/02/2019 --------------------------------------------------------------------------  ------------------------- ---loading worker table without str rows  -------------------------   insert overwrite table scct_work_db.wms_retail_warehouse_shipping_link_work select rs.retail_warehouse ,rs.retail_distro_nbr ,rs.retail_store_nbr ,rs.retail_season_nbr ,rs.retail_season_year_nbr ,rs.retail_style_nbr ,rs.retail_style_sfx_nbr ,rs.retail_sector ,rs.retail_sap_style ,rs.retail_sap_choice ,rs.retail_sap_size ,rs.retail_ticket_typ ,rs.retail_instore_dt ,rs.retail_distro_total_qty ,rs.retail_distro_allocated_qty ,rs.retail_distro_remaining_qty ,rs.retail_dtstor_status_flag ,rs.retail_record_expansion_fld ,rs.retail_delv_doc_nbr ,rs.retail_delv_doc_itm_nbr ,rs.retail_distro_last_modified_datetime ,rs.retail_distro_create_datetime ,rs.retail_pickticket_control_nbr ,rs.retail_pdpick_pkt_line_nbr ,rs.retail_pdpick_pick_wave_nbr ,rs.retail_wave_processing_typ ,rs.retail_inv_allocation_typ ,rs.retail_pick_determination_typ ,rs.retail_pick_loc_assignment_typ ,rs.retail_pickticket_pick_location ,rs.retail_original_pick_order_qty ,rs.retail_original_pick_qty ,rs.retail_pick_qty ,rs.retail_pick_shortage_qty ,rs.retail_pick_cancelled_qty ,rs.retail_pick_packed_qty ,rs.retail_pdpick_status_flg ,rs.retail_specl_instr_cd_1 ,rs.retail_pickticket_last_modified_datetime ,rs.retail_pdpick_user_id ,rs.retail_district ,rs.retail_shipto_name ,rs.retail_shipto_state ,rs.retail_shipto_zip ,rs.retail_shipto_country ,rs.retail_pickticket_header_created_datetime ,rs.retail_pickticket_header_last_modified_datetime ,rs.retail_phpick_user_id ,rs.retail_carton_nbr ,rs.retail_carton_line_nbr ,rs.retail_package_barcd ,rs.retail_cdcart_pkt_line_nbr ,rs.retail_cdcart_pick_wave_nbr ,rs.retail_carton_qty_to_be_packed ,rs.retail_carton_qty_packed ,rs.retail_carton_delivered_qty ,rs.retail_carton_cancelled_qty ,rs.retail_carton_pick_location ,rs.retail_cdcart_status_flag ,rs.retail_packer_id ,rs.retail_carton_line_create_datetime ,rs.retail_carton_line_last_modified_datetime ,rs.retail_cdcart_user_id ,rs.retail_misc_nbr_1 ,rs.retail_chcart_pick_wave_nbr ,rs.retail_chcart_status_flg ,rs.retail_pack_cd ,rs.retail_pack_typ ,rs.retail_single_sku_flg ,rs.retail_first_pick_location ,rs.retail_carton_typ ,rs.retail_carton_sz ,rs.retail_carton_volume ,rs.retail_estimated_weight ,rs.retail_actual_weight ,rs.retail_pallet_id ,rs.retail_product_value ,rs.retail_bill_of_lading ,rs.retail_shipment_nbr ,rs.retail_load_nbr ,rs.retail_path_nbr ,rs.retail_ship_via ,rs.retail_special_ins_cd_1 ,rs.retail_special_ins_cd_2 ,rs.retail_special_ins_cd_3 ,rs.retail_misc_10_byte_1 ,rs.retail_misc_20_byte_1 ,rs.retail_misc_20_byte_2 ,rs.retail_misc_20_byte_4 ,rs.retail_misc_20_byte_5 ,rs.retail_reference_case_nbr ,rs.retail_carton_nbr_x_of_y ,rs.retail_audit_status ,rs.retail_tms_parcel_nbr ,rs.retail_carton_length ,rs.retail_carton_width ,rs.retail_carton_height ,rs.retail_recipient_first_name ,rs.retail_carton_last_modified_datetime ,rs.retail_chcart_user_id ,rs.retail_pickticket_create_datetime ,rs.retail_carton_create_datetime ,rs.retail_carton_invoiced_datetime ,rs.retail_distro_to_wave_time_duration ,rs.retail_wave_to_invoiced_duration ,rs.retail_distro_total_reaches ,rs.retail_distro_allocated_reaches ,rs.retail_distro_remaining_reaches ,rs.retail_original_pick_order_reaches ,rs.retail_original_pick_reaches ,rs.retail_pick_reaches ,rs.retail_pick_shortage_reaches ,rs.retail_pick_cancelled_reaches ,rs.retail_pick_packed_reaches ,rs.retail_carton_reaches_to_be_packed ,rs.retail_carton_reaches_packed ,rs.retail_carton_delivered_reaches ,rs.retail_carton_cancelled_reaches ,rs.retail_fc_ltfc ,rs.retail_processing_area ,rs.shipping_misc_20_byte_3 ,rs.shipping_carton_nbr ,rs.shipping_warehouse ,rs.shipping_load_nbr ,rs.shipping_destination_typ ,rs.shipping_ship_via ,rs.shipping_master_bill_of_lading ,rs.shipping_trailer_nbr ,rs.shipping_tractor_nbr ,rs.shipping_driver ,rs.shipping_dock ,rs.shipping_door ,rs.shipping_dock_door_locn_brcd ,rs.shipping_tms_plan_nbr ,rs.shipping_status_flg ,rs.shipping_status_dt ,rs.shipping_load_closed_dt ,rs.shipping_load_closed_ts ,rs.shipping_tc_shipment_id ,rs.shipping_tpe_created_load ,rs.shipping_tpe_processing_status ,rs.shipping_misc_instruction_1 ,rs.shipping_created_dt ,rs.shipping_created_ts ,rs.shipping_last_modified_dt ,rs.shipping_last_modified_ts ,rs.shipping_user_id ,rs.shipping_record_type ,rs.shipping_trip_nbr ,rs.shipping_trip_type ,rs.shipping_dispatch_dt ,rs.shipping_dispatch_ts ,rs.shipping_carton_limit ,rs.shipping_run_nbr ,rs.shipping_thtrip_ship_via ,rs.shipping_thtrip_status_flg ,rs.shipping_delay_code ,rs.shipping_cartons_loaded ,rs.shipping_seal_nbr ,rs.shipping_date_billed ,rs.shipping_time_billed ,rs.shipping_thtrip_seal_nbr ,rs.shipping_misc1_numeric_fld ,rs.shipping_miscellaneous_20 ,rs.shipping_thtrip_created_dt ,rs.shipping_thtrip_created_ts ,rs.shipping_thtrip_last_modified_dt ,rs.shipping_thtrip_last_modified_ts ,rs.shipping_thtrip_user_id ,rs.shipping_load_create_dt_ts ,rs.shipping_load_closed_dt_ts ,rs.shipping_load_create_to_closed_duration ,rs.distro_create_date ,rs.batch_code from scct_db.wms_outbound_e2e rs join (select purge_min_dt, purge_max_dt from operations_db.purge_tables p join  (select date_sub(min(to_date(distro_create_datetime)),1) purge_max_dt from scct_db.wms_outbound_retail) r on 1=1 where p.run_ind='n') pt on 1=1 where rs.distro_create_date between pt.purge_min_dt and pt.purge_max_dt and rs.retail_pickticket_control_nbr not like 'str%';
! echo worker table load is completed;
------------------------- ---insert back to base table only not str retail_pickticket_control_nbr rows -------------------------   insert overwrite table scct_db.wms_outbound_e2e partition(distro_create_date) select retail_warehouse ,retail_distro_nbr ,retail_store_nbr ,retail_season_nbr ,retail_season_year_nbr ,retail_style_nbr ,retail_style_sfx_nbr ,retail_sector ,retail_sap_style ,retail_sap_choice ,retail_sap_size ,retail_ticket_typ ,retail_instore_dt ,retail_distro_total_qty ,retail_distro_allocated_qty ,retail_distro_remaining_qty ,retail_dtstor_status_flag ,retail_record_expansion_fld ,retail_delv_doc_nbr ,retail_delv_doc_itm_nbr ,retail_distro_last_modified_datetime ,retail_distro_create_datetime ,retail_pickticket_control_nbr ,retail_pdpick_pkt_line_nbr ,retail_pdpick_pick_wave_nbr ,retail_wave_processing_typ ,retail_inv_allocation_typ ,retail_pick_determination_typ ,retail_pick_loc_assignment_typ ,retail_pickticket_pick_location ,retail_original_pick_order_qty ,retail_original_pick_qty ,retail_pick_qty ,retail_pick_shortage_qty ,retail_pick_cancelled_qty ,retail_pick_packed_qty ,retail_pdpick_status_flg ,retail_specl_instr_cd_1 ,retail_pickticket_last_modified_datetime ,retail_pdpick_user_id ,retail_district ,retail_shipto_name ,retail_shipto_state ,retail_shipto_zip ,retail_shipto_country ,retail_pickticket_header_created_datetime ,retail_pickticket_header_last_modified_datetime ,retail_phpick_user_id ,retail_carton_nbr ,retail_carton_line_nbr ,retail_package_barcd ,retail_cdcart_pkt_line_nbr ,retail_cdcart_pick_wave_nbr ,retail_carton_qty_to_be_packed ,retail_carton_qty_packed ,retail_carton_delivered_qty ,retail_carton_cancelled_qty ,retail_carton_pick_location ,retail_cdcart_status_flag ,retail_packer_id ,retail_carton_line_create_datetime ,retail_carton_line_last_modified_datetime ,retail_cdcart_user_id ,retail_misc_nbr_1 ,retail_chcart_pick_wave_nbr ,retail_chcart_status_flg ,retail_pack_cd ,retail_pack_typ ,retail_single_sku_flg ,retail_first_pick_location ,retail_carton_typ ,retail_carton_sz ,retail_carton_volume ,retail_estimated_weight ,retail_actual_weight ,retail_pallet_id ,retail_product_value ,retail_bill_of_lading ,retail_shipment_nbr ,retail_load_nbr ,retail_path_nbr ,retail_ship_via ,retail_special_ins_cd_1 ,retail_special_ins_cd_2 ,retail_special_ins_cd_3 ,retail_misc_10_byte_1 ,retail_misc_20_byte_1 ,retail_misc_20_byte_2 ,retail_misc_20_byte_4 ,retail_misc_20_byte_5 ,retail_reference_case_nbr ,retail_carton_nbr_x_of_y ,retail_audit_status ,retail_tms_parcel_nbr ,retail_carton_length ,retail_carton_width ,retail_carton_height ,retail_recipient_first_name ,retail_carton_last_modified_datetime ,retail_chcart_user_id ,retail_pickticket_create_datetime ,retail_carton_create_datetime ,retail_carton_invoiced_datetime ,retail_distro_to_wave_time_duration ,retail_wave_to_invoiced_duration ,retail_distro_total_reaches ,retail_distro_allocated_reaches ,retail_distro_remaining_reaches ,retail_original_pick_order_reaches ,retail_original_pick_reaches ,retail_pick_reaches ,retail_pick_shortage_reaches ,retail_pick_cancelled_reaches ,retail_pick_packed_reaches ,retail_carton_reaches_to_be_packed ,retail_carton_reaches_packed ,retail_carton_delivered_reaches ,retail_carton_cancelled_reaches ,retail_fc_ltfc ,retail_processing_area ,shipping_misc_20_byte_3 ,shipping_carton_nbr ,shipping_warehouse ,shipping_load_nbr ,shipping_destination_typ ,shipping_ship_via ,shipping_master_bill_of_lading ,shipping_trailer_nbr ,shipping_tractor_nbr ,shipping_driver ,shipping_dock ,shipping_door ,shipping_dock_door_locn_brcd ,shipping_tms_plan_nbr ,shipping_status_flg ,shipping_status_dt ,shipping_load_closed_dt ,shipping_load_closed_ts ,shipping_tc_shipment_id ,shipping_tpe_created_load ,shipping_tpe_processing_status ,shipping_misc_instruction_1 ,shipping_created_dt ,shipping_created_ts ,shipping_last_modified_dt ,shipping_last_modified_ts ,shipping_user_id ,shipping_record_type ,shipping_trip_nbr ,shipping_trip_type ,shipping_dispatch_dt ,shipping_dispatch_ts ,shipping_carton_limit ,shipping_run_nbr ,shipping_thtrip_ship_via ,shipping_thtrip_status_flg ,shipping_delay_code ,shipping_cartons_loaded ,shipping_seal_nbr ,shipping_date_billed ,shipping_time_billed ,shipping_thtrip_seal_nbr ,shipping_misc1_numeric_fld ,shipping_miscellaneous_20 ,shipping_thtrip_created_dt ,shipping_thtrip_created_ts ,shipping_thtrip_last_modified_dt ,shipping_thtrip_last_modified_ts ,shipping_thtrip_user_id ,shipping_load_create_dt_ts ,shipping_load_closed_dt_ts ,shipping_load_create_to_closed_duration ,batch_code ,distro_create_date from scct_work_db.wms_retail_warehouse_shipping_link_work;
! echo purge str rows completed;
------------------------- ---update record into control table to purge str rows -------------------------   ! echo started entry into job control table;
------------------------- ---insert record into control table to purge str rows -------------------------  ! echo started entry into job control table;
! echo entry into job control table completed;
---jobname:scct-rockport-hive-stg1-scct_db.rockport_air_shipment -------------------------------------------------------------------------- ---target: stage1 table: scct_db.rockport_air_shipment ---source: rockport_stage0 table : trader_shipping_hdr, trader_shipping_dtl, trader_party, trader_plci3225 --- trader_packing, trader_delivery_dtl and trader_matrix_hdr;
---load type: full ---back posting: no ---author: ssoma ---created date: 02/05/2019 --------------------------------------------------------------------------  ------------------------- ---loading work table scct_db.trader_plci3225_work  -------------------------   ! echo started loading into scct_work_db.trader_plci3225_work;
INSERT OVERWRITE INTO SCCT_WORK_DB.TRADER_PLCI3225_WORK
(SELECT OWNER, PLACE_CODE, PLACE_NAME
FROM (SELECT OWNER, PLACE_CODE, PLACE_NAME, ROW_NUMBER() OVER (PARTITION BY TRIM( OWNER), TRIM( PLACE_CODE) ORDER BY FROM_UNIXTIME(LAST_UPDATE / 1000, 'yyyy-mm-dd hh:mm:ss') DESC) AS ROW_NUM
FROM ROCKPORT_STAGE0.TRADER_PLCI3225) AS A
WHERE A.ROW_NUM = 1);
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
INSERT OVERWRITE INTO SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1
(SELECT RASW1.MAWB_NBR, RASW1.HAWB_NBR, RASW1.REF_NBR, COALESCE(I.ITEM_NUMBER, RASW1.ITM_NBR), RASW1.SHIPPING_METHOD, RASW1.FLIGHT_NBR, RASW1.FORWARDER_ID, RASW1.FORWARDER_NAME, RASW1.CARRIER_CD, RASW1.PORT_OF_LADING_ID, RASW1.PORT_OF_LADING_NAME, RASW1.PORT_OF_DISCHARGE_ID, RASW1.PORT_OF_DISCHARGE_NAME, RASW1.DESTINATION_ID, RASW1.DESTINATION_NAME, RASW1.DIM_WGT, RASW1.DIM_WGT_UOM, RASW1.GROSS_WGT, RASW1.GROSS_WGT_UOM, RASW1.TOTAL_CARTONS, RASW1.ACTUAL_DEPART_DTM, RASW1.TRANSMISSION_DTM, RASW1.ETA_DTM, RASW1.CARGO_RECEIPT_DTM, RASW1.DOCS_AVAILABLE_DTM, RASW1.BRAND, RASW1.DELIVER_TO, RASW1.PO_NBR, RASW1.CONTRACT_NBR, RASW1.ORDER_NBR, RASW1.PO_UNIT, RASW1.PO_CARTONS_QTY, RASW1.PO_GROSS_WGT, RASW1.PO_GROSS_WGT_UOM, RASW1.PO_DIM_WGT, RASW1.PO_DIM_WGT_UOM, RASW1.PO_CHARGEABLE_WGT, RASW1.PO_CHARGEABLE_WGT_UOM, RASW1.GARMENT_PACK, RASW1.PRE_TKT, RASW1.HEADER_LAST_UPD_DTM, RASW1.DETAIL_LAST_UPD_DTM
FROM (SELECT RASW.MAWB_NBR, RASW.HAWB_NBR, RASW.REF_NBR, RASW.ITM_NBR, RASW.SHIPPING_METHOD, RASW.FLIGHT_NBR, RASW.FORWARDER_ID, RASW.FORWARDER_NAME, RASW.CARRIER_CD, RASW.PORT_OF_LADING_ID, RASW.PORT_OF_LADING_NAME, RASW.PORT_OF_DISCHARGE_ID, RASW.PORT_OF_DISCHARGE_NAME, RASW.DESTINATION_ID, RASW.DESTINATION_NAME, RASW.DIM_WGT, RASW.DIM_WGT_UOM, RASW.GROSS_WGT, RASW.GROSS_WGT_UOM, RASW.TOTAL_CARTONS, RASW.ACTUAL_DEPART_DTM, RASW.TRANSMISSION_DTM, RASW.ETA_DTM, RASW.CARGO_RECEIPT_DTM, RASW.DOCS_AVAILABLE_DTM, RASW.BRAND, RASW.DELIVER_TO, RASW.PO_NBR, RASW.CONTRACT_NBR, RASW.ORDER_NBR, RASW.PO_UNIT, RASW.PO_CARTONS_QTY, RASW.PO_GROSS_WGT, RASW.PO_GROSS_WGT_UOM, RASW.PO_DIM_WGT, RASW.PO_DIM_WGT_UOM, RASW.PO_CHARGEABLE_WGT, RASW.PO_CHARGEABLE_WGT_UOM, RASW.GARMENT_PACK, RASW.PRE_TKT, RASW.HEADER_LAST_UPD_DTM, RASW.DETAIL_LAST_UPD_DTM
FROM (SELECT MAWB_NBR, HAWB_NBR, REF_NBR, ITM_NBR, SHIPPING_METHOD, FLIGHT_NBR, FORWARDER_ID, FORWARDER_NAME, CARRIER_CD, PORT_OF_LADING_ID, PORT_OF_LADING_NAME, PORT_OF_DISCHARGE_ID, PORT_OF_DISCHARGE_NAME, DESTINATION_ID, DESTINATION_NAME, DIM_WGT, DIM_WGT_UOM, GROSS_WGT, GROSS_WGT_UOM, TOTAL_CARTONS, ACTUAL_DEPART_DTM, TRANSMISSION_DTM, ETA_DTM, CARGO_RECEIPT_DTM, DOCS_AVAILABLE_DTM, BRAND, DELIVER_TO, PO_NBR, CONTRACT_NBR, ORDER_NBR, PO_UNIT, PO_CARTONS_QTY, PO_GROSS_WGT, PO_GROSS_WGT_UOM, PO_DIM_WGT, PO_DIM_WGT_UOM, PO_CHARGEABLE_WGT, PO_CHARGEABLE_WGT_UOM, GARMENT_PACK, PRE_TKT, HEADER_LAST_UPD_DTM, DETAIL_LAST_UPD_DTM, ROW_NUMBER() OVER (PARTITION BY MAWB_NBR, HAWB_NBR, FORWARDER_ID, CONTRACT_NBR, ORDER_NBR, REF_NBR, ITM_NBR ORDER BY DETAIL_LAST_UPD_DTM DESC) AS ROW_NUM
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK) AS RASW
WHERE RASW.ROW_NUM = 1) AS RASW1
LEFT JOIN ANALYTICS_VIEW.ITEM AS I ON TRIM( RASW1.ITM_NBR) = TRIM( SUBSTRING(I.ITEM_NUMBER FROM -8)));
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
! echo completed loading into scct_work_db.rockport_air_shipment_work1;
! echo started loading into scct_db.rockport_air_shipment;
INSERT OVERWRITE INTO SCCT_DB.ROCKPORT_AIR_SHIPMENT
(SELECT COALESCE(RASW.MAWB_NBR, RAS.MAWB_NBR), COALESCE(RASW.HAWB_NBR, RAS.HAWB_NBR), COALESCE(RASW.REF_NBR, RAS.REF_NBR), COALESCE(RASW.ITM_NBR, RAS.ITM_NBR), COALESCE(RASW.SHIPPING_METHOD, RAS.SHIPPING_METHOD), COALESCE(RASW.FLIGHT_NBR, RAS.FLIGHT_NBR), COALESCE(RASW.FORWARDER_ID, RAS.FORWARDER_ID), COALESCE(RASW.FORWARDER_NAME, RAS.FORWARDER_NAME), COALESCE(RASW.CARRIER_CD, RAS.CARRIER_CD), COALESCE(RASW.PORT_OF_LADING_ID, RAS.PORT_OF_LADING_ID), COALESCE(RASW.PORT_OF_LADING_NAME, RAS.PORT_OF_LADING_NAME), COALESCE(RASW.PORT_OF_DISCHARGE_ID, RAS.PORT_OF_DISCHARGE_ID), COALESCE(RASW.PORT_OF_DISCHARGE_NAME, RAS.PORT_OF_DISCHARGE_NAME), COALESCE(RASW.DESTINATION_ID, RAS.DESTINATION_ID), COALESCE(RASW.DESTINATION_NAME, RAS.DESTINATION_NAME), COALESCE(RASW.DIM_WGT, RAS.DIM_WGT), COALESCE(RASW.DIM_WGT_UOM, RAS.DIM_WGT_UOM), COALESCE(RASW.GROSS_WGT, RAS.GROSS_WGT), COALESCE(RASW.GROSS_WGT_UOM, RAS.GROSS_WGT_UOM), COALESCE(RASW.TOTAL_CARTONS, RAS.TOTAL_CARTONS), COALESCE(RASW.ACTUAL_DEPART_DTM, RAS.ACTUAL_DEPART_DTM), COALESCE(RASW.TRANSMISSION_DTM, RAS.TRANSMISSION_DTM), COALESCE(RASW.ETA_DTM, RAS.ETA_DTM), COALESCE(RASW.CARGO_RECEIPT_DTM, RAS.CARGO_RECEIPT_DTM), COALESCE(RASW.DOCS_AVAILABLE_DTM, RAS.DOCS_AVAILABLE_DTM), COALESCE(RASW.BRAND, RAS.BRAND), COALESCE(RASW.DELIVER_TO, RAS.DELIVER_TO), COALESCE(RASW.PO_NBR, RAS.PO_NBR), COALESCE(RASW.CONTRACT_NBR, RAS.CONTRACT_NBR), COALESCE(RASW.ORDER_NBR, RAS.ORDER_NBR), COALESCE(RASW.PO_UNIT, RAS.PO_UNIT), COALESCE(RASW.PO_CARTONS_QTY, RAS.PO_CARTONS_QTY), COALESCE(RASW.PO_GROSS_WGT, RAS.PO_GROSS_WGT), COALESCE(RASW.PO_GROSS_WGT_UOM, RAS.PO_GROSS_WGT_UOM), COALESCE(RASW.PO_DIM_WGT, RAS.PO_DIM_WGT), COALESCE(RASW.PO_DIM_WGT_UOM, RAS.PO_DIM_WGT_UOM), COALESCE(RASW.PO_CHARGEABLE_WGT, RAS.PO_CHARGEABLE_WGT), COALESCE(RASW.PO_CHARGEABLE_WGT_UOM, RAS.PO_CHARGEABLE_WGT_UOM), COALESCE(RASW.GARMENT_PACK, RAS.GARMENT_PACK), COALESCE(RASW.PRE_TKT, RAS.PRE_TKT), COALESCE(RASW.HEADER_LAST_UPD_DTM, RAS.HEADER_LAST_UPD_DTM), COALESCE(RASW.DETAIL_LAST_UPD_DTM, RAS.DETAIL_LAST_UPD_DTM)
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1 AS RASW
FULL JOIN SCCT_DB.ROCKPORT_AIR_SHIPMENT AS RAS ON RASW.MAWB_NBR = RAS.MAWB_NBR AND RASW.FORWARDER_ID = RAS.FORWARDER_ID AND RASW.HAWB_NBR = RAS.HAWB_NBR AND RASW.CONTRACT_NBR = RAS.CONTRACT_NBR AND RASW.ORDER_NBR = RAS.ORDER_NBR AND RASW.REF_NBR = RAS.REF_NBR AND RASW.ITM_NBR = RAS.ITM_NBR);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_zdtd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug20 scctp5-327 fyuan zdtd initial version ---------------------------------------------------------------------------- ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_po -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add component filter  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_podd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 20aug20 scctp5-327 fyuan add zdtd  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_posodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_sodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-e2e_dashboard-hive-stg1-scct_db.prepack_component -------------------------------------------------------------------------- ---target: stage1 table: scct_db.prepack_component  ---source: scct_db table : bom_item, bom_detail, analytics_view table : item ---load type: full ---back posting: no ---author: ryadav ---last modified date: 12/18/2018 --------------------------------------------------------------------------  ------------------------- ---loading prepack_component stage 1 base data -------------------------  ! echo started loading into scct_db.prepack_component ;
! echo completed loading into scct_db.prepack_component ;
---jobname:scct-e2e_outbound_visibility-hive-stg1-scct_db.purge_wms_outbound_e2e -------------------------------------------------------------------------- ---target: stage1 table: scct_db.wms_outbound_e2e ---source: scct_db table : scct_db.wms_outbound_e2e and operations_db.purge_tables  ---load type: incrimental ---back posting: no ---author: ssoma ---created date: 12/02/2019 --------------------------------------------------------------------------  ------------------------- ---loading worker table without str rows  -------------------------   insert overwrite table scct_work_db.wms_retail_warehouse_shipping_link_work select rs.retail_warehouse ,rs.retail_distro_nbr ,rs.retail_store_nbr ,rs.retail_season_nbr ,rs.retail_season_year_nbr ,rs.retail_style_nbr ,rs.retail_style_sfx_nbr ,rs.retail_sector ,rs.retail_sap_style ,rs.retail_sap_choice ,rs.retail_sap_size ,rs.retail_ticket_typ ,rs.retail_instore_dt ,rs.retail_distro_total_qty ,rs.retail_distro_allocated_qty ,rs.retail_distro_remaining_qty ,rs.retail_dtstor_status_flag ,rs.retail_record_expansion_fld ,rs.retail_delv_doc_nbr ,rs.retail_delv_doc_itm_nbr ,rs.retail_distro_last_modified_datetime ,rs.retail_distro_create_datetime ,rs.retail_pickticket_control_nbr ,rs.retail_pdpick_pkt_line_nbr ,rs.retail_pdpick_pick_wave_nbr ,rs.retail_wave_processing_typ ,rs.retail_inv_allocation_typ ,rs.retail_pick_determination_typ ,rs.retail_pick_loc_assignment_typ ,rs.retail_pickticket_pick_location ,rs.retail_original_pick_order_qty ,rs.retail_original_pick_qty ,rs.retail_pick_qty ,rs.retail_pick_shortage_qty ,rs.retail_pick_cancelled_qty ,rs.retail_pick_packed_qty ,rs.retail_pdpick_status_flg ,rs.retail_specl_instr_cd_1 ,rs.retail_pickticket_last_modified_datetime ,rs.retail_pdpick_user_id ,rs.retail_district ,rs.retail_shipto_name ,rs.retail_shipto_state ,rs.retail_shipto_zip ,rs.retail_shipto_country ,rs.retail_pickticket_header_created_datetime ,rs.retail_pickticket_header_last_modified_datetime ,rs.retail_phpick_user_id ,rs.retail_carton_nbr ,rs.retail_carton_line_nbr ,rs.retail_package_barcd ,rs.retail_cdcart_pkt_line_nbr ,rs.retail_cdcart_pick_wave_nbr ,rs.retail_carton_qty_to_be_packed ,rs.retail_carton_qty_packed ,rs.retail_carton_delivered_qty ,rs.retail_carton_cancelled_qty ,rs.retail_carton_pick_location ,rs.retail_cdcart_status_flag ,rs.retail_packer_id ,rs.retail_carton_line_create_datetime ,rs.retail_carton_line_last_modified_datetime ,rs.retail_cdcart_user_id ,rs.retail_misc_nbr_1 ,rs.retail_chcart_pick_wave_nbr ,rs.retail_chcart_status_flg ,rs.retail_pack_cd ,rs.retail_pack_typ ,rs.retail_single_sku_flg ,rs.retail_first_pick_location ,rs.retail_carton_typ ,rs.retail_carton_sz ,rs.retail_carton_volume ,rs.retail_estimated_weight ,rs.retail_actual_weight ,rs.retail_pallet_id ,rs.retail_product_value ,rs.retail_bill_of_lading ,rs.retail_shipment_nbr ,rs.retail_load_nbr ,rs.retail_path_nbr ,rs.retail_ship_via ,rs.retail_special_ins_cd_1 ,rs.retail_special_ins_cd_2 ,rs.retail_special_ins_cd_3 ,rs.retail_misc_10_byte_1 ,rs.retail_misc_20_byte_1 ,rs.retail_misc_20_byte_2 ,rs.retail_misc_20_byte_4 ,rs.retail_misc_20_byte_5 ,rs.retail_reference_case_nbr ,rs.retail_carton_nbr_x_of_y ,rs.retail_audit_status ,rs.retail_tms_parcel_nbr ,rs.retail_carton_length ,rs.retail_carton_width ,rs.retail_carton_height ,rs.retail_recipient_first_name ,rs.retail_carton_last_modified_datetime ,rs.retail_chcart_user_id ,rs.retail_pickticket_create_datetime ,rs.retail_carton_create_datetime ,rs.retail_carton_invoiced_datetime ,rs.retail_distro_to_wave_time_duration ,rs.retail_wave_to_invoiced_duration ,rs.retail_distro_total_reaches ,rs.retail_distro_allocated_reaches ,rs.retail_distro_remaining_reaches ,rs.retail_original_pick_order_reaches ,rs.retail_original_pick_reaches ,rs.retail_pick_reaches ,rs.retail_pick_shortage_reaches ,rs.retail_pick_cancelled_reaches ,rs.retail_pick_packed_reaches ,rs.retail_carton_reaches_to_be_packed ,rs.retail_carton_reaches_packed ,rs.retail_carton_delivered_reaches ,rs.retail_carton_cancelled_reaches ,rs.retail_fc_ltfc ,rs.retail_processing_area ,rs.shipping_misc_20_byte_3 ,rs.shipping_carton_nbr ,rs.shipping_warehouse ,rs.shipping_load_nbr ,rs.shipping_destination_typ ,rs.shipping_ship_via ,rs.shipping_master_bill_of_lading ,rs.shipping_trailer_nbr ,rs.shipping_tractor_nbr ,rs.shipping_driver ,rs.shipping_dock ,rs.shipping_door ,rs.shipping_dock_door_locn_brcd ,rs.shipping_tms_plan_nbr ,rs.shipping_status_flg ,rs.shipping_status_dt ,rs.shipping_load_closed_dt ,rs.shipping_load_closed_ts ,rs.shipping_tc_shipment_id ,rs.shipping_tpe_created_load ,rs.shipping_tpe_processing_status ,rs.shipping_misc_instruction_1 ,rs.shipping_created_dt ,rs.shipping_created_ts ,rs.shipping_last_modified_dt ,rs.shipping_last_modified_ts ,rs.shipping_user_id ,rs.shipping_record_type ,rs.shipping_trip_nbr ,rs.shipping_trip_type ,rs.shipping_dispatch_dt ,rs.shipping_dispatch_ts ,rs.shipping_carton_limit ,rs.shipping_run_nbr ,rs.shipping_thtrip_ship_via ,rs.shipping_thtrip_status_flg ,rs.shipping_delay_code ,rs.shipping_cartons_loaded ,rs.shipping_seal_nbr ,rs.shipping_date_billed ,rs.shipping_time_billed ,rs.shipping_thtrip_seal_nbr ,rs.shipping_misc1_numeric_fld ,rs.shipping_miscellaneous_20 ,rs.shipping_thtrip_created_dt ,rs.shipping_thtrip_created_ts ,rs.shipping_thtrip_last_modified_dt ,rs.shipping_thtrip_last_modified_ts ,rs.shipping_thtrip_user_id ,rs.shipping_load_create_dt_ts ,rs.shipping_load_closed_dt_ts ,rs.shipping_load_create_to_closed_duration ,rs.distro_create_date ,rs.batch_code from scct_db.wms_outbound_e2e rs join (select purge_min_dt, purge_max_dt from operations_db.purge_tables p join  (select date_sub(min(to_date(distro_create_datetime)),1) purge_max_dt from scct_db.wms_outbound_retail) r on 1=1 where p.run_ind='n') pt on 1=1 where rs.distro_create_date between pt.purge_min_dt and pt.purge_max_dt and rs.retail_pickticket_control_nbr not like 'str%';
! echo worker table load is completed;
------------------------- ---insert back to base table only not str retail_pickticket_control_nbr rows -------------------------   insert overwrite table scct_db.wms_outbound_e2e partition(distro_create_date) select retail_warehouse ,retail_distro_nbr ,retail_store_nbr ,retail_season_nbr ,retail_season_year_nbr ,retail_style_nbr ,retail_style_sfx_nbr ,retail_sector ,retail_sap_style ,retail_sap_choice ,retail_sap_size ,retail_ticket_typ ,retail_instore_dt ,retail_distro_total_qty ,retail_distro_allocated_qty ,retail_distro_remaining_qty ,retail_dtstor_status_flag ,retail_record_expansion_fld ,retail_delv_doc_nbr ,retail_delv_doc_itm_nbr ,retail_distro_last_modified_datetime ,retail_distro_create_datetime ,retail_pickticket_control_nbr ,retail_pdpick_pkt_line_nbr ,retail_pdpick_pick_wave_nbr ,retail_wave_processing_typ ,retail_inv_allocation_typ ,retail_pick_determination_typ ,retail_pick_loc_assignment_typ ,retail_pickticket_pick_location ,retail_original_pick_order_qty ,retail_original_pick_qty ,retail_pick_qty ,retail_pick_shortage_qty ,retail_pick_cancelled_qty ,retail_pick_packed_qty ,retail_pdpick_status_flg ,retail_specl_instr_cd_1 ,retail_pickticket_last_modified_datetime ,retail_pdpick_user_id ,retail_district ,retail_shipto_name ,retail_shipto_state ,retail_shipto_zip ,retail_shipto_country ,retail_pickticket_header_created_datetime ,retail_pickticket_header_last_modified_datetime ,retail_phpick_user_id ,retail_carton_nbr ,retail_carton_line_nbr ,retail_package_barcd ,retail_cdcart_pkt_line_nbr ,retail_cdcart_pick_wave_nbr ,retail_carton_qty_to_be_packed ,retail_carton_qty_packed ,retail_carton_delivered_qty ,retail_carton_cancelled_qty ,retail_carton_pick_location ,retail_cdcart_status_flag ,retail_packer_id ,retail_carton_line_create_datetime ,retail_carton_line_last_modified_datetime ,retail_cdcart_user_id ,retail_misc_nbr_1 ,retail_chcart_pick_wave_nbr ,retail_chcart_status_flg ,retail_pack_cd ,retail_pack_typ ,retail_single_sku_flg ,retail_first_pick_location ,retail_carton_typ ,retail_carton_sz ,retail_carton_volume ,retail_estimated_weight ,retail_actual_weight ,retail_pallet_id ,retail_product_value ,retail_bill_of_lading ,retail_shipment_nbr ,retail_load_nbr ,retail_path_nbr ,retail_ship_via ,retail_special_ins_cd_1 ,retail_special_ins_cd_2 ,retail_special_ins_cd_3 ,retail_misc_10_byte_1 ,retail_misc_20_byte_1 ,retail_misc_20_byte_2 ,retail_misc_20_byte_4 ,retail_misc_20_byte_5 ,retail_reference_case_nbr ,retail_carton_nbr_x_of_y ,retail_audit_status ,retail_tms_parcel_nbr ,retail_carton_length ,retail_carton_width ,retail_carton_height ,retail_recipient_first_name ,retail_carton_last_modified_datetime ,retail_chcart_user_id ,retail_pickticket_create_datetime ,retail_carton_create_datetime ,retail_carton_invoiced_datetime ,retail_distro_to_wave_time_duration ,retail_wave_to_invoiced_duration ,retail_distro_total_reaches ,retail_distro_allocated_reaches ,retail_distro_remaining_reaches ,retail_original_pick_order_reaches ,retail_original_pick_reaches ,retail_pick_reaches ,retail_pick_shortage_reaches ,retail_pick_cancelled_reaches ,retail_pick_packed_reaches ,retail_carton_reaches_to_be_packed ,retail_carton_reaches_packed ,retail_carton_delivered_reaches ,retail_carton_cancelled_reaches ,retail_fc_ltfc ,retail_processing_area ,shipping_misc_20_byte_3 ,shipping_carton_nbr ,shipping_warehouse ,shipping_load_nbr ,shipping_destination_typ ,shipping_ship_via ,shipping_master_bill_of_lading ,shipping_trailer_nbr ,shipping_tractor_nbr ,shipping_driver ,shipping_dock ,shipping_door ,shipping_dock_door_locn_brcd ,shipping_tms_plan_nbr ,shipping_status_flg ,shipping_status_dt ,shipping_load_closed_dt ,shipping_load_closed_ts ,shipping_tc_shipment_id ,shipping_tpe_created_load ,shipping_tpe_processing_status ,shipping_misc_instruction_1 ,shipping_created_dt ,shipping_created_ts ,shipping_last_modified_dt ,shipping_last_modified_ts ,shipping_user_id ,shipping_record_type ,shipping_trip_nbr ,shipping_trip_type ,shipping_dispatch_dt ,shipping_dispatch_ts ,shipping_carton_limit ,shipping_run_nbr ,shipping_thtrip_ship_via ,shipping_thtrip_status_flg ,shipping_delay_code ,shipping_cartons_loaded ,shipping_seal_nbr ,shipping_date_billed ,shipping_time_billed ,shipping_thtrip_seal_nbr ,shipping_misc1_numeric_fld ,shipping_miscellaneous_20 ,shipping_thtrip_created_dt ,shipping_thtrip_created_ts ,shipping_thtrip_last_modified_dt ,shipping_thtrip_last_modified_ts ,shipping_thtrip_user_id ,shipping_load_create_dt_ts ,shipping_load_closed_dt_ts ,shipping_load_create_to_closed_duration ,batch_code ,distro_create_date from scct_work_db.wms_retail_warehouse_shipping_link_work;
! echo purge str rows completed;
------------------------- ---update record into control table to purge str rows -------------------------   ! echo started entry into job control table;
------------------------- ---insert record into control table to purge str rows -------------------------  ! echo started entry into job control table;
! echo entry into job control table completed;
---jobname:scct-rockport-hive-stg1-scct_db.rockport_air_shipment -------------------------------------------------------------------------- ---target: stage1 table: scct_db.rockport_air_shipment ---source: rockport_stage0 table : trader_shipping_hdr, trader_shipping_dtl, trader_party, trader_plci3225 --- trader_packing, trader_delivery_dtl and trader_matrix_hdr;
---load type: full ---back posting: no ---author: ssoma ---created date: 02/05/2019 --------------------------------------------------------------------------  ------------------------- ---loading work table scct_db.trader_plci3225_work  -------------------------   ! echo started loading into scct_work_db.trader_plci3225_work;
INSERT OVERWRITE INTO SCCT_WORK_DB.TRADER_PLCI3225_WORK
(SELECT OWNER, PLACE_CODE, PLACE_NAME
FROM (SELECT OWNER, PLACE_CODE, PLACE_NAME, ROW_NUMBER() OVER (PARTITION BY TRIM( OWNER), TRIM( PLACE_CODE) ORDER BY FROM_UNIXTIME(LAST_UPDATE / 1000, 'yyyy-mm-dd hh:mm:ss') DESC) AS ROW_NUM
FROM ROCKPORT_STAGE0.TRADER_PLCI3225) AS A
WHERE A.ROW_NUM = 1);
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
INSERT OVERWRITE INTO SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1
(SELECT RASW1.MAWB_NBR, RASW1.HAWB_NBR, RASW1.REF_NBR, COALESCE(I.ITEM_NUMBER, RASW1.ITM_NBR), RASW1.SHIPPING_METHOD, RASW1.FLIGHT_NBR, RASW1.FORWARDER_ID, RASW1.FORWARDER_NAME, RASW1.CARRIER_CD, RASW1.PORT_OF_LADING_ID, RASW1.PORT_OF_LADING_NAME, RASW1.PORT_OF_DISCHARGE_ID, RASW1.PORT_OF_DISCHARGE_NAME, RASW1.DESTINATION_ID, RASW1.DESTINATION_NAME, RASW1.DIM_WGT, RASW1.DIM_WGT_UOM, RASW1.GROSS_WGT, RASW1.GROSS_WGT_UOM, RASW1.TOTAL_CARTONS, RASW1.ACTUAL_DEPART_DTM, RASW1.TRANSMISSION_DTM, RASW1.ETA_DTM, RASW1.CARGO_RECEIPT_DTM, RASW1.DOCS_AVAILABLE_DTM, RASW1.BRAND, RASW1.DELIVER_TO, RASW1.PO_NBR, RASW1.CONTRACT_NBR, RASW1.ORDER_NBR, RASW1.PO_UNIT, RASW1.PO_CARTONS_QTY, RASW1.PO_GROSS_WGT, RASW1.PO_GROSS_WGT_UOM, RASW1.PO_DIM_WGT, RASW1.PO_DIM_WGT_UOM, RASW1.PO_CHARGEABLE_WGT, RASW1.PO_CHARGEABLE_WGT_UOM, RASW1.GARMENT_PACK, RASW1.PRE_TKT, RASW1.HEADER_LAST_UPD_DTM, RASW1.DETAIL_LAST_UPD_DTM
FROM (SELECT RASW.MAWB_NBR, RASW.HAWB_NBR, RASW.REF_NBR, RASW.ITM_NBR, RASW.SHIPPING_METHOD, RASW.FLIGHT_NBR, RASW.FORWARDER_ID, RASW.FORWARDER_NAME, RASW.CARRIER_CD, RASW.PORT_OF_LADING_ID, RASW.PORT_OF_LADING_NAME, RASW.PORT_OF_DISCHARGE_ID, RASW.PORT_OF_DISCHARGE_NAME, RASW.DESTINATION_ID, RASW.DESTINATION_NAME, RASW.DIM_WGT, RASW.DIM_WGT_UOM, RASW.GROSS_WGT, RASW.GROSS_WGT_UOM, RASW.TOTAL_CARTONS, RASW.ACTUAL_DEPART_DTM, RASW.TRANSMISSION_DTM, RASW.ETA_DTM, RASW.CARGO_RECEIPT_DTM, RASW.DOCS_AVAILABLE_DTM, RASW.BRAND, RASW.DELIVER_TO, RASW.PO_NBR, RASW.CONTRACT_NBR, RASW.ORDER_NBR, RASW.PO_UNIT, RASW.PO_CARTONS_QTY, RASW.PO_GROSS_WGT, RASW.PO_GROSS_WGT_UOM, RASW.PO_DIM_WGT, RASW.PO_DIM_WGT_UOM, RASW.PO_CHARGEABLE_WGT, RASW.PO_CHARGEABLE_WGT_UOM, RASW.GARMENT_PACK, RASW.PRE_TKT, RASW.HEADER_LAST_UPD_DTM, RASW.DETAIL_LAST_UPD_DTM
FROM (SELECT MAWB_NBR, HAWB_NBR, REF_NBR, ITM_NBR, SHIPPING_METHOD, FLIGHT_NBR, FORWARDER_ID, FORWARDER_NAME, CARRIER_CD, PORT_OF_LADING_ID, PORT_OF_LADING_NAME, PORT_OF_DISCHARGE_ID, PORT_OF_DISCHARGE_NAME, DESTINATION_ID, DESTINATION_NAME, DIM_WGT, DIM_WGT_UOM, GROSS_WGT, GROSS_WGT_UOM, TOTAL_CARTONS, ACTUAL_DEPART_DTM, TRANSMISSION_DTM, ETA_DTM, CARGO_RECEIPT_DTM, DOCS_AVAILABLE_DTM, BRAND, DELIVER_TO, PO_NBR, CONTRACT_NBR, ORDER_NBR, PO_UNIT, PO_CARTONS_QTY, PO_GROSS_WGT, PO_GROSS_WGT_UOM, PO_DIM_WGT, PO_DIM_WGT_UOM, PO_CHARGEABLE_WGT, PO_CHARGEABLE_WGT_UOM, GARMENT_PACK, PRE_TKT, HEADER_LAST_UPD_DTM, DETAIL_LAST_UPD_DTM, ROW_NUMBER() OVER (PARTITION BY MAWB_NBR, HAWB_NBR, FORWARDER_ID, CONTRACT_NBR, ORDER_NBR, REF_NBR, ITM_NBR ORDER BY DETAIL_LAST_UPD_DTM DESC) AS ROW_NUM
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK) AS RASW
WHERE RASW.ROW_NUM = 1) AS RASW1
LEFT JOIN ANALYTICS_VIEW.ITEM AS I ON TRIM( RASW1.ITM_NBR) = TRIM( SUBSTRING(I.ITEM_NUMBER FROM -8)));
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
! echo completed loading into scct_work_db.rockport_air_shipment_work1;
! echo started loading into scct_db.rockport_air_shipment;
INSERT OVERWRITE INTO SCCT_DB.ROCKPORT_AIR_SHIPMENT
(SELECT COALESCE(RASW.MAWB_NBR, RAS.MAWB_NBR), COALESCE(RASW.HAWB_NBR, RAS.HAWB_NBR), COALESCE(RASW.REF_NBR, RAS.REF_NBR), COALESCE(RASW.ITM_NBR, RAS.ITM_NBR), COALESCE(RASW.SHIPPING_METHOD, RAS.SHIPPING_METHOD), COALESCE(RASW.FLIGHT_NBR, RAS.FLIGHT_NBR), COALESCE(RASW.FORWARDER_ID, RAS.FORWARDER_ID), COALESCE(RASW.FORWARDER_NAME, RAS.FORWARDER_NAME), COALESCE(RASW.CARRIER_CD, RAS.CARRIER_CD), COALESCE(RASW.PORT_OF_LADING_ID, RAS.PORT_OF_LADING_ID), COALESCE(RASW.PORT_OF_LADING_NAME, RAS.PORT_OF_LADING_NAME), COALESCE(RASW.PORT_OF_DISCHARGE_ID, RAS.PORT_OF_DISCHARGE_ID), COALESCE(RASW.PORT_OF_DISCHARGE_NAME, RAS.PORT_OF_DISCHARGE_NAME), COALESCE(RASW.DESTINATION_ID, RAS.DESTINATION_ID), COALESCE(RASW.DESTINATION_NAME, RAS.DESTINATION_NAME), COALESCE(RASW.DIM_WGT, RAS.DIM_WGT), COALESCE(RASW.DIM_WGT_UOM, RAS.DIM_WGT_UOM), COALESCE(RASW.GROSS_WGT, RAS.GROSS_WGT), COALESCE(RASW.GROSS_WGT_UOM, RAS.GROSS_WGT_UOM), COALESCE(RASW.TOTAL_CARTONS, RAS.TOTAL_CARTONS), COALESCE(RASW.ACTUAL_DEPART_DTM, RAS.ACTUAL_DEPART_DTM), COALESCE(RASW.TRANSMISSION_DTM, RAS.TRANSMISSION_DTM), COALESCE(RASW.ETA_DTM, RAS.ETA_DTM), COALESCE(RASW.CARGO_RECEIPT_DTM, RAS.CARGO_RECEIPT_DTM), COALESCE(RASW.DOCS_AVAILABLE_DTM, RAS.DOCS_AVAILABLE_DTM), COALESCE(RASW.BRAND, RAS.BRAND), COALESCE(RASW.DELIVER_TO, RAS.DELIVER_TO), COALESCE(RASW.PO_NBR, RAS.PO_NBR), COALESCE(RASW.CONTRACT_NBR, RAS.CONTRACT_NBR), COALESCE(RASW.ORDER_NBR, RAS.ORDER_NBR), COALESCE(RASW.PO_UNIT, RAS.PO_UNIT), COALESCE(RASW.PO_CARTONS_QTY, RAS.PO_CARTONS_QTY), COALESCE(RASW.PO_GROSS_WGT, RAS.PO_GROSS_WGT), COALESCE(RASW.PO_GROSS_WGT_UOM, RAS.PO_GROSS_WGT_UOM), COALESCE(RASW.PO_DIM_WGT, RAS.PO_DIM_WGT), COALESCE(RASW.PO_DIM_WGT_UOM, RAS.PO_DIM_WGT_UOM), COALESCE(RASW.PO_CHARGEABLE_WGT, RAS.PO_CHARGEABLE_WGT), COALESCE(RASW.PO_CHARGEABLE_WGT_UOM, RAS.PO_CHARGEABLE_WGT_UOM), COALESCE(RASW.GARMENT_PACK, RAS.GARMENT_PACK), COALESCE(RASW.PRE_TKT, RAS.PRE_TKT), COALESCE(RASW.HEADER_LAST_UPD_DTM, RAS.HEADER_LAST_UPD_DTM), COALESCE(RASW.DETAIL_LAST_UPD_DTM, RAS.DETAIL_LAST_UPD_DTM)
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1 AS RASW
FULL JOIN SCCT_DB.ROCKPORT_AIR_SHIPMENT AS RAS ON RASW.MAWB_NBR = RAS.MAWB_NBR AND RASW.FORWARDER_ID = RAS.FORWARDER_ID AND RASW.HAWB_NBR = RAS.HAWB_NBR AND RASW.CONTRACT_NBR = RAS.CONTRACT_NBR AND RASW.ORDER_NBR = RAS.ORDER_NBR AND RASW.REF_NBR = RAS.REF_NBR AND RASW.ITM_NBR = RAS.ITM_NBR);
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2923 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_dc_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to dc intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2922 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_dc_to_store_intra -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-3287 ssoma dc to store intra initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  -- 01.00.00.04 17jan21 scctp-601 kaali m replaced handling_master table with handling_master_poso  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_gpom -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.03 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------  -------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for gpom model -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 16oct19 scctp4-2523 ssoma changed partition columns and po for so model -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add fg filter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details for mast beauty production;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_mbp_vsd_gs -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_tkvsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-3287 ssoma turnkey production to vsd initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_ven_rfc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master,location_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2931 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vendor_to_dc -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2996 ssoma component inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vsdinflow -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-3287 ssoma vsd inflow initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ----------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vss_vsd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 06jan20 scctp4-2924 ssoma initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 04may20 scctp4-3331 ssoma hql optimization  ----------------------------------------------------------------------------   ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_vtptobdc_nb -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, inventory_movement ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 27dec19 scctp4-2901 ssoma turnkey production to brand initial version -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter ---------------------------------------------------------------------------  ------------------------- ---loading po line kpis data into po_so_dd_hu_details table for vendor turnkey production -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_details_zdtd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug20 scctp5-327 fyuan zdtd initial version ---------------------------------------------------------------------------- ------------------------- ---loading po line kpi's data into po_so_dd_hu_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_details;
! echo completed po_so_dd_hu_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_po -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.04 05nov20 scctp-456 fyuan add component filter  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_podd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter -- 01.00.00.03 20aug20 scctp5-327 fyuan add zdtd  --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_posodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-ufposo-hive-stg1-po_so_dd_hu_kpi_details_sodd -------------------------------------------------------------------------- ---target: stage1 table: scct_db.po_so_dd_hu_kpi_details  ---source: tms_stage0 table : po_master, delivery_master, inventory_movement,  ---handling_master and item_unit_measure_master ---load type: full ---back posting: no -- -- history information -- -- revision date jira developer-id comments -- ----------- ------- ---------- ------------ -------------------- -- 01.00.00.01 20aug19 scctp4-2276 ssoma initial version -- 01.00.00.02 09oct19 scctp4-2523 ssoma changed partition columns and added new column -- 01.00.00.02 06mar20 scctp4-3316 ssoma remove reducer parameter --------------------------------------------------------------------------  ------------------------- ---loading po line kpi's data into po_so_dd_hu_kpi_details table -------------------------  ! echo started loading into scct_db.po_so_dd_hu_kpi_details;
! echo completed po_so_dd_hu_kpi_details data load;
---jobname:scct-e2e_dashboard-hive-stg1-scct_db.prepack_component -------------------------------------------------------------------------- ---target: stage1 table: scct_db.prepack_component  ---source: scct_db table : bom_item, bom_detail, analytics_view table : item ---load type: full ---back posting: no ---author: ryadav ---last modified date: 12/18/2018 --------------------------------------------------------------------------  ------------------------- ---loading prepack_component stage 1 base data -------------------------  ! echo started loading into scct_db.prepack_component ;
! echo completed loading into scct_db.prepack_component ;
---jobname:scct-e2e_outbound_visibility-hive-stg1-scct_db.purge_wms_outbound_e2e -------------------------------------------------------------------------- ---target: stage1 table: scct_db.wms_outbound_e2e ---source: scct_db table : scct_db.wms_outbound_e2e and operations_db.purge_tables  ---load type: incrimental ---back posting: no ---author: ssoma ---created date: 12/02/2019 --------------------------------------------------------------------------  ------------------------- ---loading worker table without str rows  -------------------------   insert overwrite table scct_work_db.wms_retail_warehouse_shipping_link_work select rs.retail_warehouse ,rs.retail_distro_nbr ,rs.retail_store_nbr ,rs.retail_season_nbr ,rs.retail_season_year_nbr ,rs.retail_style_nbr ,rs.retail_style_sfx_nbr ,rs.retail_sector ,rs.retail_sap_style ,rs.retail_sap_choice ,rs.retail_sap_size ,rs.retail_ticket_typ ,rs.retail_instore_dt ,rs.retail_distro_total_qty ,rs.retail_distro_allocated_qty ,rs.retail_distro_remaining_qty ,rs.retail_dtstor_status_flag ,rs.retail_record_expansion_fld ,rs.retail_delv_doc_nbr ,rs.retail_delv_doc_itm_nbr ,rs.retail_distro_last_modified_datetime ,rs.retail_distro_create_datetime ,rs.retail_pickticket_control_nbr ,rs.retail_pdpick_pkt_line_nbr ,rs.retail_pdpick_pick_wave_nbr ,rs.retail_wave_processing_typ ,rs.retail_inv_allocation_typ ,rs.retail_pick_determination_typ ,rs.retail_pick_loc_assignment_typ ,rs.retail_pickticket_pick_location ,rs.retail_original_pick_order_qty ,rs.retail_original_pick_qty ,rs.retail_pick_qty ,rs.retail_pick_shortage_qty ,rs.retail_pick_cancelled_qty ,rs.retail_pick_packed_qty ,rs.retail_pdpick_status_flg ,rs.retail_specl_instr_cd_1 ,rs.retail_pickticket_last_modified_datetime ,rs.retail_pdpick_user_id ,rs.retail_district ,rs.retail_shipto_name ,rs.retail_shipto_state ,rs.retail_shipto_zip ,rs.retail_shipto_country ,rs.retail_pickticket_header_created_datetime ,rs.retail_pickticket_header_last_modified_datetime ,rs.retail_phpick_user_id ,rs.retail_carton_nbr ,rs.retail_carton_line_nbr ,rs.retail_package_barcd ,rs.retail_cdcart_pkt_line_nbr ,rs.retail_cdcart_pick_wave_nbr ,rs.retail_carton_qty_to_be_packed ,rs.retail_carton_qty_packed ,rs.retail_carton_delivered_qty ,rs.retail_carton_cancelled_qty ,rs.retail_carton_pick_location ,rs.retail_cdcart_status_flag ,rs.retail_packer_id ,rs.retail_carton_line_create_datetime ,rs.retail_carton_line_last_modified_datetime ,rs.retail_cdcart_user_id ,rs.retail_misc_nbr_1 ,rs.retail_chcart_pick_wave_nbr ,rs.retail_chcart_status_flg ,rs.retail_pack_cd ,rs.retail_pack_typ ,rs.retail_single_sku_flg ,rs.retail_first_pick_location ,rs.retail_carton_typ ,rs.retail_carton_sz ,rs.retail_carton_volume ,rs.retail_estimated_weight ,rs.retail_actual_weight ,rs.retail_pallet_id ,rs.retail_product_value ,rs.retail_bill_of_lading ,rs.retail_shipment_nbr ,rs.retail_load_nbr ,rs.retail_path_nbr ,rs.retail_ship_via ,rs.retail_special_ins_cd_1 ,rs.retail_special_ins_cd_2 ,rs.retail_special_ins_cd_3 ,rs.retail_misc_10_byte_1 ,rs.retail_misc_20_byte_1 ,rs.retail_misc_20_byte_2 ,rs.retail_misc_20_byte_4 ,rs.retail_misc_20_byte_5 ,rs.retail_reference_case_nbr ,rs.retail_carton_nbr_x_of_y ,rs.retail_audit_status ,rs.retail_tms_parcel_nbr ,rs.retail_carton_length ,rs.retail_carton_width ,rs.retail_carton_height ,rs.retail_recipient_first_name ,rs.retail_carton_last_modified_datetime ,rs.retail_chcart_user_id ,rs.retail_pickticket_create_datetime ,rs.retail_carton_create_datetime ,rs.retail_carton_invoiced_datetime ,rs.retail_distro_to_wave_time_duration ,rs.retail_wave_to_invoiced_duration ,rs.retail_distro_total_reaches ,rs.retail_distro_allocated_reaches ,rs.retail_distro_remaining_reaches ,rs.retail_original_pick_order_reaches ,rs.retail_original_pick_reaches ,rs.retail_pick_reaches ,rs.retail_pick_shortage_reaches ,rs.retail_pick_cancelled_reaches ,rs.retail_pick_packed_reaches ,rs.retail_carton_reaches_to_be_packed ,rs.retail_carton_reaches_packed ,rs.retail_carton_delivered_reaches ,rs.retail_carton_cancelled_reaches ,rs.retail_fc_ltfc ,rs.retail_processing_area ,rs.shipping_misc_20_byte_3 ,rs.shipping_carton_nbr ,rs.shipping_warehouse ,rs.shipping_load_nbr ,rs.shipping_destination_typ ,rs.shipping_ship_via ,rs.shipping_master_bill_of_lading ,rs.shipping_trailer_nbr ,rs.shipping_tractor_nbr ,rs.shipping_driver ,rs.shipping_dock ,rs.shipping_door ,rs.shipping_dock_door_locn_brcd ,rs.shipping_tms_plan_nbr ,rs.shipping_status_flg ,rs.shipping_status_dt ,rs.shipping_load_closed_dt ,rs.shipping_load_closed_ts ,rs.shipping_tc_shipment_id ,rs.shipping_tpe_created_load ,rs.shipping_tpe_processing_status ,rs.shipping_misc_instruction_1 ,rs.shipping_created_dt ,rs.shipping_created_ts ,rs.shipping_last_modified_dt ,rs.shipping_last_modified_ts ,rs.shipping_user_id ,rs.shipping_record_type ,rs.shipping_trip_nbr ,rs.shipping_trip_type ,rs.shipping_dispatch_dt ,rs.shipping_dispatch_ts ,rs.shipping_carton_limit ,rs.shipping_run_nbr ,rs.shipping_thtrip_ship_via ,rs.shipping_thtrip_status_flg ,rs.shipping_delay_code ,rs.shipping_cartons_loaded ,rs.shipping_seal_nbr ,rs.shipping_date_billed ,rs.shipping_time_billed ,rs.shipping_thtrip_seal_nbr ,rs.shipping_misc1_numeric_fld ,rs.shipping_miscellaneous_20 ,rs.shipping_thtrip_created_dt ,rs.shipping_thtrip_created_ts ,rs.shipping_thtrip_last_modified_dt ,rs.shipping_thtrip_last_modified_ts ,rs.shipping_thtrip_user_id ,rs.shipping_load_create_dt_ts ,rs.shipping_load_closed_dt_ts ,rs.shipping_load_create_to_closed_duration ,rs.distro_create_date ,rs.batch_code from scct_db.wms_outbound_e2e rs join (select purge_min_dt, purge_max_dt from operations_db.purge_tables p join  (select date_sub(min(to_date(distro_create_datetime)),1) purge_max_dt from scct_db.wms_outbound_retail) r on 1=1 where p.run_ind='n') pt on 1=1 where rs.distro_create_date between pt.purge_min_dt and pt.purge_max_dt and rs.retail_pickticket_control_nbr not like 'str%';
! echo worker table load is completed;
------------------------- ---insert back to base table only not str retail_pickticket_control_nbr rows -------------------------   insert overwrite table scct_db.wms_outbound_e2e partition(distro_create_date) select retail_warehouse ,retail_distro_nbr ,retail_store_nbr ,retail_season_nbr ,retail_season_year_nbr ,retail_style_nbr ,retail_style_sfx_nbr ,retail_sector ,retail_sap_style ,retail_sap_choice ,retail_sap_size ,retail_ticket_typ ,retail_instore_dt ,retail_distro_total_qty ,retail_distro_allocated_qty ,retail_distro_remaining_qty ,retail_dtstor_status_flag ,retail_record_expansion_fld ,retail_delv_doc_nbr ,retail_delv_doc_itm_nbr ,retail_distro_last_modified_datetime ,retail_distro_create_datetime ,retail_pickticket_control_nbr ,retail_pdpick_pkt_line_nbr ,retail_pdpick_pick_wave_nbr ,retail_wave_processing_typ ,retail_inv_allocation_typ ,retail_pick_determination_typ ,retail_pick_loc_assignment_typ ,retail_pickticket_pick_location ,retail_original_pick_order_qty ,retail_original_pick_qty ,retail_pick_qty ,retail_pick_shortage_qty ,retail_pick_cancelled_qty ,retail_pick_packed_qty ,retail_pdpick_status_flg ,retail_specl_instr_cd_1 ,retail_pickticket_last_modified_datetime ,retail_pdpick_user_id ,retail_district ,retail_shipto_name ,retail_shipto_state ,retail_shipto_zip ,retail_shipto_country ,retail_pickticket_header_created_datetime ,retail_pickticket_header_last_modified_datetime ,retail_phpick_user_id ,retail_carton_nbr ,retail_carton_line_nbr ,retail_package_barcd ,retail_cdcart_pkt_line_nbr ,retail_cdcart_pick_wave_nbr ,retail_carton_qty_to_be_packed ,retail_carton_qty_packed ,retail_carton_delivered_qty ,retail_carton_cancelled_qty ,retail_carton_pick_location ,retail_cdcart_status_flag ,retail_packer_id ,retail_carton_line_create_datetime ,retail_carton_line_last_modified_datetime ,retail_cdcart_user_id ,retail_misc_nbr_1 ,retail_chcart_pick_wave_nbr ,retail_chcart_status_flg ,retail_pack_cd ,retail_pack_typ ,retail_single_sku_flg ,retail_first_pick_location ,retail_carton_typ ,retail_carton_sz ,retail_carton_volume ,retail_estimated_weight ,retail_actual_weight ,retail_pallet_id ,retail_product_value ,retail_bill_of_lading ,retail_shipment_nbr ,retail_load_nbr ,retail_path_nbr ,retail_ship_via ,retail_special_ins_cd_1 ,retail_special_ins_cd_2 ,retail_special_ins_cd_3 ,retail_misc_10_byte_1 ,retail_misc_20_byte_1 ,retail_misc_20_byte_2 ,retail_misc_20_byte_4 ,retail_misc_20_byte_5 ,retail_reference_case_nbr ,retail_carton_nbr_x_of_y ,retail_audit_status ,retail_tms_parcel_nbr ,retail_carton_length ,retail_carton_width ,retail_carton_height ,retail_recipient_first_name ,retail_carton_last_modified_datetime ,retail_chcart_user_id ,retail_pickticket_create_datetime ,retail_carton_create_datetime ,retail_carton_invoiced_datetime ,retail_distro_to_wave_time_duration ,retail_wave_to_invoiced_duration ,retail_distro_total_reaches ,retail_distro_allocated_reaches ,retail_distro_remaining_reaches ,retail_original_pick_order_reaches ,retail_original_pick_reaches ,retail_pick_reaches ,retail_pick_shortage_reaches ,retail_pick_cancelled_reaches ,retail_pick_packed_reaches ,retail_carton_reaches_to_be_packed ,retail_carton_reaches_packed ,retail_carton_delivered_reaches ,retail_carton_cancelled_reaches ,retail_fc_ltfc ,retail_processing_area ,shipping_misc_20_byte_3 ,shipping_carton_nbr ,shipping_warehouse ,shipping_load_nbr ,shipping_destination_typ ,shipping_ship_via ,shipping_master_bill_of_lading ,shipping_trailer_nbr ,shipping_tractor_nbr ,shipping_driver ,shipping_dock ,shipping_door ,shipping_dock_door_locn_brcd ,shipping_tms_plan_nbr ,shipping_status_flg ,shipping_status_dt ,shipping_load_closed_dt ,shipping_load_closed_ts ,shipping_tc_shipment_id ,shipping_tpe_created_load ,shipping_tpe_processing_status ,shipping_misc_instruction_1 ,shipping_created_dt ,shipping_created_ts ,shipping_last_modified_dt ,shipping_last_modified_ts ,shipping_user_id ,shipping_record_type ,shipping_trip_nbr ,shipping_trip_type ,shipping_dispatch_dt ,shipping_dispatch_ts ,shipping_carton_limit ,shipping_run_nbr ,shipping_thtrip_ship_via ,shipping_thtrip_status_flg ,shipping_delay_code ,shipping_cartons_loaded ,shipping_seal_nbr ,shipping_date_billed ,shipping_time_billed ,shipping_thtrip_seal_nbr ,shipping_misc1_numeric_fld ,shipping_miscellaneous_20 ,shipping_thtrip_created_dt ,shipping_thtrip_created_ts ,shipping_thtrip_last_modified_dt ,shipping_thtrip_last_modified_ts ,shipping_thtrip_user_id ,shipping_load_create_dt_ts ,shipping_load_closed_dt_ts ,shipping_load_create_to_closed_duration ,batch_code ,distro_create_date from scct_work_db.wms_retail_warehouse_shipping_link_work;
! echo purge str rows completed;
------------------------- ---update record into control table to purge str rows -------------------------   ! echo started entry into job control table;
------------------------- ---insert record into control table to purge str rows -------------------------  ! echo started entry into job control table;
! echo entry into job control table completed;
---jobname:scct-rockport-hive-stg1-scct_db.rockport_air_shipment -------------------------------------------------------------------------- ---target: stage1 table: scct_db.rockport_air_shipment ---source: rockport_stage0 table : trader_shipping_hdr, trader_shipping_dtl, trader_party, trader_plci3225 --- trader_packing, trader_delivery_dtl and trader_matrix_hdr;
---load type: full ---back posting: no ---author: ssoma ---created date: 02/05/2019 --------------------------------------------------------------------------  ------------------------- ---loading work table scct_db.trader_plci3225_work  -------------------------   ! echo started loading into scct_work_db.trader_plci3225_work;
INSERT OVERWRITE INTO SCCT_WORK_DB.TRADER_PLCI3225_WORK
(SELECT OWNER, PLACE_CODE, PLACE_NAME
FROM (SELECT OWNER, PLACE_CODE, PLACE_NAME, ROW_NUMBER() OVER (PARTITION BY TRIM( OWNER), TRIM( PLACE_CODE) ORDER BY FROM_UNIXTIME(LAST_UPDATE / 1000, 'yyyy-mm-dd hh:mm:ss') DESC) AS ROW_NUM
FROM ROCKPORT_STAGE0.TRADER_PLCI3225) AS A
WHERE A.ROW_NUM = 1);
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
INSERT OVERWRITE INTO SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1
(SELECT RASW1.MAWB_NBR, RASW1.HAWB_NBR, RASW1.REF_NBR, COALESCE(I.ITEM_NUMBER, RASW1.ITM_NBR), RASW1.SHIPPING_METHOD, RASW1.FLIGHT_NBR, RASW1.FORWARDER_ID, RASW1.FORWARDER_NAME, RASW1.CARRIER_CD, RASW1.PORT_OF_LADING_ID, RASW1.PORT_OF_LADING_NAME, RASW1.PORT_OF_DISCHARGE_ID, RASW1.PORT_OF_DISCHARGE_NAME, RASW1.DESTINATION_ID, RASW1.DESTINATION_NAME, RASW1.DIM_WGT, RASW1.DIM_WGT_UOM, RASW1.GROSS_WGT, RASW1.GROSS_WGT_UOM, RASW1.TOTAL_CARTONS, RASW1.ACTUAL_DEPART_DTM, RASW1.TRANSMISSION_DTM, RASW1.ETA_DTM, RASW1.CARGO_RECEIPT_DTM, RASW1.DOCS_AVAILABLE_DTM, RASW1.BRAND, RASW1.DELIVER_TO, RASW1.PO_NBR, RASW1.CONTRACT_NBR, RASW1.ORDER_NBR, RASW1.PO_UNIT, RASW1.PO_CARTONS_QTY, RASW1.PO_GROSS_WGT, RASW1.PO_GROSS_WGT_UOM, RASW1.PO_DIM_WGT, RASW1.PO_DIM_WGT_UOM, RASW1.PO_CHARGEABLE_WGT, RASW1.PO_CHARGEABLE_WGT_UOM, RASW1.GARMENT_PACK, RASW1.PRE_TKT, RASW1.HEADER_LAST_UPD_DTM, RASW1.DETAIL_LAST_UPD_DTM
FROM (SELECT RASW.MAWB_NBR, RASW.HAWB_NBR, RASW.REF_NBR, RASW.ITM_NBR, RASW.SHIPPING_METHOD, RASW.FLIGHT_NBR, RASW.FORWARDER_ID, RASW.FORWARDER_NAME, RASW.CARRIER_CD, RASW.PORT_OF_LADING_ID, RASW.PORT_OF_LADING_NAME, RASW.PORT_OF_DISCHARGE_ID, RASW.PORT_OF_DISCHARGE_NAME, RASW.DESTINATION_ID, RASW.DESTINATION_NAME, RASW.DIM_WGT, RASW.DIM_WGT_UOM, RASW.GROSS_WGT, RASW.GROSS_WGT_UOM, RASW.TOTAL_CARTONS, RASW.ACTUAL_DEPART_DTM, RASW.TRANSMISSION_DTM, RASW.ETA_DTM, RASW.CARGO_RECEIPT_DTM, RASW.DOCS_AVAILABLE_DTM, RASW.BRAND, RASW.DELIVER_TO, RASW.PO_NBR, RASW.CONTRACT_NBR, RASW.ORDER_NBR, RASW.PO_UNIT, RASW.PO_CARTONS_QTY, RASW.PO_GROSS_WGT, RASW.PO_GROSS_WGT_UOM, RASW.PO_DIM_WGT, RASW.PO_DIM_WGT_UOM, RASW.PO_CHARGEABLE_WGT, RASW.PO_CHARGEABLE_WGT_UOM, RASW.GARMENT_PACK, RASW.PRE_TKT, RASW.HEADER_LAST_UPD_DTM, RASW.DETAIL_LAST_UPD_DTM
FROM (SELECT MAWB_NBR, HAWB_NBR, REF_NBR, ITM_NBR, SHIPPING_METHOD, FLIGHT_NBR, FORWARDER_ID, FORWARDER_NAME, CARRIER_CD, PORT_OF_LADING_ID, PORT_OF_LADING_NAME, PORT_OF_DISCHARGE_ID, PORT_OF_DISCHARGE_NAME, DESTINATION_ID, DESTINATION_NAME, DIM_WGT, DIM_WGT_UOM, GROSS_WGT, GROSS_WGT_UOM, TOTAL_CARTONS, ACTUAL_DEPART_DTM, TRANSMISSION_DTM, ETA_DTM, CARGO_RECEIPT_DTM, DOCS_AVAILABLE_DTM, BRAND, DELIVER_TO, PO_NBR, CONTRACT_NBR, ORDER_NBR, PO_UNIT, PO_CARTONS_QTY, PO_GROSS_WGT, PO_GROSS_WGT_UOM, PO_DIM_WGT, PO_DIM_WGT_UOM, PO_CHARGEABLE_WGT, PO_CHARGEABLE_WGT_UOM, GARMENT_PACK, PRE_TKT, HEADER_LAST_UPD_DTM, DETAIL_LAST_UPD_DTM, ROW_NUMBER() OVER (PARTITION BY MAWB_NBR, HAWB_NBR, FORWARDER_ID, CONTRACT_NBR, ORDER_NBR, REF_NBR, ITM_NBR ORDER BY DETAIL_LAST_UPD_DTM DESC) AS ROW_NUM
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK) AS RASW
WHERE RASW.ROW_NUM = 1) AS RASW1
LEFT JOIN ANALYTICS_VIEW.ITEM AS I ON TRIM( RASW1.ITM_NBR) = TRIM( SUBSTRING(I.ITEM_NUMBER FROM -8)));
! echo completed loading into scct_work_db.rockport_air_shipment_work;
! echo started loading into scct_work_db.rockport_air_shipment_work1;
! echo completed loading into scct_work_db.rockport_air_shipment_work1;
! echo started loading into scct_db.rockport_air_shipment;
INSERT OVERWRITE INTO SCCT_DB.ROCKPORT_AIR_SHIPMENT
(SELECT COALESCE(RASW.MAWB_NBR, RAS.MAWB_NBR), COALESCE(RASW.HAWB_NBR, RAS.HAWB_NBR), COALESCE(RASW.REF_NBR, RAS.REF_NBR), COALESCE(RASW.ITM_NBR, RAS.ITM_NBR), COALESCE(RASW.SHIPPING_METHOD, RAS.SHIPPING_METHOD), COALESCE(RASW.FLIGHT_NBR, RAS.FLIGHT_NBR), COALESCE(RASW.FORWARDER_ID, RAS.FORWARDER_ID), COALESCE(RASW.FORWARDER_NAME, RAS.FORWARDER_NAME), COALESCE(RASW.CARRIER_CD, RAS.CARRIER_CD), COALESCE(RASW.PORT_OF_LADING_ID, RAS.PORT_OF_LADING_ID), COALESCE(RASW.PORT_OF_LADING_NAME, RAS.PORT_OF_LADING_NAME), COALESCE(RASW.PORT_OF_DISCHARGE_ID, RAS.PORT_OF_DISCHARGE_ID), COALESCE(RASW.PORT_OF_DISCHARGE_NAME, RAS.PORT_OF_DISCHARGE_NAME), COALESCE(RASW.DESTINATION_ID, RAS.DESTINATION_ID), COALESCE(RASW.DESTINATION_NAME, RAS.DESTINATION_NAME), COALESCE(RASW.DIM_WGT, RAS.DIM_WGT), COALESCE(RASW.DIM_WGT_UOM, RAS.DIM_WGT_UOM), COALESCE(RASW.GROSS_WGT, RAS.GROSS_WGT), COALESCE(RASW.GROSS_WGT_UOM, RAS.GROSS_WGT_UOM), COALESCE(RASW.TOTAL_CARTONS, RAS.TOTAL_CARTONS), COALESCE(RASW.ACTUAL_DEPART_DTM, RAS.ACTUAL_DEPART_DTM), COALESCE(RASW.TRANSMISSION_DTM, RAS.TRANSMISSION_DTM), COALESCE(RASW.ETA_DTM, RAS.ETA_DTM), COALESCE(RASW.CARGO_RECEIPT_DTM, RAS.CARGO_RECEIPT_DTM), COALESCE(RASW.DOCS_AVAILABLE_DTM, RAS.DOCS_AVAILABLE_DTM), COALESCE(RASW.BRAND, RAS.BRAND), COALESCE(RASW.DELIVER_TO, RAS.DELIVER_TO), COALESCE(RASW.PO_NBR, RAS.PO_NBR), COALESCE(RASW.CONTRACT_NBR, RAS.CONTRACT_NBR), COALESCE(RASW.ORDER_NBR, RAS.ORDER_NBR), COALESCE(RASW.PO_UNIT, RAS.PO_UNIT), COALESCE(RASW.PO_CARTONS_QTY, RAS.PO_CARTONS_QTY), COALESCE(RASW.PO_GROSS_WGT, RAS.PO_GROSS_WGT), COALESCE(RASW.PO_GROSS_WGT_UOM, RAS.PO_GROSS_WGT_UOM), COALESCE(RASW.PO_DIM_WGT, RAS.PO_DIM_WGT), COALESCE(RASW.PO_DIM_WGT_UOM, RAS.PO_DIM_WGT_UOM), COALESCE(RASW.PO_CHARGEABLE_WGT, RAS.PO_CHARGEABLE_WGT), COALESCE(RASW.PO_CHARGEABLE_WGT_UOM, RAS.PO_CHARGEABLE_WGT_UOM), COALESCE(RASW.GARMENT_PACK, RAS.GARMENT_PACK), COALESCE(RASW.PRE_TKT, RAS.PRE_TKT), COALESCE(RASW.HEADER_LAST_UPD_DTM, RAS.HEADER_LAST_UPD_DTM), COALESCE(RASW.DETAIL_LAST_UPD_DTM, RAS.DETAIL_LAST_UPD_DTM)
FROM SCCT_WORK_DB.ROCKPORT_AIR_SHIPMENT_WORK1 AS RASW
FULL JOIN SCCT_DB.ROCKPORT_AIR_SHIPMENT AS RAS ON RASW.MAWB_NBR = RAS.MAWB_NBR AND RASW.FORWARDER_ID = RAS.FORWARDER_ID AND RASW.HAWB_NBR = RAS.HAWB_NBR AND RASW.CONTRACT_NBR = RAS.CONTRACT_NBR AND RASW.ORDER_NBR = RAS.ORDER_NBR AND RASW.REF_NBR = RAS.REF_NBR AND RASW.ITM_NBR = RAS.ITM_NBR);
