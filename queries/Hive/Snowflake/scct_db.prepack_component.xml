<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!----><SnowBlocks>
<SnowBlock id="1">
<Step id="po_so_dd_hu_details_1">
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Sql><![CDATA[INSERT
  OVERWRITE INTO SCCT_DB.PREPACK_COMPONENT (
    SELECT
      COALESCE(
        CASE
          WHEN TRIM(A.BOM_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(A.BOM_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_ITM_NBR,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_CPNT_ITM_NBR,
      COALESCE(
        CASE
          WHEN B.BOM_CPNT_QTY = '' THEN NULL
          ELSE B.BOM_CPNT_QTY
        END,
        0.00
      ) AS PPCK_CPNT_ITEM_QTY,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD)
        END,
        'n/a'
      ) AS PPCK_CPNT_UNT_OF_MEAS
    FROM
      SCCT_DB.BOM_ITEM AS A
      INNER JOIN SCCT_DB.BOM_DETAIL AS B ON A.BOM_NBR = B.BOM_NBR
      INNER JOIN ANALYTICS_VIEW.ITEM AS C ON A.BOM_ITEM_NBR = C.ITEM_NUMBER
    WHERE
      C.ITEM_TYPE_CODE = 'zpre'
    GROUP BY
      A.BOM_ITEM_NBR,
      B.BOM_CPNT_ITEM_NBR,
      B.BOM_CPNT_QTY,
      B.BOM_CPNT_UNT_OF_MEAS_CD
  );]]></Sql>
<Condition action="exit" if="ERRORCODE != 0" value="ERRORCODE"/>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
</Step>
</SnowBlock>
<SnowBlock id="2">
<Step id="po_so_dd_hu_details_2">
<Sql><![CDATA[INSERT
  OVERWRITE INTO SCCT_DB.PREPACK_COMPONENT (
    SELECT
      COALESCE(
        CASE
          WHEN TRIM(A.BOM_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(A.BOM_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_ITM_NBR,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_CPNT_ITM_NBR,
      COALESCE(
        CASE
          WHEN B.BOM_CPNT_QTY = '' THEN NULL
          ELSE B.BOM_CPNT_QTY
        END,
        0.00
      ) AS PPCK_CPNT_ITEM_QTY,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD)
        END,
        'n/a'
      ) AS PPCK_CPNT_UNT_OF_MEAS
    FROM
      SCCT_DB.BOM_ITEM AS A
      INNER JOIN SCCT_DB.BOM_DETAIL AS B ON A.BOM_NBR = B.BOM_NBR
      INNER JOIN ANALYTICS_VIEW.ITEM AS C ON A.BOM_ITEM_NBR = C.ITEM_NUMBER
    WHERE
      C.ITEM_TYPE_CODE = 'zpre'
    GROUP BY
      A.BOM_ITEM_NBR,
      B.BOM_CPNT_ITEM_NBR,
      B.BOM_CPNT_QTY,
      B.BOM_CPNT_UNT_OF_MEAS_CD
  );]]></Sql>
<Condition action="exit" if="ERRORCODE != 0" value="ERRORCODE"/>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
</Step>
</SnowBlock>
<SnowBlock id="3">
<Step id="po_so_dd_hu_details_3">
<Sql><![CDATA[INSERT
  OVERWRITE INTO SCCT_DB.PREPACK_COMPONENT (
    SELECT
      COALESCE(
        CASE
          WHEN TRIM(A.BOM_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(A.BOM_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_ITM_NBR,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_CPNT_ITM_NBR,
      COALESCE(
        CASE
          WHEN B.BOM_CPNT_QTY = '' THEN NULL
          ELSE B.BOM_CPNT_QTY
        END,
        0.00
      ) AS PPCK_CPNT_ITEM_QTY,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD)
        END,
        'n/a'
      ) AS PPCK_CPNT_UNT_OF_MEAS
    FROM
      SCCT_DB.BOM_ITEM AS A
      INNER JOIN SCCT_DB.BOM_DETAIL AS B ON A.BOM_NBR = B.BOM_NBR
      INNER JOIN ANALYTICS_VIEW.ITEM AS C ON A.BOM_ITEM_NBR = C.ITEM_NUMBER
    WHERE
      C.ITEM_TYPE_CODE = 'zpre'
    GROUP BY
      A.BOM_ITEM_NBR,
      B.BOM_CPNT_ITEM_NBR,
      B.BOM_CPNT_QTY,
      B.BOM_CPNT_UNT_OF_MEAS_CD
  );]]></Sql>
<Condition action="exit" if="ERRORCODE != 0" value="ERRORCODE"/>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
<Print><![CDATA[completed po_so_dd_hu_kpi_details data load;]]></Print>
</Step>
</SnowBlock>
<SnowBlock id="4">
<Step id="po_so_dd_hu_details_4">
<Sql><![CDATA[INSERT
  OVERWRITE INTO SCCT_DB.PREPACK_COMPONENT (
    SELECT
      COALESCE(
        CASE
          WHEN TRIM(A.BOM_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(A.BOM_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_ITM_NBR,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_ITEM_NBR) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_ITEM_NBR)
        END,
        'n/a'
      ) AS PPCK_CPNT_ITM_NBR,
      COALESCE(
        CASE
          WHEN B.BOM_CPNT_QTY = '' THEN NULL
          ELSE B.BOM_CPNT_QTY
        END,
        0.00
      ) AS PPCK_CPNT_ITEM_QTY,
      COALESCE(
        CASE
          WHEN TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD) = '' THEN NULL
          ELSE TRIM(B.BOM_CPNT_UNT_OF_MEAS_CD)
        END,
        'n/a'
      ) AS PPCK_CPNT_UNT_OF_MEAS
    FROM
      SCCT_DB.BOM_ITEM AS A
      INNER JOIN SCCT_DB.BOM_DETAIL AS B ON A.BOM_NBR = B.BOM_NBR
      INNER JOIN ANALYTICS_VIEW.ITEM AS C ON A.BOM_ITEM_NBR = C.ITEM_NUMBER
    WHERE
      C.ITEM_TYPE_CODE = 'zpre'
    GROUP BY
      A.BOM_ITEM_NBR,
      B.BOM_CPNT_ITEM_NBR,
      B.BOM_CPNT_QTY,
      B.BOM_CPNT_UNT_OF_MEAS_CD
  );]]></Sql>
<Condition action="exit" if="ERRORCODE != 0" value="ERRORCODE"/>
</Step>
<Step id="po_so_dd_hu_details_5"><![CDATA[end script]]></Step>
</SnowBlock>
</SnowBlocks>
