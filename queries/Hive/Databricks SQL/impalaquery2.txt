select   count(distinct cs_order_number) as "order count"  ,sum(cs_ext_ship_cost) as "total shipping cost"  ,sum(cs_net_profit) as "total net profit"  ,date_sub(now(), interval 3 days) from  catalog_sales cs1  ,date_dim  ,customer_address  ,call_center where  d_date between cast('1999-4-01' as date) and   (cast('1999-4-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'ia' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('mobile county','maverick county','huron county','kittitas county',  'fairfield county' ) and exists (select *  from catalog_sales cs2  where cs1.cs_order_number = cs2.cs_order_number  and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *  from catalog_returns cr1  where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;;
select i_item_id  ,i_item_desc   ,i_category   ,i_class   ,i_current_price  ,sum(ws_ext_sales_price) as itemrevenue   ,dfloor(sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price))) over  (partition by i_class) as revenueratio from   web_sales  ,item   ,date_dim where   ws_item_sk = i_item_sk   and i_category in ('jewelry', 'sports', 'books')  and ws_sold_date_sk = d_date_sk  and d_date between cast('2001-01-12' as date)   and (cast('2001-01-12' as date) + interval 30 days) group by   i_item_id  ,i_item_desc   ,i_category  ,i_class  ,i_current_price order by   i_category  ,i_class  ,i_item_id  ,i_item_desc  ,revenueratio limit 100;;
select dt.d_year   ,item.i_brand_id brand_id   ,item.i_brand brand  ,sum(ss_ext_sales_price) sum_agg  from date_dim dt   ,store_sales  ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12  group by dt.d_year  ,item.i_brand  ,item.i_brand_id  order by dt.d_year  ,sum_agg desc  ,brand_id  limit 100;;
