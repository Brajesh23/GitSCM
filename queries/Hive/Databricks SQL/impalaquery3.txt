with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number  and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select   count(distinct ws_order_number) as "order count"  ,sum(ws_ext_ship_cost) as "total shipping cost"  ,sum(ws_net_profit) as "total net profit" from  web_sales ws1  ,date_dim  ,customer_address  ,web_site where  d_date between cast('1999-5-01' as date) and   (cast('1999-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'tx' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number  from ws_wh) and ws1.ws_order_number in (select wr_order_number  from web_returns,ws_wh  where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;;
select i_item_id  ,i_item_desc   ,i_category   ,i_class   ,i_current_price  ,sum(ss_ext_sales_price) as itemrevenue   ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over  (partition by i_class) as revenueratio from   store_sales  ,item   ,date_dim where   ss_item_sk = i_item_sk   and i_category in ('jewelry', 'sports', 'books')  and ss_sold_date_sk = d_date_sk  and d_date between cast('2001-01-12' as date)   and (cast('2001-01-12' as date) + interval 30 days) group by   i_item_id  ,i_item_desc   ,i_category  ,i_class  ,i_current_price order by   i_category  ,i_class  ,i_item_id  ,i_item_desc         ,revenueratio;;
select   substr(w_warehouse_name,1,20)  ,sm_type  ,cc_name  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "30 days"   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as "31-60 days"   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days"   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as "91-120 days"   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as ">120 days"  from  catalog_sales  ,warehouse  ,ship_mode  ,call_center  ,date_dim where  d_month_seq between 1212 and 1212 + 11 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by  substr(w_warehouse_name,1,20)  ,sm_type  ,cc_name order by substr(w_warehouse_name,1,20)  ,sm_type  ,cc_name limit 100;;
